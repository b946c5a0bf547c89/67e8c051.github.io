<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Homer&#39;s Blog</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2016-03-13T10:12:47.000Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Homer Li</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Mariadb benchmark iops</title>
    <link href="http://yoursite.com/2016/03/01/Mariadb-benchmark-iops/"/>
    <id>http://yoursite.com/2016/03/01/Mariadb-benchmark-iops/</id>
    <published>2016-03-01T09:09:39.000Z</published>
    <updated>2016-03-13T10:12:47.000Z</updated>
    
    <content type="html">&lt;h3 id=&quot;Install-sysbench-0-5&quot;&gt;&lt;a href=&quot;#Install-sysbench-0-5&quot; class=&quot;headerlink&quot; title=&quot;Install sysbench 0.5&quot;&gt;&lt;/a&gt;Install sysbench 0.5&lt;/h3&gt;&lt;p&gt;OS version: CentOS 7&lt;/p&gt;
&lt;p&gt;&lt;code&gt;`
mkdir /var/lib/mysql &amp;amp;&amp;amp; mount /dev/sdb1 /var/lib/mysql
echo &amp;quot;deadline&amp;quot; &amp;gt; /sys/class/block/sdb/queue/scheduler
yum install git automake libtool
git clone https://github.com/hgxl64/sysbench-mariadb.git
cd sysbench-mariadb
./autogen.sh
./configure
make
cd sysbech/
export PATH=$PATH:$(pwd)/
sysbench --version
sysbench 0.5&lt;/code&gt; `&lt;/p&gt;
&lt;p&gt;&lt;code&gt; &lt;/code&gt;&lt;br&gt;public class OOM_Demo {&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;public static void main(String[] args) {

    final int length = 100 * 1024 * 1024;

    try{
        byte[] b = new byte[length];
        for(int i=0;i&amp;lt;length;i++){
            b[i] = (byte) i;
        }

        String s = new String(b);
        System.out.println(s);

    }catch(OutOfMemoryError e){
        e.printStackTrace();
        // System.out.println(&amp;quot;OutOfMemoryError&amp;quot;);
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;&lt;code&gt; &lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&quot;Install-mariadb&quot;&gt;&lt;a href=&quot;#Install-mariadb&quot; class=&quot;headerlink&quot; title=&quot;Install mariadb&quot;&gt;&lt;/a&gt;Install mariadb&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;https://downloads.mariadb.org/mariadb/repositories/#mirror=syringa&amp;amp;distro=CentOS&amp;amp;distro_release=centos7-amd64--centos7&amp;amp;version=10.1&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;MariaDB.repo&lt;/a&gt;&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;# MariaDB 10.1 CentOS repository list - created 2016-03-02 02:05 UTC&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# http://mariadb.org/mariadb/repositories/&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[mariadb]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;name = MariaDB&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;baseurl = http://yum.mariadb.org/10.1/centos7-amd64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;gpgkey=https://yum.mariadb.org/RPM-GPG-KEY-MariaDB&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;gpgcheck=1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# yum install mariadb-server mariadb-client mariadb-devel&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&quot;limit-conf&quot;&gt;&lt;a href=&quot;#limit-conf&quot; class=&quot;headerlink&quot; title=&quot;limit.conf&quot;&gt;&lt;/a&gt;limit.conf&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;*               soft    nofile           20000&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*               hard    nofile           20000&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*               soft    nproc            20000&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*               hard    nproc            20000&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;my-cnf&quot;&gt;&lt;a href=&quot;#my-cnf&quot; class=&quot;headerlink&quot; title=&quot;my.cnf&quot;&gt;&lt;/a&gt;my.cnf&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;connect_timeout=60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;innodb_max_dirty_pages_pct=0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;max_connections=400&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;table_open_cache=800&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;query_cache_type=0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;innodb_buffer_pool_size=1G&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;innodb_buffer_pool_instances=10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;innodb_adaptive_hash_index_partitions=20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;innodb_purge_threads=8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;innodb_read_io_threads=24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;innodb_write_io_threads=24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;innodb_flush_method=O_DIRECT_NO_FSYNC&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;innodb_data_file_path=ibdata1:50M:autoextend&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;innodb_file_per_table=true&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;performance-schema=false&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;back_log=150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;key_buffer_size=8M&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;query_cache_type=0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;innodb_open_files=100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;innodb_log_buffer_size=16M&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;innodb_log_file_size=4G&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;innodb_log_files_in_group=2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;innodb_flush_log_at_trx_commit=2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;innodb_thread_concurrency=0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;innodb_adaptive_flushing=1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;innodb_flush_neighbors=1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;innodb_io_capacity=4000&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;innodb_lru_scan_depth=4000&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# ulimit -n 20000&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# mysqld_safe --defaults-file=/etc/my.cnf&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;# mysql -u root -e &amp;quot;create database sbtest&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Run-benchmark&quot;&gt;&lt;a href=&quot;#Run-benchmark&quot; class=&quot;headerlink&quot; title=&quot;Run benchmark&quot;&gt;&lt;/a&gt;Run benchmark&lt;/h3&gt;&lt;p&gt;If you have password, please add “–mysql-password=yourpass”&lt;/p&gt;
&lt;h3 id=&quot;prepare&quot;&gt;&lt;a href=&quot;#prepare&quot; class=&quot;headerlink&quot; title=&quot;prepare&quot;&gt;&lt;/a&gt;prepare&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;# sysbench --test=tests/db/parallel_prepare.lua --mysql-host=127.0.0.1 --mysql-port=3306 --mysql-user=root --mysql-db=sbtest --oltp-tables-count=32 --oltp-table-size=500000 --num-threads=64 --max-time=300 prepare&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;write&quot;&gt;&lt;a href=&quot;#write&quot; class=&quot;headerlink&quot; title=&quot;write&quot;&gt;&lt;/a&gt;write&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;# sysbench --test=tests/db/oltp.lua --mysql-host=127.0.0.1 --mysql-port=3306 --mysql-user=root --mysql-db=sbtest --oltp_tables_count=32 --oltp-table-size=500000  --rand-type=uniform --oltp-read-only=off --num-threads=256 --max-requests=0 --max-time=300 --report-interval=2 run&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;read&quot;&gt;&lt;a href=&quot;#read&quot; class=&quot;headerlink&quot; title=&quot;read&quot;&gt;&lt;/a&gt;read&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;# sysbench --test=tests/db/oltp.lua --mysql-host=127.0.0.1 --mysql-port=3306 --mysql-user=root --mysql-db=sbtest --oltp_tables_count=32 --oltp-table-size=500000  --rand-type=uniform --oltp-read-only=on --num-threads=256 --max-requests=0 --max-time=300 --report-interval=2 run&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;rw&quot;&gt;&lt;a href=&quot;#rw&quot; class=&quot;headerlink&quot; title=&quot;rw&quot;&gt;&lt;/a&gt;rw&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;# sysbench --test=tests/db/oltp.lua --mysql-host=127.0.0.1 --mysql-port=3306 --mysql-user=root --mysql-db=sbtest --oltp_tables_count=32 --oltp-table-size=500000  --rand-type=uniform --oltp-read-only=off --num-threads=256 --max-requests=0 --max-time=300 --report-interval=2 run&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;update&quot;&gt;&lt;a href=&quot;#update&quot; class=&quot;headerlink&quot; title=&quot;update&quot;&gt;&lt;/a&gt;update&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# sysbench --test=tests/db/update_non_index.lua --mysql-host=127.0.0.1 --mysql-port=3306 --mysql-user=root --mysql-db=sbtest --oltp_tables_count=32 --oltp-table-size=500000  --rand-type=uniform --oltp-read-only=off --num-threads=256 --max-requests=0 --max-time=300 --report-interval=2 run&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;delete&quot;&gt;&lt;a href=&quot;#delete&quot; class=&quot;headerlink&quot; title=&quot;delete&quot;&gt;&lt;/a&gt;delete&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sysbench --test=tests/db/delete.lua --mysql-host=127.0.0.1 --mysql-port=3306 --mysql-user=root --mysql-db=sbtest --oltp_tables_count=32 --oltp-table-size=500000  --rand-type=uniform --oltp-read-only=off --num-threads=256 --max-requests=0 --max-time=300 --report-interval=2 run&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;result&quot;&gt;&lt;a href=&quot;#result&quot; class=&quot;headerlink&quot; title=&quot;result&quot;&gt;&lt;/a&gt;result&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;OLTP test statistics:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    queries performed:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        read:                            492604&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        write:                           140744&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        other:                           70372&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        total:                           703720&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    transactions:                        35186  (117.12 per sec.)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    read/write requests:                 633348 (2108.17 per sec.)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    other operations:                    70372  (234.24 per sec.)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ignored errors:                      0      (0.00 per sec.)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    reconnects:                          0      (0.00 per sec.)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;General statistics:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    total time:                          300.4258s&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    total number of events:              35186&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    total time taken by event execution: 9603.6924s&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    response time:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         min:                                 53.39ms&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         avg:                                272.94ms&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         max:                               1713.77ms&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         approx.  95 percentile:             496.65ms&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Threads fairness:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    events (avg/stddev):           1099.5625/11.17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    execution time (avg/stddev):   300.1154/0.12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;a href=&quot;https://www-304.ibm.com/partnerworld/wps/servlet/download/DownloadServlet?id=YxooL$U5GZkiPCA$cnt&amp;amp;attachmentName=primer_to_run_sysbench_and_mariadb_benchmarks_on_lop.pdf&amp;amp;token=MTQ1NjgyMjIzMTcyNA==&amp;amp;locale=en_ALL_ZZ&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;reference&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://mariadb.org/using-lua-enabled-sysbench/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;reference2&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Install-sysbench-0-5&quot;&gt;&lt;a href=&quot;#Install-sysbench-0-5&quot; class=&quot;headerlink&quot; title=&quot;Install sysbench 0.5&quot;&gt;&lt;/a&gt;Install sysbench 0.5&lt;/h3&gt;&lt;
    
    </summary>
    
      <category term="Linux configuration" scheme="http://yoursite.com/categories/Linux-configuration/"/>
    
    
      <category term="linux" scheme="http://yoursite.com/tags/linux/"/>
    
      <category term="iops" scheme="http://yoursite.com/tags/iops/"/>
    
      <category term="mariadb" scheme="http://yoursite.com/tags/mariadb/"/>
    
  </entry>
  
  <entry>
    <title>VLC not show media title</title>
    <link href="http://yoursite.com/2016/03/01/VLC-not-show-media-title/"/>
    <id>http://yoursite.com/2016/03/01/VLC-not-show-media-title/</id>
    <published>2016-03-01T09:00:07.000Z</published>
    <updated>2016-03-08T16:08:11.000Z</updated>
    
    <content type="html">&lt;p&gt;&lt;a href=&quot;https://forum.videolan.org/viewtopic.php?t=50202&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Same question&lt;/a&gt;&lt;br&gt;Tools–&amp;gt;Preferences–&amp;gt;Subtitles / OSD–&amp;gt; Show media title on media start (disable it)&lt;br&gt;Tools–&amp;gt;Preferences–&amp;gt;Subtitles / OSD–&amp;gt; Enable on screen display (disable it)&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://forum.videolan.org/viewtopic.php?t=50202&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Same question&lt;/a&gt;&lt;br&gt;Tools–&amp;gt;Preferences–&amp;gt;
    
    </summary>
    
      <category term="Linux configuration" scheme="http://yoursite.com/categories/Linux-configuration/"/>
    
    
      <category term="linux" scheme="http://yoursite.com/tags/linux/"/>
    
      <category term="vlc" scheme="http://yoursite.com/tags/vlc/"/>
    
      <category term="desktop" scheme="http://yoursite.com/tags/desktop/"/>
    
  </entry>
  
  <entry>
    <title>Install robinhood</title>
    <link href="http://yoursite.com/2016/02/18/Install-robinhood/"/>
    <id>http://yoursite.com/2016/02/18/Install-robinhood/</id>
    <published>2016-02-18T08:20:03.000Z</published>
    <updated>2016-03-08T16:08:11.000Z</updated>
    
    <content type="html">&lt;p&gt;Just analyse lustre data, not remove or move any file and directory.&lt;br&gt;And I created zfs pool in /var/lib/mysql, and enable lz4 compression.&lt;br&gt;Now here is compressratio&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# zfs get compressratio tank&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;NAME  PROPERTY       VALUE  SOURCE&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tank  compressratio  2.50x  -&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;CentOS 7.2 and Robinhood 2.5.5&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# yum -y install mariadb-devel mailx glib2-devel libattr-devel mariadb-server&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# tar xzvf robinhood-2.5.5.tar.gz&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# cd robinhood&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# ./configure --with-purpose=TMPFS&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# make rpm&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# rpm -ivh robinhood-tmpfs-2.5.5-4.lustre2.5.el7.centos.x86_64 robinhood-adm-2.5.5-4.noarch.x86_64&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&quot;Init-mariadb&quot;&gt;&lt;a href=&quot;#Init-mariadb&quot; class=&quot;headerlink&quot; title=&quot;Init mariadb&quot;&gt;&lt;/a&gt;Init mariadb&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# systemctl enable mariadb&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# systemctl start mariadb&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# mysqladmin -u root password &quot;your root password&quot;;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# rbh-config create_db&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Modify /etc/robinhood.d/tmpfs/templates/tmpfs_detailed.conf as your wish, and save it to /etc/robinhood.d/tmpfs/tmpfs.conf.&lt;/p&gt;
&lt;h3 id=&quot;Enable-lustre-changelog&quot;&gt;&lt;a href=&quot;#Enable-lustre-changelog&quot; class=&quot;headerlink&quot; title=&quot;Enable lustre changelog&quot;&gt;&lt;/a&gt;Enable lustre changelog&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ChangeLog&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# 1 MDT block for each MDT :&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    MDT&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        mdt_name = &lt;span class=&quot;string&quot;&gt;&quot;MDT0000&quot;&lt;/span&gt; ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        reader_id = &lt;span class=&quot;string&quot;&gt;&quot;cl1&quot;&lt;/span&gt; ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# clear changelog every 1024 records:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    batch_ack_count = 1024 ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    force_polling    = ON ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    polling_interval = 1s ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    queue_max_size   = 1000 ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    queue_max_age    = 5s ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    queue_check_interval = 1s ;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    dump_file = &lt;span class=&quot;string&quot;&gt;&quot;/var/lib/mysql/robinhood/changelog_dump.log&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# lctl --device lustrefs-MDT0000 changelog_register&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;lustrefs-MDT0000: Registered changlog userid &lt;span class=&quot;string&quot;&gt;&#39;cl1&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# lctl set_param mdd.lustrefs-MDT*.changelog_mask &quot;MARK CREAT MKDIR HLINK SLINK MKNOD UNLNK RMDIR RENME RNMTO OPEN LYOUT TRUNC SATTR XATTR HSM MTIME CTIME&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# lctl get_param mdd.lustrefs-MDT*.changelog_mask &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;MARK CREAT MKDIR HLINK SLINK MKNOD UNLNK RMDIR RENME RNMTO OPEN LYOUT TRUNC SATTR XATTR HSM MTIME CTIME&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Run-robinhood&quot;&gt;&lt;a href=&quot;#Run-robinhood&quot; class=&quot;headerlink&quot; title=&quot;Run robinhood&quot;&gt;&lt;/a&gt;Run robinhood&lt;/h3&gt;&lt;p&gt;write IOPS peak about 9000~10000 in single 10GbE SR SFP+ port.&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;robinhood &lt;span class=&quot;_&quot;&gt;-f&lt;/span&gt; /etc/robinhood.d/tmpfs/tmpfs.conf --read-log -C --dry-run --scan&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&quot;Show-data&quot;&gt;&lt;a href=&quot;#Show-data&quot; class=&quot;headerlink&quot; title=&quot;Show data&quot;&gt;&lt;/a&gt;Show data&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# rbh-report --top-users -U 10000&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Using config file &lt;span class=&quot;string&quot;&gt;&#39;/etc/robinhood.d/tmpfs/tmpfs.conf&#39;&lt;/span&gt;.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;rank, user      ,   spc_used,      count,   avg_size&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   1, 501       ,  142.80 TB,     593083,  252.58 MB&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   2, 35061     ,   33.82 TB,      50912,  696.54 MB&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   3, 35623     ,   29.91 TB,      42304,  741.30 MB&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   4, 666666    ,   26.17 TB,     300038,   91.44 MB&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   5, 35939     ,   16.26 TB,    1616106,   10.54 MB&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   6, 31344     ,   15.63 TB,     801339,   20.45 MB&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   7, 30428     ,   13.54 TB,     272051,   52.19 MB&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# rbh-report --top-users --by-count&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Using config file &lt;span class=&quot;string&quot;&gt;&#39;/etc/robinhood.d/tmpfs/tmpfs.conf&#39;&lt;/span&gt;.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;rank, user      ,   spc_used,      count,   avg_size&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   1, 28904     ,  778.50 GB,    4493723,  179.10 KB&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   2, 504       ,    4.14 TB,    2514345,    1.73 MB&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   3, 29637     ,    2.81 TB,    2152429,    1.37 MB&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   4, 29563     ,  873.35 GB,    1935333,  470.53 KB&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   5, 30185     ,  508.22 GB,    1695768,  310.95 KB&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   6, 35939     ,   16.26 TB,    1616106,   10.54 MB&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# rbh-du -sH /lustrefs/share_backup/ -u 30319 --details&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Using config file &lt;span class=&quot;string&quot;&gt;&#39;/etc/robinhood.d/tmpfs/tmpfs.conf&#39;&lt;/span&gt;.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ls &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;total&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	symlink count:895, size:46.3K, spc_used:1.4M&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	dir count:9877, size:42.7M, spc_used:42.7M&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	file count:128990, size:5.2T, spc_used:5.2T&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# rbh-du -H -u 30319&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Using config file &lt;span class=&quot;string&quot;&gt;&#39;/etc/robinhood.d/tmpfs/tmpfs.conf&#39;&lt;/span&gt;.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5.2T	/lustrefs&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# rbh-report -u 30319 -S&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Using config file &lt;span class=&quot;string&quot;&gt;&#39;/etc/robinhood.d/tmpfs/tmpfs.conf&#39;&lt;/span&gt;.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;user      ,      group,     &lt;span class=&quot;built_in&quot;&gt;type&lt;/span&gt;,      count,   spc_used,   avg_size&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30319     ,        725,  symlink,          5,    4.00 KB,         36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30319     ,        725,      dir,        811,    3.22 MB,    4.07 KB&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30319     ,        725,     file,       4388,    5.00 TB,    1.17 GB&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30319     ,        820,  symlink,         13,          0,         35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30319     ,        820,      dir,         23,   92.00 KB,    4.00 KB&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30319     ,        820,     file,        287,    7.78 GB,   27.77 MB&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30319     ,        859,  symlink,        881,    1.38 MB,         53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30319     ,        859,      dir,       9066,   39.48 MB,    4.45 KB&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30319     ,        859,     file,     124457,  208.88 GB,    1.72 MB&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30319     ,       root,      dir,          1,    4.00 KB,    4.00 KB&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# rbh-report -u 30319 --szprof&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Using config file &lt;span class=&quot;string&quot;&gt;&#39;/etc/robinhood.d/tmpfs/tmpfs.conf&#39;&lt;/span&gt;.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;user      ,     &lt;span class=&quot;built_in&quot;&gt;type&lt;/span&gt;,      count,   spc_used,   avg_size,        0,     1~31,   32~1K-,   1K~31K,  32K~1M-,   1M~31M,  32M~1G-,   1G~31G,  32G~1T-,      +1T&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30319     ,  symlink,        899,    1.39 MB,         53,        0,      357,      542,        0,        0,        0,        0,        0,        0,        0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30319     ,      dir,       9902,   42.80 MB,    4.42 KB,        0,        0,        0,     9875,       27,        0,        0,        0,        0,        0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30319     ,     file,     129132,    5.21 TB,   42.31 MB,     2288,     2300,    31102,    75173,    14854,     2366,      863,      100,       86,        0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Total: 139933 entries, 5728992747520 bytes used (5.21 TB)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# rbh-report --top-users --by-szratio=1G..31G&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Using config file &lt;span class=&quot;string&quot;&gt;&#39;/etc/robinhood.d/tmpfs/tmpfs.conf&#39;&lt;/span&gt;.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;rank, user      ,   spc_used,      count,   avg_size,        0,     1~31,   32~1K-,   1K~31K,  32K~1M-,   1M~31M,  32M~1G-,   1G~31G,  32G~1T-,      +1T, ratio(1G..31G)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   1, 29862     ,    8.96 TB,      10238,  918.14 MB,        9,        2,     1729,     2795,      466,      355,      679,     4185,       18,        0, 40.88%&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   2, 35590     ,   37.44 GB,         39,  983.16 MB,        2,        8,       10,        5,        0,        1,        0,       13,        0,        0, 33.33%&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   3, 35591     ,   17.47 GB,         22,  812.97 MB,        0,        0,       10,        3,        0,        1,        2,        6,        0,        0, 27.27%&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   4, qemu      ,  647.41 GB,        127,    5.27 GB,        0,        0,        5,       39,        3,       39,        6,       31,        4,        0, 24.41%&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# rbh-report --top-dirs --by-count&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Using config file &lt;span class=&quot;string&quot;&gt;&#39;/etc/robinhood.d/tmpfs/tmpfs.conf&#39;&lt;/span&gt;.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;rank,                                     path, dircount,    avgsize,       user,      group,             last_mod&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   1, /lustrefs/cm/net,  1365749,   56.84 KB,      35697,        904,  2016/02/01 03:58:45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   2, /lustrefs/tte/net,   443993,   54.27 KB,      35697,        904,  2016/01/25 12:24:21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   3, /lustrefs/tte/crf/crf-net,   443993,   39.71 KB,      35697,        904,  2016/01/26 03:04:40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   4, /lustrefs/LabelFree/net,   387909,   82.25 KB,      35697,        904,  2016/01/26 02:36:44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   5, /lustrefs/LabelFree/crf/crf-net,   387909,   50.98 KB,      35697,        904,  2016/01/26 06:02:10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# rbh-find /lustrefs/test/ -user 501 -size +1G –ost 4&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# rbh-find -user 501 -print&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/lustrefs/xxxx&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/lustrefs/xxx/xxx&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;......&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# rbh-report -a&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Using config file &lt;span class=&quot;string&quot;&gt;&#39;/etc/robinhood.d/tmpfs/tmpfs.conf&#39;&lt;/span&gt;.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Filesystem scan activity:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Current scan interval:   7.0d&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Previous filesystem scan:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            start:           2016/02/17 21:30:40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            duration:        02s&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Last filesystem scan:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            status:          &lt;span class=&quot;keyword&quot;&gt;done&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            start:           2016/02/17 21:30:43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            end:             2016/02/18 09:32:36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            duration:        12h 01min 53s&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         Statistics:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            entries scanned: 58038696&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            errors:          1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            timeouts:        0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;# threads:       24&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            average speed:   1450.15 entries/sec&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Changelog stats:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Last &lt;span class=&quot;built_in&quot;&gt;read&lt;/span&gt; record id:      5151588&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Last &lt;span class=&quot;built_in&quot;&gt;read&lt;/span&gt; record time:    2016/02/19 01:29:42.783530&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Last receive time:        2016/02/19 01:28:56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Last committed record id: 5151588&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Changelog stats:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                 &lt;span class=&quot;built_in&quot;&gt;type&lt;/span&gt;            total 	(diff)	(rate)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                 MARK:               0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                CREAT:         2363800 	(+30)	(0.03/sec)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                MKDIR:           48696&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                HLINK:             110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                SLINK:            1740 	(+2)	(0.00/sec)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                MKNOD:               0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                UNLNK:          137955 	(+161)	(0.13/sec)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                RMDIR:            5993 	(+1)	(0.00/sec)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                RENME:            3798 	(+5)	(0.00/sec)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                RNMTO:               0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                 OPEN:               0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                CLOSE:               0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                LYOUT:               0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                TRUNC:          236843&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                SATTR:         2164457 	(+19)	(0.02/sec)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                XATTR:           16732&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                  HSM:               0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                MTIME:             284&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                CTIME:               0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                ATIME:               0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Storage usage has never been checked&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;No purge was performed on this filesystem&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Install-web-interface&quot;&gt;&lt;a href=&quot;#Install-web-interface&quot; class=&quot;headerlink&quot; title=&quot;Install web interface&quot;&gt;&lt;/a&gt;Install web interface&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# rpm -ivh robinhood-webgui-2.5.5-4.noarch.x86_64.rpm&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# yum -y install php php-mysql php-xml php-pdo php-gd httpd&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# chown -R apache.apache /var/www/html/robinhood&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;## Modify httpd.conf&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;Directory &lt;span class=&quot;string&quot;&gt;&quot;/var/www/html&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    AllowOverride All&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Start httpd&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;bash&quot;&gt;systemctl &lt;span class=&quot;built_in&quot;&gt;enable&lt;/span&gt; httpd
systemctl start httpd
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;/img/robinhood_size.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;reference:&lt;br&gt;&lt;a href=&quot;https://github.com/cea-hpc/robinhood/wiki/Documentation&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/cea-hpc/robinhood/wiki/Documentation&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://cdn.opensfs.org/wp-content/uploads/2013/04/lug13-robinhood.pdf&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://cdn.opensfs.org/wp-content/uploads/2013/04/lug13-robinhood.pdf&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;Just analyse lustre data, not remove or move any file and directory.&lt;br&gt;And I created zfs pool in /var/lib/mysql, and enable lz4 compress
    
    </summary>
    
      <category term="Linux configuration" scheme="http://yoursite.com/categories/Linux-configuration/"/>
    
    
      <category term="linux" scheme="http://yoursite.com/tags/linux/"/>
    
      <category term="zfs" scheme="http://yoursite.com/tags/zfs/"/>
    
      <category term="robinhood" scheme="http://yoursite.com/tags/robinhood/"/>
    
  </entry>
  
  <entry>
    <title>Reinstall grub2</title>
    <link href="http://yoursite.com/2016/02/17/Reinstall-grub2/"/>
    <id>http://yoursite.com/2016/02/17/Reinstall-grub2/</id>
    <published>2016-02-17T08:02:32.000Z</published>
    <updated>2016-03-08T16:08:11.000Z</updated>
    
    <content type="html">&lt;h3 id=&quot;Boot-livecd-from-your-usb-device-or-network&quot;&gt;&lt;a href=&quot;#Boot-livecd-from-your-usb-device-or-network&quot; class=&quot;headerlink&quot; title=&quot;Boot livecd from your usb device or network&quot;&gt;&lt;/a&gt;Boot livecd from your usb device or network&lt;/h3&gt;&lt;p&gt;/dev/sdd2 is my linux root partition, OS is pinguyos(ubuntu)&lt;/p&gt;
&lt;h3 id=&quot;Test-in-ubuntu&quot;&gt;&lt;a href=&quot;#Test-in-ubuntu&quot; class=&quot;headerlink&quot; title=&quot;Test in ubuntu&quot;&gt;&lt;/a&gt;Test in ubuntu&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mount /dev/sdd2 /opt&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mount --bind /dev/ /opt/dev&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mount --bind /sys/ /opt/sys&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mount --bind /proc /opt/proc&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;chroot /opt&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;grub-install /dev/sdd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;grub-mkconfig -o /boot/grub/grub.cfg&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Test-in-CentOS-7-set-boot-menu&quot;&gt;&lt;a href=&quot;#Test-in-CentOS-7-set-boot-menu&quot; class=&quot;headerlink&quot; title=&quot;Test in CentOS 7, set boot menu&quot;&gt;&lt;/a&gt;Test in CentOS 7, set boot menu&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cat   /boot/grub2/grub.cfg | grep Windows&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;menuentry &lt;span class=&quot;string&quot;&gt;&quot;Windows 7 (loader) (on /dev/sda1)&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;grub2-set-default  &lt;span class=&quot;string&quot;&gt;&quot;Windows 7 (loader) (on /dev/sda1)&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;grub2-editenv list&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;saved_entry=Windows 7 (loader) (on /dev/sda1)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;or &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;grub2-set-default &lt;span class=&quot;string&quot;&gt;&quot;windows&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;grub2-mkconfig -o /boot/grub2/grub.conf&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Boot-livecd-from-your-usb-device-or-network&quot;&gt;&lt;a href=&quot;#Boot-livecd-from-your-usb-device-or-network&quot; class=&quot;headerlink&quot; title=&quot;Boot l
    
    </summary>
    
      <category term="Linux configuration" scheme="http://yoursite.com/categories/Linux-configuration/"/>
    
    
      <category term="linux" scheme="http://yoursite.com/tags/linux/"/>
    
      <category term="grub" scheme="http://yoursite.com/tags/grub/"/>
    
  </entry>
  
  <entry>
    <title>rdesktop to windows10</title>
    <link href="http://yoursite.com/2016/01/25/rdesktop-to-windows10/"/>
    <id>http://yoursite.com/2016/01/25/rdesktop-to-windows10/</id>
    <published>2016-01-25T08:28:47.000Z</published>
    <updated>2016-03-08T16:08:11.000Z</updated>
    
    <content type="html">&lt;h3 id=&quot;Enable-remote-desktop&quot;&gt;&lt;a href=&quot;#Enable-remote-desktop&quot; class=&quot;headerlink&quot; title=&quot;Enable remote desktop&quot;&gt;&lt;/a&gt;Enable remote desktop&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/img/e_desktop.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;&lt;img src=&quot;/img/e_firewall.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;Modify-registry&quot;&gt;&lt;a href=&quot;#Modify-registry&quot; class=&quot;headerlink&quot; title=&quot;Modify registry&quot;&gt;&lt;/a&gt;Modify registry&lt;/h3&gt;&lt;p&gt;\HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp\SecurityLayer&lt;br&gt;from DWORD Hex ‘2’ to a value of ‘1’&lt;/p&gt;
&lt;p&gt;reference:&lt;br&gt;&lt;a href=&quot;http://ubuntuforums.org/showthread.php?t=2287213&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://ubuntuforums.org/showthread.php?t=2287213&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Enable-remote-desktop&quot;&gt;&lt;a href=&quot;#Enable-remote-desktop&quot; class=&quot;headerlink&quot; title=&quot;Enable remote desktop&quot;&gt;&lt;/a&gt;Enable remote desktop&lt;/
    
    </summary>
    
      <category term="Linux configuration" scheme="http://yoursite.com/categories/Linux-configuration/"/>
    
    
      <category term="linux" scheme="http://yoursite.com/tags/linux/"/>
    
      <category term="rdesktop" scheme="http://yoursite.com/tags/rdesktop/"/>
    
      <category term="windows" scheme="http://yoursite.com/tags/windows/"/>
    
  </entry>
  
  <entry>
    <title>Encrypt block device</title>
    <link href="http://yoursite.com/2016/01/08/Encrypt-block-device/"/>
    <id>http://yoursite.com/2016/01/08/Encrypt-block-device/</id>
    <published>2016-01-08T05:01:30.000Z</published>
    <updated>2016-03-08T16:08:11.000Z</updated>
    
    <content type="html">&lt;h3 id=&quot;Input-password&quot;&gt;&lt;a href=&quot;#Input-password&quot; class=&quot;headerlink&quot; title=&quot;Input password&quot;&gt;&lt;/a&gt;&lt;em&gt;Input password&lt;/em&gt;&lt;/h3&gt;&lt;p&gt;or you can not use openssl&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cryptsetup luksFormat --cipher aes-xts-plain64 --key-size 512 --hash sha256 /dev/vdb     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;WARNING!     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;========     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;This will overwrite data on /dev/vdb irrevocably.     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Are you sure? (Type uppercase yes): YES      &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Enter passphrase:      &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Verify passphrase:&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&quot;mapper-test-device&quot;&gt;&lt;a href=&quot;#mapper-test-device&quot; class=&quot;headerlink&quot; title=&quot;mapper test device&quot;&gt;&lt;/a&gt;&lt;em&gt;mapper test device&lt;/em&gt;&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cryptsetup luksOpen /dev/vdb &lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Enter passphrase &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; /dev/vdb:     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;``` &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;###     &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;or     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;###     &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;``` bash&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; /dev/shm     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;openssl rand 128 -hex -out ./key     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;openssl aes-256-cbc -in ./key -out key.enc     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Verifying - enter aes-256-cbc encryption password:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;openssl aes-256-cbc &lt;span class=&quot;_&quot;&gt;-d&lt;/span&gt; -in ./key.enc | cryptsetup [--allow-discards] --key-file=- luksOpen /dev/vdb &lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;``` &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;If you have a SSD, you may want to use --allow-discards. It creates an information leak but it enhances your SSD’s lifetime.     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;``` bash&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mkfs.ext4 /dev/mapper/&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cryptsetup luksDump /dev/vdb     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;``` bash     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;LUKS header information &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; /dev/vdb     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Key Slot 0: ENABLED     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Iterations:         	80604     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Salt:               	c4 c0 08 9c 77 ef 57 a5 d2 62 f4 94 03 56 24 7a      &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	                      	86 0c f4 c6 06 6f 9e 01 80 &lt;span class=&quot;built_in&quot;&gt;fc&lt;/span&gt; 0f 1d 3b a9 59 87      &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	Key material offset:	8     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	AF stripes:            	4000     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Key Slot 1: DISABLED&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Add-remove-key&quot;&gt;&lt;a href=&quot;#Add-remove-key&quot; class=&quot;headerlink&quot; title=&quot;Add/remove key&quot;&gt;&lt;/a&gt;&lt;em&gt;Add/remove key&lt;/em&gt;&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cryptsetup luksAddKey --key-slot 1 /dev/vdb     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cryptsetup luksRemoveKey /dev/vdb&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Back-restore-header&quot;&gt;&lt;a href=&quot;#Back-restore-header&quot; class=&quot;headerlink&quot; title=&quot;Back/restore header&quot;&gt;&lt;/a&gt;&lt;em&gt;Back/restore header&lt;/em&gt;&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cryptsetup luksHeaderBackup /dev/vdb --header-backup-file /root/vdb-header-backup     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cryptsetup luksHeaderRestore /dev/vdb --header-backup-file /root/vdb-header-backup&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;is-luks-partition&quot;&gt;&lt;a href=&quot;#is-luks-partition&quot; class=&quot;headerlink&quot; title=&quot;is luks partition&quot;&gt;&lt;/a&gt;&lt;em&gt;is luks partition&lt;/em&gt;&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cryptsetup -v isLuks /dev/vdb&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Clean-luks-partition&quot;&gt;&lt;a href=&quot;#Clean-luks-partition&quot; class=&quot;headerlink&quot; title=&quot;Clean luks partition&quot;&gt;&lt;/a&gt;&lt;em&gt;Clean luks partition&lt;/em&gt;&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;head -c 3145728 /dev/zero &amp;gt; /dev/vdb;sync&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;The default LUKS header (with only one key-slot enabled) takes 1052672 bytes, what is slightly more than 1 MiB. Having 2 key-slots enabled this would extend the header almost twice (key-slots &lt;em&gt; stripes &lt;/em&gt; keysize + offset bytes). Therefore overwriting the first 3 MiB would do the job for us &lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Input-password&quot;&gt;&lt;a href=&quot;#Input-password&quot; class=&quot;headerlink&quot; title=&quot;Input password&quot;&gt;&lt;/a&gt;&lt;em&gt;Input password&lt;/em&gt;&lt;/h3&gt;&lt;p&gt;or you can no
    
    </summary>
    
      <category term="Linux configuration" scheme="http://yoursite.com/categories/Linux-configuration/"/>
    
    
      <category term="centos" scheme="http://yoursite.com/tags/centos/"/>
    
      <category term="encrypt" scheme="http://yoursite.com/tags/encrypt/"/>
    
      <category term="block device" scheme="http://yoursite.com/tags/block-device/"/>
    
  </entry>
  
  <entry>
    <title>Replace HDD for openzfs</title>
    <link href="http://yoursite.com/2015/12/04/Replace-HDD-for-openzfs/"/>
    <id>http://yoursite.com/2015/12/04/Replace-HDD-for-openzfs/</id>
    <published>2015-12-04T08:11:48.000Z</published>
    <updated>2016-03-08T16:08:11.000Z</updated>
    
    <content type="html">&lt;h3 id=&quot;Replace-HDD-when-raidz-has-degraded&quot;&gt;&lt;a href=&quot;#Replace-HDD-when-raidz-has-degraded&quot; class=&quot;headerlink&quot; title=&quot;Replace HDD when raidz has degraded&quot;&gt;&lt;/a&gt;Replace HDD when raidz has degraded&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$  zpool replace tank &lt;span class=&quot;_&quot;&gt;-f&lt;/span&gt; sdar&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$  zpool status&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  pool: tank&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; state: DEGRADED&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;status: One or more devices is currently being resilvered.  The pool will&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;continue&lt;/span&gt; to &lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;, possibly &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; a degraded state.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;action: Wait &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; the resilver to complete.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  scan: resilver &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; progress since Wed Aug 19 01:45:26 2015&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    91.6M scanned out of 66.9T at 9.16M/s, (scan is slow, no estimated time)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    3.94M resilvered, 0.00% &lt;span class=&quot;keyword&quot;&gt;done&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;......&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          raidz2-3                  DEGRADED     0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            sdal                    ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            sdam                    ONLINE       1    90     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            sdan                    ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            sdao                    ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            sdap                    ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            sdaq                    ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            replacing-6             UNAVAIL      0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              old                   UNAVAIL    101     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              sdar                  ONLINE       0     0     0  (resilvering)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            sdas                    ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            sdat                    ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            sdau                    ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            sdav                    ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        spares&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          scsi-35000c50021387d97    AVAIL&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          sdak                      AVAIL&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          sdaw                      AVAIL&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Replace-broken-HDD-and-insert-a-new-HDD-to-JBOD-enclosure&quot;&gt;&lt;a href=&quot;#Replace-broken-HDD-and-insert-a-new-HDD-to-JBOD-enclosure&quot; class=&quot;headerlink&quot; title=&quot;Replace broken HDD, and insert a new HDD to JBOD enclosure&quot;&gt;&lt;/a&gt;Replace broken HDD, and insert a new HDD to JBOD enclosure&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ zpool status&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  pool: tank&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; state: DEGRADED&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;status: One or more devices is currently being resilvered.  The pool will&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;continue&lt;/span&gt; to &lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt;, possibly &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; a degraded state.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;action: Wait &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; the resilver to complete.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  scan: resilver &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; progress since Wed Aug 19 01:45:26 2015&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    90.5G scanned out of 66.9T at 232M/s, 83h45m to go&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    4.09G resilvered, 0.13% &lt;span class=&quot;keyword&quot;&gt;done&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;config:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        NAME                        STATE     READ WRITE CKSUM&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        tank                        DEGRADED     0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          raidz2-0                  DEGRADED     0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            scsi-35000c500212bff8b  ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            scsi-35000c500212bed8f  ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            scsi-35000c500212c24d7  ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            scsi-35000c500212c1bdb  ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            scsi-35000c500212b9a0b  ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            scsi-35000c50034d625f7  ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            scsi-35000c500575f9a87  ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            scsi-35000c500212baaeb  ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            scsi-35000c500212bdcd3  UNAVAIL     33     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ ls /dev/disk/by-id/scsi-35000c500212bdcd3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ls: cannot access /dev/disk/by-id/scsi-35000c500212bdcd3: No such file or directory&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ zpool replace tank scsi-35000c500212bdcd3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cannot open &lt;span class=&quot;string&quot;&gt;&#39;scsi-35000c500212bdcd3&#39;&lt;/span&gt;: no such device &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; /dev&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;must be a full path or shorthand device name&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ dmesg&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;.....&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Aug 19 01:32:40 xxxx-host kernel: sd 1:0:53:0: [sdk] Spinning up disk....................ready&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Aug 19 01:32:40 xxxx-host kernel: sd 1:0:53:0: [sdk] 3907029168 512-byte logical blocks: (2.00 TB/1.81 TiB)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Aug 19 01:32:40 xxxx-host kernel: sd 1:0:53:0: [sdk] Write Protect is off&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Aug 19 01:32:40 xxxx-host kernel: sd 1:0:53:0: [sdk] Write cache: enabled, &lt;span class=&quot;built_in&quot;&gt;read&lt;/span&gt; cache: enabled, supports DPO and FUA&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Aug 19 01:32:40 xxxx-host kernel: sdk: unknown partition table&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Aug 19 01:32:40 xxxx-host kernel: sd 1:0:53:0: [sdk] Attached SCSI disk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#new hdd is sdk&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ zpool add tank spare sdk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        spares&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          scsi-35000c50021387d97    AVAIL&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          sdak                      AVAIL&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          sdaw                      AVAIL&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          sdk                       AVAIL&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ zpool replace tank scsi-35000c500212bdcd3 sdk&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  scan: resilver &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; progress since Wed Aug 19 01:57:53 2015&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    141M scanned out of 66.9T at 7.83M/s, (scan is slow, no estimated time)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    8.72M resilvered, 0.00% &lt;span class=&quot;keyword&quot;&gt;done&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;config:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        NAME                          STATE     READ WRITE CKSUM&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        tank                          DEGRADED     0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          raidz2-0                    DEGRADED     0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            scsi-35000c500212bff8b    ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            scsi-35000c500212bed8f    ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            scsi-35000c500212c24d7    ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            scsi-35000c500212c1bdb    ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            scsi-35000c500212b9a0b    ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            scsi-35000c50034d625f7    ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            scsi-35000c500575f9a87    ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            scsi-35000c500212baaeb    ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            spare-8                   UNAVAIL      0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              scsi-35000c500212bdcd3  UNAVAIL     33     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              sdk                     ONLINE       0     0     0  (resilvering)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Well done, it’s worked.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Replace-HDD-when-raidz-has-degraded&quot;&gt;&lt;a href=&quot;#Replace-HDD-when-raidz-has-degraded&quot; class=&quot;headerlink&quot; title=&quot;Replace HDD when raidz
    
    </summary>
    
      <category term="Linux configuration" scheme="http://yoursite.com/categories/Linux-configuration/"/>
    
    
      <category term="centos" scheme="http://yoursite.com/tags/centos/"/>
    
      <category term="linux" scheme="http://yoursite.com/tags/linux/"/>
    
      <category term="zfs" scheme="http://yoursite.com/tags/zfs/"/>
    
  </entry>
  
  <entry>
    <title>Openzfs tips</title>
    <link href="http://yoursite.com/2015/12/04/Openzfs-tips/"/>
    <id>http://yoursite.com/2015/12/04/Openzfs-tips/</id>
    <published>2015-12-04T07:06:13.000Z</published>
    <updated>2016-03-08T16:08:11.000Z</updated>
    
    <content type="html">&lt;h3 id=&quot;Compression&quot;&gt;&lt;a href=&quot;#Compression&quot; class=&quot;headerlink&quot; title=&quot;Compression&quot;&gt;&lt;/a&gt;Compression&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;zfs &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; compression=lz4 tank&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;zfs &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; compression=gzip-9 tank&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Xattr&quot;&gt;&lt;a href=&quot;#Xattr&quot; class=&quot;headerlink&quot; title=&quot;Xattr&quot;&gt;&lt;/a&gt;Xattr&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;zfs &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; xattr=sa tank&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;ACL&quot;&gt;&lt;a href=&quot;#ACL&quot; class=&quot;headerlink&quot; title=&quot;ACL&quot;&gt;&lt;/a&gt;ACL&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;zfs set acltype=posixacl tank/gentoo/home&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;zfs get acltype tank/gentoo/home&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Zpool-rename&quot;&gt;&lt;a href=&quot;#Zpool-rename&quot; class=&quot;headerlink&quot; title=&quot;Zpool rename&quot;&gt;&lt;/a&gt;Zpool rename&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;zpool &lt;span class=&quot;built_in&quot;&gt;export&lt;/span&gt; app&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;zpool import app apps&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Detach-hdd-from-mirror&quot;&gt;&lt;a href=&quot;#Detach-hdd-from-mirror&quot; class=&quot;headerlink&quot; title=&quot;Detach hdd from mirror&quot;&gt;&lt;/a&gt;Detach hdd from mirror&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;zpool detach tank sdz &lt;span class=&quot;comment&quot;&gt;#detach zda from mirror-17&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;only sdal &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; mirror-17, and mirror-17 is missing&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          mirror-16  ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            sdai     ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            sdaj     ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          sdal       ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          mirror-18  ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            sdam     ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            sdan     ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Attach-one-hdd-to-mirror&quot;&gt;&lt;a href=&quot;#Attach-one-hdd-to-mirror&quot; class=&quot;headerlink&quot; title=&quot;Attach one hdd to mirror&quot;&gt;&lt;/a&gt;Attach one hdd to mirror&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;zpool attach tank sdal sdz&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;          mirror-17  ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            sdal     ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            sdz      ONLINE       0     0     0  (resilvering)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;dir&quot;&gt;&lt;a href=&quot;#dir&quot; class=&quot;headerlink&quot; title=&quot;dir&quot;&gt;&lt;/a&gt;dir&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;zfs create tank/&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Quota&quot;&gt;&lt;a href=&quot;#Quota&quot; class=&quot;headerlink&quot; title=&quot;Quota&quot;&gt;&lt;/a&gt;Quota&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;zfs &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; quota=1024G tank/&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# disable&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;zfs &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; quota=none tank&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;user-quota&quot;&gt;&lt;a href=&quot;#user-quota&quot; class=&quot;headerlink&quot; title=&quot;user quota&quot;&gt;&lt;/a&gt;user quota&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;zfs &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; userquota@nagios=2G tank&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;dd &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;=/dev/zero of=/tank01/&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;/nagios bs=1M&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;dd: writing /tank/&lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;/nagios:Disk quota exceeded&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# zfs get userquota@nagios &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;NAME            PROPERTY          VALUE             SOURCE&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;tank01          userquota@nagios  2G                &lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# group&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;zfs &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; groupquota@staff=10G tank/staff/admins&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Limit-memory-usage&quot;&gt;&lt;a href=&quot;#Limit-memory-usage&quot; class=&quot;headerlink&quot; title=&quot;Limit memory usage&quot;&gt;&lt;/a&gt;Limit memory usage&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; xxx &amp;gt; /sys/module/zfs/parameters/zfs_arc_max&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cat xxx &amp;gt; /sys/module/zfs/parameters/zfs_arc_min&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cat /etc/modprobe.d/zfs.conf &lt;span class=&quot;comment&quot;&gt;# Min 4096MB / Max 8192MB limit&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;options zfs zfs_arc_min=4294967296&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;options zfs zfs_arc_max=8589934592&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#ZFS Device I/O Queue Depth&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;options zfs zfs_vdev_max_pending=24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;modprobe zfs zfs_arc_min=4294967296&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Custome-mount-path&quot;&gt;&lt;a href=&quot;#Custome-mount-path&quot; class=&quot;headerlink&quot; title=&quot;Custome mount path&quot;&gt;&lt;/a&gt;Custome mount path&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;zpool import  -R / tank-1 &lt;span class=&quot;comment&quot;&gt;#mount to /tank-1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;or &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;zfs &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; mountpoint=/zfs tank&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;zfs get mountpoint tank&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Add-and-remove-hotspare&quot;&gt;&lt;a href=&quot;#Add-and-remove-hotspare&quot; class=&quot;headerlink&quot; title=&quot;Add and remove hotspare&quot;&gt;&lt;/a&gt;Add and remove hotspare&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;zpool add tank spare c1t4d0 c1t5d0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;zpool remove tank c1t5d0&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Clear-zfs-label&quot;&gt;&lt;a href=&quot;#Clear-zfs-label&quot; class=&quot;headerlink&quot; title=&quot;Clear zfs label&quot;&gt;&lt;/a&gt;Clear zfs label&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;zpool labelclear /dev/sdxxx&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Lz4-Compression-ratio&quot;&gt;&lt;a href=&quot;#Lz4-Compression-ratio&quot; class=&quot;headerlink&quot; title=&quot;Lz4 Compression ratio&quot;&gt;&lt;/a&gt;Lz4 Compression ratio&lt;/h3&gt;&lt;p&gt;backup 5TB&lt;br&gt;zfs lz4: 3.5TB&lt;/p&gt;
&lt;p&gt;home 582G&lt;br&gt;zfs lz4: 337G&lt;/p&gt;
&lt;p&gt;project 3TB&lt;br&gt;zfs lz4: 1.7TB &lt;/p&gt;
&lt;h3 id=&quot;Auto-rebuild&quot;&gt;&lt;a href=&quot;#Auto-rebuild&quot; class=&quot;headerlink&quot; title=&quot;Auto rebuild&quot;&gt;&lt;/a&gt;Auto rebuild&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/zfsonlinux/zfs/issues/2449&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Autoreplace not working&lt;/a&gt;&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;zpool &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; autoreplace=on tank&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&quot;Tuning-for-Scrubs-and-Resilvers&quot;&gt;&lt;a href=&quot;#Tuning-for-Scrubs-and-Resilvers&quot; class=&quot;headerlink&quot; title=&quot;Tuning for Scrubs and Resilvers&quot;&gt;&lt;/a&gt;&lt;a href=&quot;http://broken.net/uncategorized/zfs-performance-tuning-for-scrubs-and-resilvers/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Tuning for Scrubs and Resilvers&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Prioritize resilvering by setting the delay to zero&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;set zfs:zfs_resilver_delay = 0&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Prioritize scrubs by setting the delay to zero&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;set zfs:zfs_scrub_delay = 0&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;set maximum number of inflight IOs to a reasonable value - this number will vary for your environment&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;set zfs:zfs_top_maxinflight = 128&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;resilver for five seconds per TXG&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;set zfs:zfs_resilver_min_time_ms = 5000&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&quot;http://zfsonlinux.org/docs.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://zfsonlinux.org/docs.html&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://ispire.me/if-zfs-is-eating-your-memory/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://ispire.me/if-zfs-is-eating-your-memory/&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://bbs.archlinux.org/viewtopic.php?id=171559&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://bbs.archlinux.org/viewtopic.php?id=171559&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://broken.net/uncategorized/zfs-performance-tuning-for-scrubs-and-resilvers/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://broken.net/uncategorized/zfs-performance-tuning-for-scrubs-and-resilvers/&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Compression&quot;&gt;&lt;a href=&quot;#Compression&quot; class=&quot;headerlink&quot; title=&quot;Compression&quot;&gt;&lt;/a&gt;Compression&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table
    
    </summary>
    
      <category term="Linux configuration" scheme="http://yoursite.com/categories/Linux-configuration/"/>
    
    
      <category term="centos" scheme="http://yoursite.com/tags/centos/"/>
    
      <category term="linux" scheme="http://yoursite.com/tags/linux/"/>
    
      <category term="zfs" scheme="http://yoursite.com/tags/zfs/"/>
    
  </entry>
  
  <entry>
    <title>Online dropbox with socks5 proxy (command line)</title>
    <link href="http://yoursite.com/2015/12/01/Online-dropbox-with-socks5-proxy-command-line/"/>
    <id>http://yoursite.com/2015/12/01/Online-dropbox-with-socks5-proxy-command-line/</id>
    <published>2015-12-01T05:58:40.000Z</published>
    <updated>2016-03-08T16:08:11.000Z</updated>
    
    <content type="html">&lt;p&gt;&lt;a href=&quot;https://www.dropboxforum.com/hc/en-us/community/posts/204324076-Drop-manual-proxy-setting-not-working-&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Manual proxy setting not working&lt;/a&gt;&lt;br&gt;I have the same problem. &lt;/p&gt;
&lt;p&gt;Linux Distribution: &lt;a href=&quot;http://pinguyos.com&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;PinguyOS&lt;/a&gt; base ubuntu 14.04.3 LTS&lt;/p&gt;
&lt;p&gt;Try&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;export&lt;/span&gt; http_proxy=socks5://username:passwd@socks5_proxy_ip:port&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;It’s not work too.&lt;/p&gt;
&lt;p&gt;Forward socks proxy to http&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ sudo aptitude install privoxy&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ cat /etc/privoxy/config&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;listen-address 127.0.0.1:1081&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;forward-socks5 / 127.0.0.1:1080 .&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;...&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ sudo /etc/init.d/privoxy start&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Try again&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ &lt;span class=&quot;built_in&quot;&gt;export&lt;/span&gt; http_proxy=&lt;span class=&quot;string&quot;&gt;&quot;http://127.0.0.1:1081&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ ~/.dropbox-dist/dropboxd&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;or &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ dropbox start -i&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Nice, It’s worked&lt;br&gt;&lt;img src=&quot;/img/dropbox_online.png&quot; alt=&quot;&quot;&gt; &lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;a href=&quot;https://www.dropboxforum.com/hc/en-us/community/posts/204324076-Drop-manual-proxy-setting-not-working-&quot; target=&quot;_blank&quot; rel=&quot;ext
    
    </summary>
    
      <category term="Linux configuration" scheme="http://yoursite.com/categories/Linux-configuration/"/>
    
    
      <category term="pinguyos" scheme="http://yoursite.com/tags/pinguyos/"/>
    
      <category term="dropbox" scheme="http://yoursite.com/tags/dropbox/"/>
    
      <category term="proxy" scheme="http://yoursite.com/tags/proxy/"/>
    
      <category term="socks5" scheme="http://yoursite.com/tags/socks5/"/>
    
      <category term="privoxy" scheme="http://yoursite.com/tags/privoxy/"/>
    
  </entry>
  
  <entry>
    <title>Recover openzfs partition table</title>
    <link href="http://yoursite.com/2015/11/20/Recover%20openzfs%20partition%20table/"/>
    <id>http://yoursite.com/2015/11/20/Recover openzfs partition table/</id>
    <published>2015-11-20T03:24:14.000Z</published>
    <updated>2016-03-08T16:08:11.000Z</updated>
    
    <content type="html">&lt;h3 id=&quot;backup-partition-table&quot;&gt;&lt;a href=&quot;#backup-partition-table&quot; class=&quot;headerlink&quot; title=&quot;backup partition table&quot;&gt;&lt;/a&gt;backup partition table&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# MBR&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sfdisk &lt;span class=&quot;_&quot;&gt;-d&lt;/span&gt; /dev/sda &amp;gt; /tmp/sda.bak&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sfdisk /dev/sda &amp;lt; /tmp/sda.bak&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;dd &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;=/dev/sda of=/dev/sdb bs=512 count=1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# GPT&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sgdisk --backup=table /dev/sda&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sgdisk --load-backup=table /dev/sdb&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sgdisk -G /dev/sdb&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;B=$(parted -ms /dev/sda &lt;span class=&quot;built_in&quot;&gt;print&lt;/span&gt; |tail -1|cut -b1)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;A=$((128*B)+1024)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;dd &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;=/dev/sda of=GPT_TABLE bs=1 count=&lt;span class=&quot;variable&quot;&gt;$A&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;dd &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;=GPT_TABLE of=/dev/sdb&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;partprobe /dev/sdb&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Backup is very important&lt;/p&gt;
&lt;h3 id=&quot;Damage-command&quot;&gt;&lt;a href=&quot;#Damage-command&quot; class=&quot;headerlink&quot; title=&quot;Damage command&quot;&gt;&lt;/a&gt;Damage command&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;950  parted /dev/sdb rm 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;951  df -h&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;952  zpool status&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;953  zpool destroy tank&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;954  yum remove $(rpm -qa | grepzfs)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;955 parted &lt;span class=&quot;_&quot;&gt;-a&lt;/span&gt; cylinder /dev/sdb mkpart primary 0 100%&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# same parted commmand with created&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;zpool -D improt failed, &lt;/p&gt;
&lt;h3 id=&quot;Found-uberblock-tag-label&quot;&gt;&lt;a href=&quot;#Found-uberblock-tag-label&quot; class=&quot;headerlink&quot; title=&quot;Found uberblock tag label&quot;&gt;&lt;/a&gt;Found uberblock tag label&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# dd if=/dev/sdb1 of=label-2m bs=1M count=2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;The begin address is 011bc00-128KB, and after 256KB is the uberblock&lt;br&gt;You can use zdb -l 256KB-file, you could get zpool info&lt;br&gt;&lt;img src=&quot;/img/uberblock_tag.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# awk &#39;BEGIN&amp;#123;printf &quot;%x&quot;,0x011bc00-0x0020000&quot;\n&quot;&amp;#125;&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;fbc00&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# awk &#39;BEGIN&amp;#123;printf &quot;%x&quot;,0x011bc00+0x0020000&quot;\n&quot;&amp;#125;&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13bc00&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;The address is from fbc00 to 13bc00&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;awk &lt;span class=&quot;string&quot;&gt;&#39;BEGIN&amp;#123;print (strtonum(&quot;0xfbc00&quot;))/1024&amp;#125;&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;1007&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;The begin address in 1007K of the disk (sdb1)&lt;/p&gt;
&lt;h3 id=&quot;Create-a-new-zpool-in-another-disk&quot;&gt;&lt;a href=&quot;#Create-a-new-zpool-in-another-disk&quot; class=&quot;headerlink&quot; title=&quot;Create a new zpool in another disk&quot;&gt;&lt;/a&gt;Create a new zpool in another disk&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# parted -a cylinder /dev/sdd mkpart primary 0 100%a&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# zpool create tank /dev/sdd1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# dd if=/dev/sdd1 of=label-sdd bs=1M count=2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&quot;/img/uberblock_tag2.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;The tag at 0021000, and there are nothing in previous part except zero&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# dd if=/dev/zero of=/dev/sdc1 bs=4k count=1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# dd if=/dev/sdb1 of=/dev/sdc1 bs=512 skip=2014 #offset 1007KB&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;You can use zdb get infomation from sdc1&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;version: 5000&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;name: &lt;span class=&quot;string&quot;&gt;&#39;tank&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;state: 2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;txg: 1256237&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pool_guid: 10281825564445304044&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;errata: 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;hostname: &lt;span class=&quot;string&quot;&gt;&#39;nas-56-11.local&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;top_guid: 8832263634429449792&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;guid: 8832263634429449792&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdev_children: 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;vdev_tree:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;type&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;disk&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    id: 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    guid: 8832263634429449792&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    path: &lt;span class=&quot;string&quot;&gt;&#39;/dev/sdb1&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    whole_disk: 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    metaslab_array: 33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    metaslab_&lt;span class=&quot;built_in&quot;&gt;shift&lt;/span&gt;: 37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    ashift: 12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    asize: 17990975750144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    is_&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;: 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    create_txg: 4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;When you dd complete. Use “zpool -D import tank” import the loss pool.&lt;br&gt;The disk is a hardraid , There are 17TB important data in it. It really scared the heck out of me.&lt;br&gt;Really Thank Javen Wu very much, Because your help these data could be recovery.&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;backup-partition-table&quot;&gt;&lt;a href=&quot;#backup-partition-table&quot; class=&quot;headerlink&quot; title=&quot;backup partition table&quot;&gt;&lt;/a&gt;backup partition tab
    
    </summary>
    
      <category term="Linux configuration" scheme="http://yoursite.com/categories/Linux-configuration/"/>
    
    
      <category term="linux" scheme="http://yoursite.com/tags/linux/"/>
    
      <category term="zfs" scheme="http://yoursite.com/tags/zfs/"/>
    
      <category term="data recovery" scheme="http://yoursite.com/tags/data-recovery/"/>
    
      <category term="partition" scheme="http://yoursite.com/tags/partition/"/>
    
  </entry>
  
  <entry>
    <title>CentOS 7 HA configuration (3 nodes and kvm stonith)</title>
    <link href="http://yoursite.com/2015/11/12/CentOS7%20HA%20configuration/"/>
    <id>http://yoursite.com/2015/11/12/CentOS7 HA configuration/</id>
    <published>2015-11-12T09:16:07.000Z</published>
    <updated>2016-03-08T16:08:11.000Z</updated>
    
    <content type="html">&lt;h3 id=&quot;Just-for-test-not-in-my-production-environment-it-is-incomplete&quot;&gt;&lt;a href=&quot;#Just-for-test-not-in-my-production-environment-it-is-incomplete&quot; class=&quot;headerlink&quot; title=&quot;Just for test , not in my production environment, it is incomplete&quot;&gt;&lt;/a&gt;Just for test , not in my production environment, it is incomplete&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;3 nodes linux HA replace 2 nodes&lt;/li&gt;
&lt;li&gt;fence kvm&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;Physical-node-OS&quot;&gt;&lt;a href=&quot;#Physical-node-OS&quot; class=&quot;headerlink&quot; title=&quot;Physical node OS&quot;&gt;&lt;/a&gt;Physical node OS&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;CentOS Linux release 7.1.1503 (Core) &lt;/li&gt;
&lt;li&gt;3.10.0-229.14.1.el7.x86_64&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;Virtual-machine-OS&quot;&gt;&lt;a href=&quot;#Virtual-machine-OS&quot; class=&quot;headerlink&quot; title=&quot;Virtual machine OS&quot;&gt;&lt;/a&gt;Virtual machine OS&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;CentOS release 6.7 (Final)&lt;/li&gt;
&lt;li&gt;2.6.32-504.30.3.el6_lustre.x86_64&lt;/li&gt;
&lt;li&gt;Not support SR-IOV&lt;/li&gt;
&lt;li&gt;Virtaul disk cache set to none&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;Create-linux-HA-3-x-physical-server&quot;&gt;&lt;a href=&quot;#Create-linux-HA-3-x-physical-server&quot; class=&quot;headerlink&quot; title=&quot;Create linux HA ,3 x physical server&quot;&gt;&lt;/a&gt;Create linux HA ,3 x physical server&lt;/h3&gt;&lt;p&gt;127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4&lt;br&gt;::1         localhost localhost.localdomain localhost6 localhost6.localdomain6&lt;br&gt;10.xx.xx.1 node01&lt;br&gt;10.xx.xx.2 node02&lt;br&gt;10.xx.xx.3 node03&lt;/p&gt;
&lt;h3 id=&quot;Share-strorages&quot;&gt;&lt;a href=&quot;#Share-strorages&quot; class=&quot;headerlink&quot; title=&quot;Share strorages&quot;&gt;&lt;/a&gt;Share strorages&lt;/h3&gt;&lt;p&gt;NFS/Lustre&lt;/p&gt;
&lt;h3 id=&quot;Installation&quot;&gt;&lt;a href=&quot;#Installation&quot; class=&quot;headerlink&quot; title=&quot;Installation&quot;&gt;&lt;/a&gt;Installation&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# yum -y install pacemaker corosync fence-agents-all fence-agents-virsh \&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  fence-virt pacemaker-remote pcs fence-virtd resource-agents \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  fence-virtd-libvirt fence-virtd-multicast&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Setup-physical-server&quot;&gt;&lt;a href=&quot;#Setup-physical-server&quot; class=&quot;headerlink&quot; title=&quot;Setup physical server&quot;&gt;&lt;/a&gt;Setup physical server&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# echo hacluster | passwd --stdin hacluster&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# systemctl enable pcsd.service&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# systemctl start pcsd.service&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# systemctl is-active pcsd.service&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# pcs cluster auth node01 node02 node03 ##input hacluster password for auth&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# pcs cluster setup --start --name ha-kvm node01 node02 node03&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# pcs property set no-quorum-policy=stop&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;4.1.2 Option no-quorum-policy&lt;/p&gt;
&lt;p&gt;This global option defines what to do when a cluster partition does not have quorum (no majority of nodes is part of the partition).&lt;/p&gt;
&lt;p&gt;Allowed values are:&lt;/p&gt;
&lt;p&gt;ignore&lt;br&gt;The quorum state does not influence the cluster behavior; resource management is continued.&lt;/p&gt;
&lt;p&gt;This setting is useful for the following scenarios:&lt;/p&gt;
&lt;p&gt;Two-node clusters: Since a single node failure would always result in a loss of majority, usually you want the cluster to carry on regardless. Resource integrity is ensured using fencing, which also prevents split brain scenarios.&lt;/p&gt;
&lt;p&gt;Resource-driven clusters: For local clusters with redundant communication channels, a split brain scenario only has a certain probability. Thus, a loss of communication with a node most likely indicates that the node has crashed, and that the surviving nodes should recover and start serving the resources again.&lt;/p&gt;
&lt;p&gt;If no-quorum-policy is set to ignore, a 4-node cluster can sustain concurrent failure of three nodes before service is lost. With the other settings, it would lose quorum after concurrent failure of two nodes.&lt;/p&gt;
&lt;p&gt;freeze&lt;br&gt;If quorum is lost, the cluster partition freezes. Resource management is continued: running resources are not stopped (but possibly restarted in response to monitor events), but no further resources are started within the affected partition.&lt;/p&gt;
&lt;p&gt;This setting is recommended for clusters where certain resources depend on communication with other nodes (for example, OCFS2 mounts). In this case, the default setting no-quorum-policy=stop is not useful, as it would lead to the following scenario: Stopping those resources would not be possible while the peer nodes are unreachable. Instead, an attempt to stop them would eventually time out and cause a stop failure, triggering escalated recovery and fencing.&lt;/p&gt;
&lt;p&gt;stop (default value)&lt;br&gt;If quorum is lost, all resources in the affected cluster partition are stopped in an orderly fashion.&lt;/p&gt;
&lt;p&gt;suicide&lt;br&gt;If quorum is lost, all nodes in the affected cluster partition are fenced.&lt;/p&gt;
&lt;h3 id=&quot;Setting-etc-corosync-corosync-conf-for-every-node&quot;&gt;&lt;a href=&quot;#Setting-etc-corosync-corosync-conf-for-every-node&quot; class=&quot;headerlink&quot; title=&quot;Setting /etc/corosync/corosync.conf for every node&quot;&gt;&lt;/a&gt;Setting /etc/corosync/corosync.conf for every node&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;totem &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    version: 2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    secauth: off&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    rrp_mode:active&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    cluster_name: ha-kvm&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    transport: udpu&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    token: 17000&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;nodelist &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  node &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	ring0_addr: 10.xx.xx.1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ring1_addr: 172.xx.xx.1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        nodeid: 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  node &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ring0_addr: 10.xx.xx.3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ring1_addr: 172.xx.xx.3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        nodeid: 2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  node &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ring0_addr: 10.xx.xx.2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ring1_addr: 172.xx.xx.2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        nodeid: 3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;quorum &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    provider: corosync_votequorum&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    expected_votes: 3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;logging &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        fileline: off&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        to_logfile: yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        to_syslog: yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        logfile: /var/&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;/cluster/corosync.log&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        timestamp: on&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Restart-corosync-service-in-each-node&quot;&gt;&lt;a href=&quot;#Restart-corosync-service-in-each-node&quot; class=&quot;headerlink&quot; title=&quot;Restart corosync service in each node&quot;&gt;&lt;/a&gt;Restart corosync service in each node&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# systemctl restart corosync&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Create-stonith-for-physical-server&quot;&gt;&lt;a href=&quot;#Create-stonith-for-physical-server&quot; class=&quot;headerlink&quot; title=&quot;Create stonith for physical server&quot;&gt;&lt;/a&gt;Create stonith for physical server&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# pcs stonith create node01-fencing fence_ipmilan pcmk_host_list=&quot;nod01 node02 node03&quot; \&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ipaddr=&lt;span class=&quot;string&quot;&gt;&quot;node1_ipmi_ipaddr&quot;&lt;/span&gt; login=ADMIN passwd=ADMIN lanplus=&lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt; power_&lt;span class=&quot;built_in&quot;&gt;wait&lt;/span&gt;=4 \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;op monitor interval=60s&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# pcs stonith create node02-fencing fence_ipmilan pcmk_host_list=&quot;nod01 node02 node03&quot; \&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; ipaddr=&lt;span class=&quot;string&quot;&gt;&quot;node2_ipmi_ipaddr&quot;&lt;/span&gt; login=ADMIN passwd=ADMIN lanplus=&lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt; power_&lt;span class=&quot;built_in&quot;&gt;wait&lt;/span&gt;=4 \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;op monitor interval=60s&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# pcs stonith create node03-fencing fence_ipmilan pcmk_host_list=&quot;nod01 node02 node03&quot; \&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ipaddr=&lt;span class=&quot;string&quot;&gt;&quot;node3_ipmi_ipaddr&quot;&lt;/span&gt; login=ADMIN passwd=ADMIN lanplus=&lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt; power_&lt;span class=&quot;built_in&quot;&gt;wait&lt;/span&gt;=4 op \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;monitor interval=60s&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# pcs property set stonith-enabled=true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# pcs status&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Cluster name: ha-kvm&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Last updated: Wed Nov 11 16:42:46 2015&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Last change: Wed Nov 11 02:48:26 2015 by root via crm_resource on node01&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Stack: corosync&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Current DC: node01 (version 1.1.13&lt;span class=&quot;_&quot;&gt;-a&lt;/span&gt;14efad) - partition with quorum&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3 nodes and 5 resources configured&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Online: [ node02 node03 node01 ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Full list of resources:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; node01-fencing	(stonith:fence_ipmilan):	Started node02&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; node03-fencing	(stonith:fence_ipmilan):	Started node01&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; node02-fencing	(stonith:fence_ipmilan):	Started node03&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;PCSD Status:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  node03: Online&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  node01: Online&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  node02: Online&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Daemon Status:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  corosync: active/enabled&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  pacemaker: active/enabled&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  pcsd: active/enabled&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Get-quorum-info&quot;&gt;&lt;a href=&quot;#Get-quorum-info&quot; class=&quot;headerlink&quot; title=&quot;Get quorum info&quot;&gt;&lt;/a&gt;Get quorum info&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# corosync-quorumtool -siH&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Quorum information&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;------------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Date:             Thu Nov 12 04:49:31 2015&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Quorum provider:  corosync_votequorum&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Nodes:            3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Node ID:          0x00000002&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Ring ID:          260&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Quorate:          Yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Votequorum information&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;----------------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Expected votes:   3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Highest expected: 3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Total votes:      3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Quorum:           2  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Flags:            Quorate &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Membership information&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;----------------------&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Nodeid      Votes Name&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0x00000003          1 10.0.0.80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0x00000001          1 10.0.10.97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0x00000002          1 10.0.10.106 (&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Install-kvm&quot;&gt;&lt;a href=&quot;#Install-kvm&quot; class=&quot;headerlink&quot; title=&quot;Install kvm&quot;&gt;&lt;/a&gt;Install kvm&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# yum install qemu-kvm libcacard qemu-kvm-common libvirt&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Create-HA-resource-for-kvm&quot;&gt;&lt;a href=&quot;#Create-HA-resource-for-kvm&quot; class=&quot;headerlink&quot; title=&quot;Create HA resource for kvm&quot;&gt;&lt;/a&gt;Create HA resource for kvm&lt;/h3&gt;&lt;p&gt;Delete cpu model in your xml file for prevent virsh start faild.&lt;/p&gt;
&lt;figure class=&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;cpu&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;mode&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&#39;custom&#39;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;match&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&#39;exact&#39;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;fallback&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&#39;allow&#39;&lt;/span&gt;&amp;gt;&lt;/span&gt;SandyBridge&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;model&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;cpu&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;cpu&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;mode&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&#39;custom&#39;&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;match&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&#39;exact&#39;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;attr&quot;&gt;fallback&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&#39;allow&#39;&lt;/span&gt;&amp;gt;&lt;/span&gt;Westmere&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;model&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;cpu&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# pcs resource create mds-01 VirtualDomain hypervisor=&quot;qemu:///system&quot; \&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;config=&lt;span class=&quot;string&quot;&gt;&quot;/xxx/mds01.xml&quot;&lt;/span&gt;  meta remote-node=&lt;span class=&quot;string&quot;&gt;&quot;mds-01&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# pcs resource create mds-02 VirtualDomain hypervisor=&quot;qemu:///system&quot; \&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;config=&lt;span class=&quot;string&quot;&gt;&quot;/xxx/mds02.xml&quot;&lt;/span&gt;  meta remote-node=&lt;span class=&quot;string&quot;&gt;&quot;mds-02&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;###Configure the pysical node for stonith&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# yum install fence-virt fence-virtd fence-virtd-multicast fence-virtd-libvirt&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# fence_virtd -c&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Accept all the defaults except &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; the items listed below, and the multicast IP and TCP port &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; you selected non-default ones:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Setting a preferred interface causes fence_virtd to listen only&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; on that interface.  Normally, it listens on all interfaces.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; In environments &lt;span class=&quot;built_in&quot;&gt;where&lt;/span&gt; the virtual machines are using the host&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; machine as a gateway, this *must* be &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; (typically to virbr0).&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Set to &lt;span class=&quot;string&quot;&gt;&#39;none&#39;&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; no interface.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Interface [none]: br1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;You can accept the default (none) &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; the guests have IPs on the &lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt; LAN. Here, we assume they &lt;span class=&quot;keyword&quot;&gt;do&lt;/span&gt; not.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Key File [none]: /etc/cluster/fence_xvm.key&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;This ensures only machines with the same key can initiate fencing requests.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;At the end, it will ask&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Replace /etc/fence_virt.conf with the above [y/N]? y&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Say yes.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;You should end up with a configuration like this &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; /etc/fence_virt.conf:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;backends &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         libvirt &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                 uri = &lt;span class=&quot;string&quot;&gt;&quot;qemu:///system&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; listeners &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         multicast &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                 key_file = &lt;span class=&quot;string&quot;&gt;&quot;/etc/cluster/fence_xvm.key&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                 interface = &lt;span class=&quot;string&quot;&gt;&quot;virbr0&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                 port = &lt;span class=&quot;string&quot;&gt;&quot;1229&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                 address = &lt;span class=&quot;string&quot;&gt;&quot;225.0.0.12&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                 family = &lt;span class=&quot;string&quot;&gt;&quot;ipv4&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; fence_virtd &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         backend = &lt;span class=&quot;string&quot;&gt;&quot;libvirt&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         listener = &lt;span class=&quot;string&quot;&gt;&quot;multicast&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;         module_path = &lt;span class=&quot;string&quot;&gt;&quot;/usr/lib64/fence-virt&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# mkdir -p /etc/cluster&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# dd if=/dev/urandom bs=4k count=1 of=/etc/cluster/fence_xvm.key&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# chmod 0600 /etc/cluster/fence_xvm.key&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;Required changes to the “address” value on both nodes&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;    (on node1)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    address = &lt;span class=&quot;string&quot;&gt;&quot;225.0.1.12&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    (on node2)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    address = &lt;span class=&quot;string&quot;&gt;&quot;225.0.2.12&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    (on node3)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    address = &lt;span class=&quot;string&quot;&gt;&quot;225.0.3.12&quot;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# fence_virtd  #start the daemon&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# fence_xvm -o list&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;iml-01               e95b2343-7d31-410d-1398-25c98daaaabd on&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;manager-kvm          24fa85e3-6cc0-4e1e-b8b5-cdd78aca1eff on&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mds-02               e95e6534-7a29-419b-9919-22d8cad8ef4d on&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&quot;Configure-the-virtual-machine-for-stonith&quot;&gt;&lt;a href=&quot;#Configure-the-virtual-machine-for-stonith&quot; class=&quot;headerlink&quot; title=&quot;Configure the virtual machine for stonith&quot;&gt;&lt;/a&gt;Configure the virtual machine for stonith&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# yum install fence-virt fence-virtd&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# mkdir -p /etc/cluster&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Copy the shared key from the physical host to vm:/etc/cluster/fence_xvm.key&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Create-stonith-resource-for-vm&quot;&gt;&lt;a href=&quot;#Create-stonith-resource-for-vm&quot; class=&quot;headerlink&quot; title=&quot;Create stonith resource for vm&quot;&gt;&lt;/a&gt;Create stonith resource for vm&lt;/h3&gt;&lt;p&gt;Because I do not know which vm would be running in one physical node. Because there are three physical server,&lt;br&gt;so I create three vm fencing for one vm.&lt;/p&gt;
&lt;p&gt;I setup a corosync with pacemaker two node cluster for mds-01 and mds-02&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# pcs stonith create xvmfence_mds-01-1 fence_xvm pcmk_host_list=&quot;mds-01 mds-02&quot; action=&quot;reboot&quot; \&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;key_file=/etc/cluster/fence_xvm.key multicast_address=225.0.1.12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# pcs stonith create xvmfence_mds-01-2 fence_xvm pcmk_host_list=&quot;mds-01 mds-02&quot; action=&quot;reboot&quot; \&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;key_file=/etc/cluster/fence_xvm.key multicast_address=225.0.2.12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# pcs stonith create xvmfence_mds-01-3 fence_xvm pcmk_host_list=&quot;mds-01 mds-02&quot; action=&quot;reboot&quot; \&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;key_file=/etc/cluster/fence_xvm.key multicast_address=225.0.3.12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# pcs stonith create xvmfence_mds-02-1 fence_xvm pcmk_host_list=&quot;mds-01 mds-02&quot; action=&quot;reboot&quot; \&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;key_file=/etc/cluster/fence_xvm.key multicast_address=225.0.1.12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# pcs stonith create xvmfence_mds-02-2 fence_xvm pcmk_host_list=&quot;mds-01 mds-02&quot; action=&quot;reboot&quot; \&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;key_file=/etc/cluster/fence_xvm.key multicast_address=225.0.2.12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# pcs stonith create xvmfence_mds-02-3 fence_xvm pcmk_host_list=&quot;mds-01 mds-02&quot; action=&quot;reboot&quot; \&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;key_file=/etc/cluster/fence_xvm.key multicast_address=225.0.3.12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# pcs status&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Cluster name: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Last updated: Thu Nov 12 08:36:34 2015&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Last change: Thu Nov 12 08:34:47 2015&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Stack: classic openais (with plugin)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Current DC: mds-01 - partition with quorum&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Version: 1.1.11-97629de&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2 Nodes configured, 2 expected votes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6 Resources configured&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Online: [ mds-01 mds-02 ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Full list of resources:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; xvmfence_mds-01-1	(stonith:fence_xvm):	Started mds-01 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; xvmfence_mds-01-2	(stonith:fence_xvm):	Started mds-02 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; xvmfence_mds-01-3	(stonith:fence_xvm):	Started mds-01 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; xvmfence_mds-02-1	(stonith:fence_xvm):	Started mds-02 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; xvmfence_mds-02-2	(stonith:fence_xvm):	Started mds-01 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; xvmfence_mds-02-3	(stonith:fence_xvm):	Started mds-02 &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Settting level for clsuter&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# pcs stonith level add 1 mds-01 xvmfence_mds-01-1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# pcs stonith level add 2 mds-01 xvmfence_mds-01-2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# pcs stonith level add 3 mds-01 xvmfence_mds-01-3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# pcs stonith level add 1 mds-01 xvmfence_mds-02-1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# pcs stonith level add 2 mds-01 xvmfence_mds-02-2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# pcs stonith level add 3 mds-01 xvmfence_mds-02-3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&quot;Test-vm-stonith&quot;&gt;&lt;a href=&quot;#Test-vm-stonith&quot; class=&quot;headerlink&quot; title=&quot;Test vm stonith&quot;&gt;&lt;/a&gt;Test vm stonith&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[root@mds-02 ~]&lt;span class=&quot;comment&quot;&gt;# fence_xvm -a 225.0.3.12 -k /etc/cluster/fence_xvm.key -H mds-01 -o status&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Status: ON  (It means mds-01 running &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; node3)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[root@mds-02 ~]&lt;span class=&quot;comment&quot;&gt;# fence_xvm -a 225.0.1.12 -k /etc/cluster/fence_xvm.key -H mds-01 -o status&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Status: OFF&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[root@mds-02 ~]&lt;span class=&quot;comment&quot;&gt;# fence_xvm -a 225.0.2.12 -k /etc/cluster/fence_xvm.key -H mds-01 -o status&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Status: OFF&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[root@mds-02 ~]&lt;span class=&quot;comment&quot;&gt;# fence_xvm -a 225.0.1.12 -k /etc/cluster/fence_xvm.key -H mds-02 -o status&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Status: ON  (It means mds-02 running &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; node1)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[root@mds-02 ~]&lt;span class=&quot;comment&quot;&gt;# fence_xvm -a 225.0.2.12 -k /etc/cluster/fence_xvm.key -H mds-02 -o status&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Status: OFF&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[root@mds-02 ~]&lt;span class=&quot;comment&quot;&gt;# fence_xvm -a 225.0.3.12 -k /etc/cluster/fence_xvm.key -H mds-02 -o status&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Status: OFF&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;fence mds-02&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[root@mds-01 ~]&lt;span class=&quot;comment&quot;&gt;# pcs stonith fence mds-02&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Node: mds-02 fenced&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[root@mds-02 ~]&lt;span class=&quot;comment&quot;&gt;# Write failed: Broken pipe&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;fence mds-01&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[root@mds-02 ~]&lt;span class=&quot;comment&quot;&gt;# pcs stonith fence mds-01&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Node: mds-01 fenced&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;[root@mds-01 ~]&lt;span class=&quot;comment&quot;&gt;# Write failed: Broken pipe&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;There is one Mellanox ConnectX-3 adapter could not work well in my test environment.&lt;br&gt;I checked config again and again until I upgrded the driver, it could work well.&lt;br&gt;Third time to waste my time in Mellanox ethernet adapter, until now I don’t think it’s a good choice.&lt;/p&gt;
&lt;p&gt;Reference&lt;br&gt;&lt;a href=&quot;http://clusterlabs.org/wiki/Guest_Fencing&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://clusterlabs.org/wiki/Guest_Fencing&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://access.redhat.com/solutions/293183&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://access.redhat.com/solutions/293183&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://access.redhat.com/solutions/917833&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://access.redhat.com/solutions/917833&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://alteeve.ca/w/Fencing_KVM_Virtual_Servers#Configuring_fence_xvm&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://alteeve.ca/w/Fencing_KVM_Virtual_Servers#Configuring_fence_xvm&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://people.redhat.com/ccaulfie/docs/Votequorum_Intro.pdf&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://people.redhat.com/ccaulfie/docs/Votequorum_Intro.pdf&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://www.ibm.com/developerworks/community/blogs/mhhaque/entry/configure_two_node_highly_available_cluster_using_kvm_fencing_on_rhel7?lang=en&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://www.ibm.com/developerworks/community/blogs/mhhaque/entry/configure_two_node_highly_available_cluster_using_kvm_fencing_on_rhel7?lang=en&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://www.suse.com/documentation/sle_ha/book_sleha/data/sec_ha_config_basics_global.html?view=print&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://www.suse.com/documentation/sle_ha/book_sleha/data/sec_ha_config_basics_global.html?view=print&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Just-for-test-not-in-my-production-environment-it-is-incomplete&quot;&gt;&lt;a href=&quot;#Just-for-test-not-in-my-production-environment-it-is-inco
    
    </summary>
    
      <category term="Linux configuration" scheme="http://yoursite.com/categories/Linux-configuration/"/>
    
    
      <category term="centos" scheme="http://yoursite.com/tags/centos/"/>
    
      <category term="ha" scheme="http://yoursite.com/tags/ha/"/>
    
      <category term="cluster" scheme="http://yoursite.com/tags/cluster/"/>
    
      <category term="linux" scheme="http://yoursite.com/tags/linux/"/>
    
      <category term="3 nodes" scheme="http://yoursite.com/tags/3-nodes/"/>
    
      <category term="corosync" scheme="http://yoursite.com/tags/corosync/"/>
    
      <category term="pacemaker" scheme="http://yoursite.com/tags/pacemaker/"/>
    
      <category term="kvm" scheme="http://yoursite.com/tags/kvm/"/>
    
      <category term="virtualization" scheme="http://yoursite.com/tags/virtualization/"/>
    
  </entry>
  
  <entry>
    <title>Tips-hard drive disk</title>
    <link href="http://yoursite.com/2015/11/06/Tips-hard-drive-disk/"/>
    <id>http://yoursite.com/2015/11/06/Tips-hard-drive-disk/</id>
    <published>2015-11-06T06:36:51.000Z</published>
    <updated>2016-03-08T16:08:11.000Z</updated>
    
    <content type="html">&lt;h3 id=&quot;Enable-Disable-SAS-HDD-write-cache&quot;&gt;&lt;a href=&quot;#Enable-Disable-SAS-HDD-write-cache&quot; class=&quot;headerlink&quot; title=&quot;Enable/Disable SAS HDD write cache&quot;&gt;&lt;/a&gt;Enable/Disable SAS HDD write cache&lt;/h3&gt;&lt;p&gt;Write Cache Enable&lt;br&gt;WCE=1 enable&lt;br&gt;WCE=0 disable&lt;/p&gt;
&lt;p&gt;Read Cache Disable&lt;br&gt;RCD=0 disable&lt;br&gt;RCD=1 enable&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;sdparm &lt;span class=&quot;_&quot;&gt;-s&lt;/span&gt; WCE=1, RCD=0 -S /dev/sdxx&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sdparm &lt;span class=&quot;_&quot;&gt;-a&lt;/span&gt; /dev/sdxx&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;SATA-HDD-write-cache&quot;&gt;&lt;a href=&quot;#SATA-HDD-write-cache&quot; class=&quot;headerlink&quot; title=&quot;SATA HDD write cache&quot;&gt;&lt;/a&gt;SATA HDD write cache&lt;/h3&gt;&lt;p&gt;W0 Off&lt;br&gt;W1 On&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;hdparm -W0 /dev/sda&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;hdparm -W /dev/sdx&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;hdparm -W1 /dev/sda&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;hdparm -W /dev/sdx&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&quot;Check-HDD&quot;&gt;&lt;a href=&quot;#Check-HDD&quot; class=&quot;headerlink&quot; title=&quot;Check HDD&quot;&gt;&lt;/a&gt;Check HDD&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;smartctl -t long /dev/sdx&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;smartctl -t short /dev/sdx&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Delete-Rescan-block-scsi-device&quot;&gt;&lt;a href=&quot;#Delete-Rescan-block-scsi-device&quot; class=&quot;headerlink&quot; title=&quot;Delete/Rescan block scsi device&quot;&gt;&lt;/a&gt;Delete/Rescan block scsi device&lt;/h3&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# echo 1 &amp;gt; /sys/block/sdXX/device/delete&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# echo &quot;- - -&quot; &amp;gt; /sys/class/scsi_host/hostXX/scan&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;Enable-Disable-SAS-HDD-write-cache&quot;&gt;&lt;a href=&quot;#Enable-Disable-SAS-HDD-write-cache&quot; class=&quot;headerlink&quot; title=&quot;Enable/Disable SAS HDD w
    
    </summary>
    
      <category term="Linux configuration" scheme="http://yoursite.com/categories/Linux-configuration/"/>
    
    
      <category term="linux" scheme="http://yoursite.com/tags/linux/"/>
    
      <category term="smartctl" scheme="http://yoursite.com/tags/smartctl/"/>
    
      <category term="hdparm" scheme="http://yoursite.com/tags/hdparm/"/>
    
      <category term="sdparm" scheme="http://yoursite.com/tags/sdparm/"/>
    
  </entry>
  
  <entry>
    <title>Some of Important HDD spec</title>
    <link href="http://yoursite.com/2015/11/06/Some%20of%20Important%20HDD%20spec/"/>
    <id>http://yoursite.com/2015/11/06/Some of Important HDD spec/</id>
    <published>2015-11-06T06:06:10.000Z</published>
    <updated>2016-03-08T16:08:11.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;Enterprise-HDD&quot;&gt;&lt;a href=&quot;#Enterprise-HDD&quot; class=&quot;headerlink&quot; title=&quot;Enterprise HDD&quot;&gt;&lt;/a&gt;Enterprise HDD&lt;/h2&gt;&lt;h3 id=&quot;Rotational-Speed-10K～15K&quot;&gt;&lt;a href=&quot;#Rotational-Speed-10K～15K&quot; class=&quot;headerlink&quot; title=&quot;Rotational Speed 10K～15K&quot;&gt;&lt;/a&gt;Rotational Speed 10K～15K&lt;/h3&gt;&lt;p&gt;Error Rate (non-recoverable, bits read)  1 sector per 10E16&lt;br&gt; Mean Time Between Failures (MTBF, hours)   &amp;lt;2M&lt;br&gt;Availability (hrs/day x days/wk)  24x7&lt;/p&gt;
&lt;h3 id=&quot;Rotational-Speed-7200&quot;&gt;&lt;a href=&quot;#Rotational-Speed-7200&quot; class=&quot;headerlink&quot; title=&quot;Rotational Speed 7200&quot;&gt;&lt;/a&gt;Rotational Speed 7200&lt;/h3&gt;&lt;p&gt;Error Rate (non-recoverable, bits read)  1 sector per 10E15&lt;br&gt;Mean Time Between Failures (MTBF, hours)  &amp;gt;1.2M&lt;br&gt;Availability (hrs/day x days/wk)  24x7&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/hdd-spec.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;there are 3 differents sector size in seagate product&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/img/sector-size.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Enterprise-HDD&quot;&gt;&lt;a href=&quot;#Enterprise-HDD&quot; class=&quot;headerlink&quot; title=&quot;Enterprise HDD&quot;&gt;&lt;/a&gt;Enterprise HDD&lt;/h2&gt;&lt;h3 id=&quot;Rotational-Speed-
    
    </summary>
    
      <category term="Hardware" scheme="http://yoursite.com/categories/Hardware/"/>
    
    
      <category term="hdd" scheme="http://yoursite.com/tags/hdd/"/>
    
      <category term="hard disk" scheme="http://yoursite.com/tags/hard-disk/"/>
    
  </entry>
  
  <entry>
    <title>Deploy Lustre and OpenZFS</title>
    <link href="http://yoursite.com/2015/11/06/Deploy%20Lustre%20and%20OpenZFS/"/>
    <id>http://yoursite.com/2015/11/06/Deploy Lustre and OpenZFS/</id>
    <published>2015-11-06T04:32:00.000Z</published>
    <updated>2016-03-08T16:08:11.000Z</updated>
    
    <content type="html">&lt;h2 id=&quot;Hardware&quot;&gt;&lt;a href=&quot;#Hardware&quot; class=&quot;headerlink&quot; title=&quot;Hardware&quot;&gt;&lt;/a&gt;Hardware&lt;/h2&gt;&lt;h3 id=&quot;MDS&quot;&gt;&lt;a href=&quot;#MDS&quot; class=&quot;headerlink&quot; title=&quot;MDS&quot;&gt;&lt;/a&gt;MDS&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;2 x SuperMicro SSG-6028R-E1CR12N (Xeon 2650 v3 8*16G)&lt;/li&gt;
&lt;li&gt;1 x 2U JBOD (216be26-r920lpb) 14 x ST600MP0005 + 2x ST200FM0002 &lt;/li&gt;
&lt;li&gt;2 x LSI Syncro CS 9286-8e (installed in MDS)&lt;br&gt;&lt;del&gt;test-test-test&lt;/del&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;OSS&quot;&gt;&lt;a href=&quot;#OSS&quot; class=&quot;headerlink&quot; title=&quot;OSS&quot;&gt;&lt;/a&gt;OSS&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;4 x SuperMicro SSG-6028R-E1CR12N (Xeon 2630v3 8*8G)&lt;/li&gt;
&lt;li&gt;4 x JBOD (SC847DE26-R2K02JBOD, installed 74 x ST6000NM0034) &lt;/li&gt;
&lt;li&gt;8 x LSI SAS2308 (installed in OSS)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Software&quot;&gt;&lt;a href=&quot;#Software&quot; class=&quot;headerlink&quot; title=&quot;Software&quot;&gt;&lt;/a&gt;Software&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;OS: CentOS 6.6 x64 2.6.32-504.30.3.el6_lustre.x86_64&lt;/li&gt;
&lt;li&gt;Lustre: 2.5.37.7 (Intel ieel 2.3)&lt;/li&gt;
&lt;li&gt;OpenZFS: 0.6.4-1&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;LSI-syncro-Architecture&quot;&gt;&lt;a href=&quot;#LSI-syncro-Architecture&quot; class=&quot;headerlink&quot; title=&quot;LSI syncro Architecture&quot;&gt;&lt;/a&gt;LSI syncro Architecture&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/img/mds.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;MDS-Architecture&quot;&gt;&lt;a href=&quot;#MDS-Architecture&quot; class=&quot;headerlink&quot; title=&quot;MDS Architecture&quot;&gt;&lt;/a&gt;MDS Architecture&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/img/mds-1.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;OSS-Architecture&quot;&gt;&lt;a href=&quot;#OSS-Architecture&quot; class=&quot;headerlink&quot; title=&quot;OSS Architecture&quot;&gt;&lt;/a&gt;OSS Architecture&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/img/oss.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;The-Installation-Process&quot;&gt;&lt;a href=&quot;#The-Installation-Process&quot; class=&quot;headerlink&quot; title=&quot;The Installation Process&quot;&gt;&lt;/a&gt;The Installation Process&lt;/h2&gt;&lt;h3 id=&quot;Configure-LSI-syncro-for-MDS&quot;&gt;&lt;a href=&quot;#Configure-LSI-syncro-for-MDS&quot; class=&quot;headerlink&quot; title=&quot;Configure LSI syncro for MDS&quot;&gt;&lt;/a&gt;Configure LSI syncro for MDS&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/img/config_syncro.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;/opt/MegaRAID/storcli/storcli64 /c1 show all&lt;/p&gt;
&lt;p&gt;High Availability :&lt;/p&gt;
&lt;p&gt;Topology Type = Server Storage Cluster&lt;br&gt;Domain Id = xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&lt;br&gt;Peer Controller Status = Active&lt;br&gt;Maximum Controller Nodes = 2&lt;br&gt;Incompatible Details = None&lt;/p&gt;
&lt;h3 id=&quot;Install-rpms-for-MDS&quot;&gt;&lt;a href=&quot;#Install-rpms-for-MDS&quot; class=&quot;headerlink&quot; title=&quot;Install rpms for MDS&quot;&gt;&lt;/a&gt;Install rpms for MDS&lt;/h3&gt;&lt;p&gt;rpm -ivh dracut-004-388.el6.noarch.rpm dracut-kernel-004-388.el6.noarch.rpm&lt;br&gt;rpm -ivh e2fsprogs-1.42.12.wc1-7.el6.x86_64.rpm e2fsprogs-1.42.12.wc1-bundle.tar.gz e2fsprogs libs-1.42.12.wc1-7.el6.x86_64.rpm libcom_err-1.42.12.wc1-7.el6.x86_64.rpm libss-1.42.12.wc1-7.el6.x86_64.rpm&lt;/p&gt;
&lt;p&gt;rpm -ivh kernel-2.6.32-504.30.3.el6_lustre.x86_64.rpm kernel-devel-2.6.32-504.30.3.el6_lustre.x86_64.rpm kernel-firmware-2.6.32-504.30.3.el6_lustre.x86_64.rpm kernel-headers-2.6.32-504.30.3.el6_lustre.x86_64.rpm lustre-modules-2.5.37.7-2.6.32_504.30.3.el6_lustre.x86_64.x86_64.rpm lustre-2.5.37.7-2.6.32_504.30.3.el6_lustre.x86_64.x86_64.rpm lustre-osd-ldiskfs-2.5.37.7-2.6.32_504.30.3.el6_lustre.x86_64.x86_64.rpm lustre-osd-ldiskfs-mount-2.5.37.7-2.6.32_504.30.3.el6_lustre.x86_64.x86_64.rpm&lt;/p&gt;
&lt;h3 id=&quot;Configuration-file-for-MDS&quot;&gt;&lt;a href=&quot;#Configuration-file-for-MDS&quot; class=&quot;headerlink&quot; title=&quot;Configuration file for MDS&quot;&gt;&lt;/a&gt;Configuration file for MDS&lt;/h3&gt;&lt;p&gt;disable selinux and iptables&lt;br&gt;echo  “options lnet networks=tcp(bond0)” &amp;gt; /etc/modprobe.d/lnet.conf&lt;br&gt;bond0 is data transfer network device&lt;/p&gt;
&lt;p&gt;pvcreate /dev/sdb&lt;br&gt;vgcreate mds_data /dev/sdb&lt;br&gt;lvcreate -l 2%VG -n mgt_lv mds_data&lt;br&gt;lvcreate -l 98%VG -n mdt_lv mds_data &lt;/p&gt;
&lt;p&gt;If you want deactivate it , you can use “vgchange -cn volume group”&lt;/p&gt;
&lt;h3 id=&quot;Exclude-os-volume-group&quot;&gt;&lt;a href=&quot;#Exclude-os-volume-group&quot; class=&quot;headerlink&quot; title=&quot;Exclude os volume group&quot;&gt;&lt;/a&gt;Exclude os volume group&lt;/h3&gt;&lt;p&gt;edit /etc/lvm/lvm.conf in mds1&lt;br&gt;volume_list = [ “vg_mds1”, “@MDS-11-1” ]&lt;br&gt;locking_type = 1&lt;/p&gt;
&lt;p&gt;dracut -f&lt;br&gt;reboot&lt;/p&gt;
&lt;p&gt;###Create Lustre file system for MDS&lt;br&gt;mkfs.lustre –reformat –mgs –servicenode=10.x.x.1@tcp –servicenode=10.x.x.2@tcp /dev/mapper/mds_data-mgt_lv&lt;/p&gt;
&lt;p&gt;mkfs.lustre –reformat –mdt –fsname=lustrewh –index=0 –mgsnode=10.xx.xx.1@tcp –mgsnode=10.xx.xx.2@tcp  –servicenode=10.x.x.1@tcp –servicenode=10.x.x.2@tcp  /dev/mapper/mds_data-mdt_lv&lt;/p&gt;
&lt;p&gt;You can mount the device where you want&lt;br&gt;/dev/mapper/mds_data-mdt_lv  lustre  2.5T  328M  2.3T   1% /lustre/mdt&lt;br&gt;/dev/mapper/mds_data-mgt_lv  lustre  66G   54M   63G   1% /lustre/mgt&lt;/p&gt;
&lt;h3 id=&quot;Prepare-create-HA-cluster&quot;&gt;&lt;a href=&quot;#Prepare-create-HA-cluster&quot; class=&quot;headerlink&quot; title=&quot;Prepare create HA cluster&quot;&gt;&lt;/a&gt;Prepare create HA cluster&lt;/h3&gt;&lt;p&gt;MDS1  eth0 192.xx.xx.1 (ipmi)&lt;br&gt;      eth1 192.168.1.1 (heartbeat)&lt;br&gt;      eth4 10.xx.xx.1  (production data)&lt;/p&gt;
&lt;p&gt;MDS2  eth0 192.xx.xx.2&lt;br&gt;      eth1 192.168.1.2&lt;br&gt;      eth4 10.xx.xx.2&lt;/p&gt;
&lt;p&gt;yum install -y pacemaker corosync pcs fence-agents resource-agents&lt;/p&gt;
&lt;p&gt;config corosync.conf to /etc/corosync/&lt;/p&gt;
&lt;p&gt;here is my ansible templates &lt;/p&gt;
&lt;p&gt;#cat corosync.conf.j2 &lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#Please read the corosync.conf.5 manual page&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;compatibility: whitetank&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;totem &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	version: 2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	secauth: off&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	interface &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		member &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			memberaddr: &amp;#123;&amp;#123; nicA1 &amp;#125;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		member &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			memberaddr: &amp;#123;&amp;#123; nicB1 &amp;#125;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		ringnumber: 0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		bindnetaddr: &amp;#123;&amp;#123; &lt;span class=&quot;built_in&quot;&gt;bind&lt;/span&gt;1 &amp;#125;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		mcastport: 5406&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		ttl: 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	interface &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                member &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        memberaddr: &amp;#123;&amp;#123; nicA2 &amp;#125;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                member &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        memberaddr: &amp;#123;&amp;#123; nicB2 &amp;#125;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                ringnumber: 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                bindnetaddr: &amp;#123;&amp;#123; &lt;span class=&quot;built_in&quot;&gt;bind&lt;/span&gt;2 &amp;#125;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                mcastport: 5406&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                ttl: 1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	transport: udpu&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	token: 17000&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	rrp_mode: passive&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;logging &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	fileline: off&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	to_logfile: yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	to_syslog: yes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	debug: on&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	logfile: /var/&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;/cluster/corosync.log&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	debug: off&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	timestamp: on&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	logger_subsys &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		subsys: AMF&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		debug: off&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;copy pacemaker to /etc/corosync/service.d/&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;service &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;# Load the Pacemaker Cluster Resource Manager&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        name: pacemaker&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ver:  1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;#cat /etc/hosts&lt;br&gt;127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4&lt;br&gt;:1         localhost localhost.localdomain localhost6 localhost6.localdomain6&lt;br&gt;10.xx.xx.1  MDS-11-1&lt;br&gt;10.xx.xx.2  MDS-11-2&lt;br&gt;10.xx.xx.4  OSS-11-4&lt;br&gt;10.xx.xx.5  OSS-11-5&lt;br&gt;10.xx.xx.6  OSS-11-6&lt;br&gt;10.xx.xx.7  OSS-11-7&lt;br&gt;192.xx.xx.1 MDS-11-1.ipmi&lt;br&gt;192.xx.xx.2 MDS-11-2.ipmi&lt;br&gt;192.xx.xx.4 OSS-11-4.ipmi&lt;br&gt;192.xx.xx.5 OSS-11-5.ipmi&lt;br&gt;192.xx.xx.6 OSS-11-6.ipmi&lt;br&gt;192.xx.xx.7 OSS-11-7.ipmi&lt;/p&gt;
&lt;p&gt;If you need install IML, keep the same with your HOSTNAME bash variable and dns resolve.&lt;/p&gt;
&lt;h3 id=&quot;Synchronizing-time-for-each-server&quot;&gt;&lt;a href=&quot;#Synchronizing-time-for-each-server&quot; class=&quot;headerlink&quot; title=&quot;Synchronizing time for each server&quot;&gt;&lt;/a&gt;Synchronizing time for each server&lt;/h3&gt;&lt;p&gt;go to &lt;a href=&quot;http://www.pool.ntp.org/en/#top&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.pool.ntp.org/en/#top&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Enable-service&quot;&gt;&lt;a href=&quot;#Enable-service&quot; class=&quot;headerlink&quot; title=&quot;Enable service&quot;&gt;&lt;/a&gt;Enable service&lt;/h3&gt;&lt;p&gt;/etc/init.d/corosync start&lt;br&gt;/etc/init.d/pacemaker restart&lt;br&gt;/etc/init.d/pcsd start&lt;br&gt;chkconfig –level 35 corosync on&lt;br&gt;chkconfig –level 35 pacemaker on&lt;br&gt;chkconfig –level 35 pcsd on&lt;/p&gt;
&lt;h3 id=&quot;Create-HA-cluster-for-MDS&quot;&gt;&lt;a href=&quot;#Create-HA-cluster-for-MDS&quot; class=&quot;headerlink&quot; title=&quot;Create HA cluster for MDS&quot;&gt;&lt;/a&gt;Create HA cluster for MDS&lt;/h3&gt;&lt;p&gt;pcs property set no-quorum-policy=ignore&lt;br&gt;pcs property set stonith-enabled=true&lt;/p&gt;
&lt;p&gt;pcs stonith create mds-11-1-fencing fence_ipmilan pcmk_host_list=”OSS-11-4.local” ipaddr=”192.xx.xx.1” login=ADMIN passwd=ADMIN lanplus=true power_wait=4 op monitor interval=60s&lt;br&gt;pcs stonith create mds-11-2-fencing fence_ipmilan pcmk_host_list=”OSS-11-4.local” ipaddr=”192.xx.xx.2” login=ADMIN passwd=ADMIN lanplus=true power_wait=4 op monitor interval=60s&lt;/p&gt;
&lt;p&gt;pcs resource create Lustre_mgt ocf:heartbeat:Filesystem device=”/dev/mapper/mds_data-mgt_lv” directory=”/lustre/mgt” fstype=”lustre”&lt;br&gt;pcs resource create Lustre_mdt ocf:heartbeat:Filesystem device=”/dev/mapper/mds_data-mdt_lv” directory=”/lustre/mdt” fstype=”lustre”&lt;/p&gt;
&lt;p&gt;pcs resource create mds_lv ocf:heartbeat:LVM volgrpname=mds_data exclusive=true&lt;br&gt;pcs constraint order mds_lv then Lustre_mgt&lt;br&gt;pcs constraint colocation add Lustre_mgt with mds_lv&lt;br&gt;pcs constraint order mds_lv then Lustre_mdt&lt;br&gt;pcs constraint colocation add Lustre_mdt with mds_lv&lt;/p&gt;
&lt;p&gt;pcs resource update Lustre_mgt op start interval=0 timeout=300&lt;br&gt;pcs resource update Lustre_mgt op stop interval=0 timeout=300&lt;br&gt;pcs resource update Lustre_mgt op monitor interval=5&lt;br&gt;pcs resource update mds_lv op start interval=0 timeout=300&lt;br&gt;pcs resource update mds_lv op stop interval=0 timeout=300&lt;br&gt;pcs resource update mds_lv op monitor interval=5&lt;br&gt;pcs resource update Lustre_mdt op start interval=0 timeout=300&lt;br&gt;pcs resource update Lustre_mdt op stop interval=0 timeout=300&lt;br&gt;pcs resource update Lustre_mdt op monitor interval=5 timeout=60&lt;br&gt;pcs resource meta Lustre_mgt migration-threshold=5&lt;br&gt;pcs resource meta Lustre_mdt migration-threshold=5&lt;br&gt;pcs resource meta mds_lv migration-threshold=5&lt;br&gt;pcs resource meta Lustre_mdt failure-timeout=120&lt;br&gt;pcs resource meta Lustre_mgt failure-timeout=120&lt;br&gt;pcs resource meta mds_lv failure-timeout=120&lt;/p&gt;
&lt;p&gt;default setting&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;pcs resource defaults migration-threshold=5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pcs resource defaults failure-timeout=240s&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pcs resource defaults resource-stickiness=100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pcs resource op defaults timeout=240s&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pcs property &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; stonith-action=reboot&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#delete value&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pcs resource defaults timouts=    &lt;span class=&quot;comment&quot;&gt;#not set any value&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#pcs status&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Cluster name: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Stack: classic openais (with plugin)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Current DC: MDS-11-2.local - partition with quorum&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Version: 1.1.11-97629de&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2 Nodes configured, 2 expected votes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4 Resources configured&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Online: [ MDS-11-1.local MDS-11-2.local ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Full list of resources:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; mds-11-1-fencing (stonith:fence_ipmilan): Started MDS-11-2.local &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; mds-11-2-fencing (stonith:fence_ipmilan): Started MDS-11-2.local &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Lustre_mgt (ocf::heartbeat:Filesystem): Started MDS-11-2.local &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; Lustre_mdt (ocf::heartbeat:Filesystem): Started MDS-11-1.local&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;About-OSS&quot;&gt;&lt;a href=&quot;#About-OSS&quot; class=&quot;headerlink&quot; title=&quot;About OSS&quot;&gt;&lt;/a&gt;About OSS&lt;/h3&gt;&lt;p&gt;OSS don ‘t like MDS, it ‘s base openzfs not ldiskfs.&lt;br&gt;OSS need be do 5.1 ~ 5.5 like MDS except 5.2, here is different setting&lt;/p&gt;
&lt;h3 id=&quot;Initialization-OpenZFS&quot;&gt;&lt;a href=&quot;#Initialization-OpenZFS&quot; class=&quot;headerlink&quot; title=&quot;Initialization OpenZFS&quot;&gt;&lt;/a&gt;Initialization OpenZFS&lt;/h3&gt;&lt;p&gt;rpm -ivh e2fsprogs-1.42.12.wc1-7.el6.x86_64.rpm e2fsprogs-1.42.12.wc1-bundle.tar.gz e2fsprogs libs-1.42.12.wc1-7.el6.x86_64.rpm libcom_err-1.42.12.wc1-7.el6.x86_64.rpm libss-1.42.12.wc1-7.el6.x86_64.rpm&lt;/p&gt;
&lt;p&gt;rpm -ivh dracut-004-388.el6.noarch.rpm dracut-kernel-004-388.el6.noarch.rpm&lt;/p&gt;
&lt;p&gt;rpm -ivh kernel-2.6.32-504.30.3.el6_lustre.x86_64.rpm kernel-devel-2.6.32-504.30.3.el6_lustre.x86_64.rpm kernel-firmware-2.6.32-504.30.3.el6_lustre.x86_64.rpm kernel-headers-2.6.32-504.30.3.el6_lustre.x86_64.rpm&lt;/p&gt;
&lt;h3 id=&quot;Setting-lnet&quot;&gt;&lt;a href=&quot;#Setting-lnet&quot; class=&quot;headerlink&quot; title=&quot;Setting lnet&quot;&gt;&lt;/a&gt;Setting lnet&lt;/h3&gt;&lt;p&gt;echo  “options lnet networks=tcp(bond0)” &amp;gt; /etc/modprobe.d/lnet.conf&lt;/p&gt;
&lt;h3 id=&quot;Limit-zfs-memory-useage-half-memory-to-avoid-OOM-killer&quot;&gt;&lt;a href=&quot;#Limit-zfs-memory-useage-half-memory-to-avoid-OOM-killer&quot; class=&quot;headerlink&quot; title=&quot;Limit zfs memory useage(half memory) ,to avoid OOM killer&quot;&gt;&lt;/a&gt;Limit zfs memory useage(half memory) ,to avoid OOM killer&lt;/h3&gt;&lt;p&gt;awk ‘$0~/MemTotal/ {print “options zfs zfs_arc_max=”$2*1024/2}’ /proc/meminfo &amp;gt; /etc/modprobe.d/zfs.conf&lt;br&gt;33720700928 = 32GB&lt;/p&gt;
&lt;h3 id=&quot;Setting-multipath-SAS-HDD-JBOD&quot;&gt;&lt;a href=&quot;#Setting-multipath-SAS-HDD-JBOD&quot; class=&quot;headerlink&quot; title=&quot;Setting multipath (SAS HDD, JBOD)&quot;&gt;&lt;/a&gt;Setting multipath (SAS HDD, JBOD)&lt;/h3&gt;&lt;p&gt;#cat /etc/multipath.conf | grep -v #&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;defaults &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;polling_interval  10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;path_selector  &lt;span class=&quot;string&quot;&gt;&quot;round-robin 0&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;path_grouping_policy failover&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;prio   const&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;path_checker  directio&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;rr_min_io  1000&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;max_fds   10240&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;rr_weight  priorities&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;failback  immediate&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;no_path_retry  fail&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;user_friendly_names no&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;blacklist &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        wwid 3600304801b1326001d0b4e480378fac8 &lt;span class=&quot;comment&quot;&gt;##root partition&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;If you use Dell MD34xx/NetAPP E27xx,Some of LSI chip in your Raid controller&lt;br&gt;You should change some in multipath.conf&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;defaults &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; polling_interval  10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; path_selector  &lt;span class=&quot;string&quot;&gt;&quot;round-robin 0&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; path_grouping_policy group_by_prio&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; prio   rdac&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; path_checker  rdac&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; rr_min_io  1000&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; max_fds    10240&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; rr_weight  priorities&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; failback  immediate&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; no_path_retry  30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; user_friendly_names no&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;reboot&lt;/p&gt;
&lt;p&gt;rpm -ivh spl-0.6.4.1-1.el6.src.rpm zfs-0.6.4.1-1.el6.src.rpm&lt;br&gt;rpmbuild -bb -v spl.spec&lt;br&gt;rpmbuild -bb -v zfs.spec&lt;br&gt;rpm -ivh spl-0.6.4.1-1.el6.x86_64.rpm spl-dkms-0.6.4.1-1.el6.noarch.rpm zfs-dkms-0.6.4.1-1.el6.noarch.rpm zfs-0.6.4.1-1.el6.x86_64.rpm libzpool2-0.6.4.1-1.el6.x86_64.rpm libnvpair1-0.6.4.1-1.el6.x86_64.rpm libuutil1-0.6.4.1-1.el6.x86_64.rpm libzfs2-0.6.4.1-1.el6.x86_64.rpm zfs-dracut-0.6.4.1-1.el6.x86_64.rpm&lt;/p&gt;
&lt;h3 id=&quot;Alias-HDD-name&quot;&gt;&lt;a href=&quot;#Alias-HDD-name&quot; class=&quot;headerlink&quot; title=&quot;Alias HDD name&quot;&gt;&lt;/a&gt;Alias HDD name&lt;/h3&gt;&lt;p&gt;#cat /etc/zfs/vdev_id.conf&lt;br&gt;multipath yes&lt;/p&gt;
&lt;p&gt;alias hdd-0-2-0 /dev/disk/by-id/dm-uuid-mpath-35000c50062a54f23&lt;br&gt;alias hdd-0-2-1 /dev/disk/by-id/dm-uuid-mpath-35000c500630fde27&lt;br&gt;alias hdd-0-2-2 /dev/disk/by-id/dm-uuid-mpath-35000c50062d67aa7&lt;br&gt;alias hdd-0-2-3 /dev/disk/by-id/dm-uuid-mpath-35000c50062db08ff&lt;br&gt;……..&lt;br&gt;alias hdd-1-5-15 /dev/disk/by-id/dm-uuid-mpath-35000c50062fdd8cf&lt;/p&gt;
&lt;h3 id=&quot;Create-zpool&quot;&gt;&lt;a href=&quot;#Create-zpool&quot; class=&quot;headerlink&quot; title=&quot;Create zpool&quot;&gt;&lt;/a&gt;Create zpool&lt;/h3&gt;&lt;p&gt;If you care performance ,don ‘t use ashift=9, In my case ,capacity is very important.&lt;/p&gt;
&lt;p&gt;zpool create -f ost-0 -o cachefile=none -o ashift=9 raidz3 hdd-0-2-0 hdd-0-2-1 hdd-0-2-2 hdd-0-2-3 hdd-0-2-4 hdd-0-2-5 hdd-0-2-6 hdd-0-2-7 hdd-0-2-8 hdd-0-2-9 hdd-2-10 hdd-2-11 spare hdd-0-3-15 hdd-0-5-15&lt;br&gt;……&lt;/p&gt;
&lt;p&gt;create from ost-0 to ost-11&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;zpool status ost-11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  pool: ost-11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; state: ONLINE&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  scan: resilvered 710K &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; 0h0m with 0 errors on Thu Aug 20 14:12:35 2015&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;config:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;NAME            STATE     READ WRITE CKSUM&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ost-11          ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  raidz3-0      ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    hdd-1-5-1   ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    hdd-1-5-2   ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    hdd-1-5-3   ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    hdd-1-5-5   ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    hdd-1-5-6   ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    hdd-1-5-7   ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    hdd-1-5-9   ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    hdd-1-5-10  ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    hdd-1-5-11  ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    hdd-1-5-12  ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    hdd-1-5-13  ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    hdd-1-5-14  ONLINE       0     0     0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;spares&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  hdd-1-3-15    AVAIL   &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  hdd-1-5-15    AVAIL&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Enable-ZFS-features&quot;&gt;&lt;a href=&quot;#Enable-ZFS-features&quot; class=&quot;headerlink&quot; title=&quot;Enable ZFS features&quot;&gt;&lt;/a&gt;Enable ZFS features&lt;/h3&gt;&lt;p&gt;for i in {0..11}&lt;br&gt;do&lt;br&gt;    zfs set acltype=posixacl ost-$i;&lt;br&gt;    zfs set compression=lz4 ost-$i;&lt;br&gt;    zfs set xattr=sa ost-$i;&lt;br&gt;done&lt;/p&gt;
&lt;h3 id=&quot;Format-zfs&quot;&gt;&lt;a href=&quot;#Format-zfs&quot; class=&quot;headerlink&quot; title=&quot;Format zfs&quot;&gt;&lt;/a&gt;Format zfs&lt;/h3&gt;&lt;p&gt;for i in {0..11}&lt;br&gt;do&lt;br&gt;echo “mkfs.lustre –reformat –ost –backfstype=zfs –fsname=lustrewh –index=$i –mgsnode=10.xx.xx.1@tcp –mgsnode=10.xx.xx.2@tcp  –servicenode=10.x.x.4@tcp –servicenode=10.x.x.5@tcp&lt;br&gt;ost-$i/ost-$i”&lt;br&gt;done&lt;/p&gt;
&lt;h3 id=&quot;Create-HA-cluster&quot;&gt;&lt;a href=&quot;#Create-HA-cluster&quot; class=&quot;headerlink&quot; title=&quot;Create HA cluster&quot;&gt;&lt;/a&gt;Create HA cluster&lt;/h3&gt;&lt;p&gt;/etc/corosync/corosync.conf&lt;br&gt;/etc/corosync/service.d/pacemaker&lt;br&gt;same with config MDS&lt;/p&gt;
&lt;p&gt;Copy hearbeat script to all member of the cluster node&lt;br&gt;Get the file &lt;a href=&quot;https://github.com/skiselkov/stmf-ha/blob/master/heartbeat/ZFS&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/skiselkov/stmf-ha/blob/master/heartbeat/ZFS&lt;/a&gt;&lt;br&gt;chmod 755 /usr/lib/ocf/resource.d/heartbeat/ZFS &lt;/p&gt;
&lt;p&gt;chmod 755 /usr/lib/ocf/resource.d/heartbeat/Lustre-ZFS&lt;br&gt;It ‘ s written by Paciucci Gabriele (intel)&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;162&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;163&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;164&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;165&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;166&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;167&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#!/bin/sh&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# Lustre-ZFS &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#      Description: Manages a Lustre target on a shared storage medium.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# usage: ./Lustre-ZFS &amp;#123;start|stop|status|monitor|validate-all|meta-data&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#      OCF parameters are as below:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#        OCF_RESKEY_vdev&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#	OCF_RESKEY_mountpoint&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# OCF_RESKEY_vdev : name of the target the script should operate on&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# OCF_RESKEY_mountpoint : name of the target the script should operate on&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;: &lt;span class=&quot;variable&quot;&gt;$&amp;#123;OCF_FUNCTIONS_DIR=$&amp;#123;OCF_ROOT&amp;#125;&lt;/span&gt;/resource.d/heartbeat&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;. &lt;span class=&quot;variable&quot;&gt;$&amp;#123;OCF_FUNCTIONS_DIR&amp;#125;&lt;/span&gt;/.ocf-shellfuncs&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;usage&lt;/span&gt;&lt;/span&gt;() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;usage: &lt;span class=&quot;variable&quot;&gt;$0&lt;/span&gt; &amp;#123;start|stop|status|monitor|meta-data&amp;#125;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;meta_data&lt;/span&gt;&lt;/span&gt;() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    cat &amp;lt;&amp;lt;END&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;?xml version=&lt;span class=&quot;string&quot;&gt;&quot;1.0&quot;&lt;/span&gt;?&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;!DOCTYPE resource-agent SYSTEM &lt;span class=&quot;string&quot;&gt;&quot;ra-api-1.dtd&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;resource-agent name=&lt;span class=&quot;string&quot;&gt;&quot;Lustre-ZFS&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;version&amp;gt;1.0&amp;lt;/version&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;longdesc lang=&lt;span class=&quot;string&quot;&gt;&quot;en&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Resource script &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; a Lustre ZFS Target.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;/longdesc&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;shortdesc lang=&lt;span class=&quot;string&quot;&gt;&quot;en&quot;&lt;/span&gt;&amp;gt;Manages Lustre ZFS Targets&amp;lt;/shortdesc&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;parameters&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;parameter name=&lt;span class=&quot;string&quot;&gt;&quot;vdev&quot;&lt;/span&gt; required=&lt;span class=&quot;string&quot;&gt;&quot;1&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;longdesc lang=&lt;span class=&quot;string&quot;&gt;&quot;en&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;The name of the ZFS vdev.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;/longdesc&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;shortdesc lang=&lt;span class=&quot;string&quot;&gt;&quot;en&quot;&lt;/span&gt;&amp;gt;vdev&amp;lt;/shortdesc&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;content &lt;span class=&quot;built_in&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;string&quot;&lt;/span&gt; default=&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;/parameter&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;parameter name=&lt;span class=&quot;string&quot;&gt;&quot;mountpoint&quot;&lt;/span&gt; required=&lt;span class=&quot;string&quot;&gt;&quot;1&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;longdesc lang=&lt;span class=&quot;string&quot;&gt;&quot;en&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;The mount point &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; the target&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;/longdesc&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;shortdesc lang=&lt;span class=&quot;string&quot;&gt;&quot;en&quot;&lt;/span&gt;&amp;gt;mountpoint&amp;lt;/shortdesc&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;content &lt;span class=&quot;built_in&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;string&quot;&gt;&quot;string&quot;&lt;/span&gt; default=&lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;/parameter&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;/parameters&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;actions&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;action name=&lt;span class=&quot;string&quot;&gt;&quot;start&quot;&lt;/span&gt; timeout=&lt;span class=&quot;string&quot;&gt;&quot;60&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;action name=&lt;span class=&quot;string&quot;&gt;&quot;stop&quot;&lt;/span&gt; timeout=&lt;span class=&quot;string&quot;&gt;&quot;60&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;action name=&lt;span class=&quot;string&quot;&gt;&quot;notify&quot;&lt;/span&gt; timeout=&lt;span class=&quot;string&quot;&gt;&quot;60&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;action name=&lt;span class=&quot;string&quot;&gt;&quot;monitor&quot;&lt;/span&gt; depth=&lt;span class=&quot;string&quot;&gt;&quot;0&quot;&lt;/span&gt; timeout=&lt;span class=&quot;string&quot;&gt;&quot;40&quot;&lt;/span&gt; interval=&lt;span class=&quot;string&quot;&gt;&quot;20&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;action name=&lt;span class=&quot;string&quot;&gt;&quot;validate-all&quot;&lt;/span&gt; timeout=&lt;span class=&quot;string&quot;&gt;&quot;5&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;action name=&lt;span class=&quot;string&quot;&gt;&quot;meta-data&quot;&lt;/span&gt; timeout=&lt;span class=&quot;string&quot;&gt;&quot;5&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;/actions&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;lt;/resource-agent&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;END&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;Target_start&lt;/span&gt;&lt;/span&gt;() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# See if the device is already mounted.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; Target_status &amp;gt;/dev/null 2&amp;gt;&amp;amp;1; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ocf_&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt; info &lt;span class=&quot;string&quot;&gt;&quot;Target &lt;span class=&quot;variable&quot;&gt;$TARGET&lt;/span&gt; is already started.&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$OCF_SUCCESS&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# this is not necessary, mount should start modules &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#    if ! grep -e &#39;lustre$&#39; /proc/filesystems &amp;gt;/dev/null; then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#        ocf_log err &quot;Couldn&#39;t find the lustre module in /proc/filesystems&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#        return $OCF_ERR_ARGS&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#    fi&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# start the target&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#    if ! chroma-agent mount_target --uuid $TARGET; then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ! mount -t lustre &lt;span class=&quot;variable&quot;&gt;$TARGET&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$MOUNT_POINT&lt;/span&gt;; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ocf_&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt; err &lt;span class=&quot;string&quot;&gt;&quot;Couldn&#39;t start target &lt;span class=&quot;variable&quot;&gt;$TARGET&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;built_in&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$OCF_ERR_GENERIC&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$OCF_SUCCESS&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;Target_notify&lt;/span&gt;&lt;/span&gt;() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$OCF_SUCCESS&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;Target_stop&lt;/span&gt;&lt;/span&gt;() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# started already?&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Target_status &amp;gt;/dev/null 2&amp;gt;&amp;amp;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; [ $? &lt;span class=&quot;_&quot;&gt;-eq&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$OCF_NOT_RUNNING&lt;/span&gt; ]; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;# woo!  nothing to do.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        rc=&lt;span class=&quot;variable&quot;&gt;$OCF_SUCCESS&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#        chroma-agent unmount_target --uuid $TARGET&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        umount &lt;span class=&quot;variable&quot;&gt;$MOUNT_POINT&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$rc&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;Target_status&lt;/span&gt;&lt;/span&gt;() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;# call the agent to see if it&#39;s running&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#    if chroma-agent target_running --uuid $TARGET &amp;gt;/dev/null 2&amp;gt;&amp;amp;1; then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; cat /proc/mounts |grep &lt;span class=&quot;variable&quot;&gt;$MOUNT_POINT&lt;/span&gt; &amp;gt;/dev/null 2&amp;gt;&amp;amp;1; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        rc=&lt;span class=&quot;variable&quot;&gt;$OCF_SUCCESS&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        msg=&lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$TARGET&lt;/span&gt; is started (running)&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        rc=&lt;span class=&quot;variable&quot;&gt;$OCF_NOT_RUNNING&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        msg=&lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$TARGET&lt;/span&gt; is stopped&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; [ &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$OP&lt;/span&gt;&quot;&lt;/span&gt; = &lt;span class=&quot;string&quot;&gt;&quot;status&quot;&lt;/span&gt; ]; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        ocf_&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt; info &lt;span class=&quot;string&quot;&gt;&quot;&lt;span class=&quot;variable&quot;&gt;$msg&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$rc&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;title&quot;&gt;Target_validate_all&lt;/span&gt;&lt;/span&gt;() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;built_in&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$OCF_SUCCESS&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; [ &lt;span class=&quot;variable&quot;&gt;$#&lt;/span&gt; &lt;span class=&quot;_&quot;&gt;-ne&lt;/span&gt; 1 ]; &lt;span class=&quot;keyword&quot;&gt;then&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    usage&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;built_in&quot;&gt;exit&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$OCF_ERR_ARGS&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;fi&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;TARGET=&lt;span class=&quot;variable&quot;&gt;$OCF_RESKEY_vdev&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;MOUNT_POINT=&lt;span class=&quot;variable&quot;&gt;$OCF_RESKEY_mountpoint&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;OP=&lt;span class=&quot;variable&quot;&gt;$1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# These operations do not require instance parameters&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$OP&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;meta-data)    meta_data&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              &lt;span class=&quot;built_in&quot;&gt;exit&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$OCF_SUCCESS&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              ;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;usage)        usage&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              &lt;span class=&quot;built_in&quot;&gt;exit&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$OCF_SUCCESS&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              ;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;status)       Target_status&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              &lt;span class=&quot;built_in&quot;&gt;exit&lt;/span&gt; $?&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              ;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;monitor)      Target_status&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              &lt;span class=&quot;built_in&quot;&gt;exit&lt;/span&gt; $?&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              ;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;validate-all) Target_validate_all&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              &lt;span class=&quot;built_in&quot;&gt;exit&lt;/span&gt; $?&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              ;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;stop)         Target_stop&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              &lt;span class=&quot;built_in&quot;&gt;exit&lt;/span&gt; $?&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              ;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;start)        Target_start&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              ;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*)            usage&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              &lt;span class=&quot;built_in&quot;&gt;exit&lt;/span&gt; &lt;span class=&quot;variable&quot;&gt;$OCF_ERR_UNIMPLEMENTED&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;              ;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;esac&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;exit&lt;/span&gt; $?&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;Configuration-HA&quot;&gt;&lt;a href=&quot;#Configuration-HA&quot; class=&quot;headerlink&quot; title=&quot;Configuration HA&quot;&gt;&lt;/a&gt;Configuration HA&lt;/h3&gt;&lt;p&gt;pcs property set no-quorum-policy=ignore&lt;br&gt;pcs property set stonith-enabled=true&lt;/p&gt;
&lt;p&gt;for i in {0..11}&lt;br&gt;do&lt;br&gt;  pcs resource create ost-$i ocf:heartbeat:ZFS  pool=ost-$i&lt;br&gt; pcs resource update ost-$i op start interval=0 timeout=360&lt;br&gt; pcs resource update ost-$i op stop interval=0 timeout=360&lt;br&gt; pcs resource update ost-$i op monitor interval=5 timeout=60&lt;br&gt;done&lt;/p&gt;
&lt;p&gt;for i in {0..11}&lt;br&gt; do&lt;br&gt;    mkdir /lustre_ost$i&lt;br&gt;    pcs resource create lustre_ost$i ocf:heartbeat:Lustre-ZFS vdev=”ost-$i/ost-$i” mountpoint=”/lustre_ost$i”&lt;br&gt; pcs resource update lustre_ost$i op start interval=0 timeout=360&lt;br&gt; pcs resource update lustre_ost$i op stop interval=0 timeout=360&lt;br&gt; pcs resource update lustre_ost$i op  monitor interval=5 timeout=60&lt;br&gt;done&lt;/p&gt;
&lt;p&gt;for i in {0..11}&lt;br&gt;do&lt;br&gt;pcs constraint order ost-$i then lustre_ost$i&lt;br&gt;pcs constraint colocation add lustre_ost$i with ost-$i&lt;br&gt;pcs resource meta ost-$i migration-threshold=5&lt;br&gt;pcs resource meta lustre_ost$i migration-threshold=5&lt;br&gt;pcs resource meta ost-$i failure-timeout=360&lt;br&gt;pcs resource meta lustre_ost$i failure-timeout=360&lt;br&gt;done&lt;br&gt;pcs stonith create oss-11-4-fencing fence_ipmilan pcmk_host_list=”OSS-11-4.local” ipaddr=”192.xx.xx.4” login=ADMIN passwd=ADMIN lanplus=true power_wait=4 op monitor interval=60s&lt;br&gt;pcs stonith create oss-11-5-fencing fence_ipmilan pcmk_host_list=”OSS-11-4.local” ipaddr=”192.xx.xx.5” login=ADMIN passwd=ADMIN lanplus=true power_wait=4 op monitor interval=60s&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;#pcs status&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Cluster name: &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Last updated: Tue Aug 25 15:36:31 2015&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Last change: Thu Aug 20 15:44:16 2015&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Stack: classic openais (with plugin)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Current DC: OSS-11-4.local - partition with quorum&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Version: 1.1.11-97629de&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2 Nodes configured, 2 expected votes&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26 Resources configured&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Online: [ OSS-11-4.local OSS-11-5.local ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Full list of resources:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; oss-11-4-fencing (stonith:fence_ipmilan): Started OSS-11-4.local &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; oss-11-5-fencing (stonith:fence_ipmilan): Started OSS-11-5.local &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; ost-0 (ocf::heartbeat:ZFS): Started OSS-11-4.local &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; ost-1 (ocf::heartbeat:ZFS): Started OSS-11-5.local &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; ost-2 (ocf::heartbeat:ZFS): Started OSS-11-4.local &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; ost-3 (ocf::heartbeat:ZFS): Started OSS-11-5.local &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;………..&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; lustre_ost7 (ocf::heartbeat:Lustre-ZFS): Started OSS-11-5.local &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; lustre_ost8 (ocf::heartbeat:Lustre-ZFS): Started OSS-11-4.local &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; lustre_ost9 (ocf::heartbeat:Lustre-ZFS): Started OSS-11-5.local &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; lustre_ost10 (ocf::heartbeat:Lustre-ZFS): Started OSS-11-4.local &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt; lustre_ost11 (ocf::heartbeat:Lustre-ZFS): Started OSS-11-5.local&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;Reference&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html-single/DM_Multipath/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html-single/DM_Multipath/&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Configuring_the_Red_Hat_High_Availability_Add-On_with_Pacemaker/index.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Configuring_the_Red_Hat_High_Availability_Add-On_with_Pacemaker/index.html&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://github.com/zfsonlinux/zfs/labels/Bug&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/zfsonlinux/zfs/labels/Bug&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://github.com/skiselkov/stmf-ha&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/skiselkov/stmf-ha&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://github.com/zfsonlinux/pkg-zfs/wiki/Ubuntu-ZFS-mountall-FAQ-and-troubleshooting&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/zfsonlinux/pkg-zfs/wiki/Ubuntu-ZFS-mountall-FAQ-and-troubleshooting&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://linux-ha.996297.n3.nabble.com/custom-script-status-td14629.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://linux-ha.996297.n3.nabble.com/custom-script-status-td14629.html&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://www.youtube.com/watch?v=2XQ3Kvtd-sw&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://www.youtube.com/watch?v=2XQ3Kvtd-sw&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://open-zfs.org/wiki/Main_Page&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://open-zfs.org/wiki/Main_Page&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://irvingpop.github.io/blog/2015/03/01/redhat7-clustering-experiments/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://irvingpop.github.io/blog/2015/03/01/redhat7-clustering-experiments/&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Hardware&quot;&gt;&lt;a href=&quot;#Hardware&quot; class=&quot;headerlink&quot; title=&quot;Hardware&quot;&gt;&lt;/a&gt;Hardware&lt;/h2&gt;&lt;h3 id=&quot;MDS&quot;&gt;&lt;a href=&quot;#MDS&quot; class=&quot;headerlink&quot; ti
    
    </summary>
    
      <category term="Linux configuration" scheme="http://yoursite.com/categories/Linux-configuration/"/>
    
    
      <category term="ha" scheme="http://yoursite.com/tags/ha/"/>
    
      <category term="cluster" scheme="http://yoursite.com/tags/cluster/"/>
    
      <category term="linux" scheme="http://yoursite.com/tags/linux/"/>
    
      <category term="corosync" scheme="http://yoursite.com/tags/corosync/"/>
    
      <category term="pacemaker" scheme="http://yoursite.com/tags/pacemaker/"/>
    
      <category term="lustre" scheme="http://yoursite.com/tags/lustre/"/>
    
      <category term="zfs" scheme="http://yoursite.com/tags/zfs/"/>
    
  </entry>
  
</feed>
