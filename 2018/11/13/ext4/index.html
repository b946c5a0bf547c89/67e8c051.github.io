<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>ext4 info | 己不由心，身又岂能由己</title><meta name="keywords" content="ext4"><meta name="author" content="Ginger"><meta name="copyright" content="Ginger"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="mkfs ext4 for stripe1$ mkfs.ext4 -E stride&#x3D;8,stripe-width&#x3D;128,lazy_itable_init&#x3D;0,lazy_journal_init&#x3D;0 &#x2F;dev&#x2F;sdxx1  Oh, shit , data loss, here is lustre ldiskfs backup dataWhen backing up operating syste">
<meta property="og:type" content="article">
<meta property="og:title" content="ext4 info">
<meta property="og:url" content="http://yoursite.com/2018/11/13/ext4/index.html">
<meta property="og:site_name" content="己不由心，身又岂能由己">
<meta property="og:description" content="mkfs ext4 for stripe1$ mkfs.ext4 -E stride&#x3D;8,stripe-width&#x3D;128,lazy_itable_init&#x3D;0,lazy_journal_init&#x3D;0 &#x2F;dev&#x2F;sdxx1  Oh, shit , data loss, here is lustre ldiskfs backup dataWhen backing up operating syste">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://homerl.github.io/img/hard-disk_223cf.jpg">
<meta property="article:published_time" content="2018-11-13T01:02:56.000Z">
<meta property="article:modified_time" content="2020-10-11T07:23:41.163Z">
<meta property="article:author" content="Ginger">
<meta property="article:tag" content="ext4">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://homerl.github.io/img/hard-disk_223cf.jpg"><link rel="shortcut icon" href="/img/stout-shield.png"><link rel="canonical" href="http://yoursite.com/2018/11/13/ext4/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  hexoversion: '5.2.0',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2020-10-11 15:23:41'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {
  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }

  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }
})()</script><meta name="generator" content="Hexo 5.2.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/huohuan.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">Articles</div><div class="length_num">57</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">Tags</div><div class="length_num">58</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">Categories</div><div class="length_num">7</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></li><li><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#mkfs-ext4-for-stripe"><span class="toc-number">1.</span> <span class="toc-text">mkfs ext4 for stripe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#For-huge-parttion-there-is-no-enough-memory-it-will-cause-slow"><span class="toc-number">2.</span> <span class="toc-text">For huge parttion, there is no enough memory, it will cause slow</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#guess-partion-start"><span class="toc-number">3.</span> <span class="toc-text">guess partion start</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Found-ext-magic-number"><span class="toc-number">4.</span> <span class="toc-text">Found ext magic number</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#because-there-is-no-any-parttion-in-this-block-dev"><span class="toc-number">5.</span> <span class="toc-text">because there is no any parttion in this block dev</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#You-can%E2%80%99t-fsck-by-default"><span class="toc-number">6.</span> <span class="toc-text">You can’t fsck by default</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Found-some-info-form-superblock"><span class="toc-number">7.</span> <span class="toc-text">Found some info form superblock</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#You-have-to-disable-ext-journal-make-it-like-ext2-all-blocks-full-scan"><span class="toc-number">8.</span> <span class="toc-text">You have to disable ext journal, make it like ext2, all blocks full scan</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Looks-like-the-block-dev-has-be-destroy-by-hardware-raid-controller-all-data-has-messed"><span class="toc-number">9.</span> <span class="toc-text">Looks like the block dev has be destroy by hardware raid controller, all data has messed</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#debugfs"><span class="toc-number">10.</span> <span class="toc-text">debugfs</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#check-ext4-fragment"><span class="toc-number">11.</span> <span class="toc-text">check ext4 fragment</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mount-the-backup-superblock"><span class="toc-number">12.</span> <span class="toc-text">mount the backup superblock</span></a></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(https://homerl.github.io/img/hard-disk_223cf.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">己不由心，身又岂能由己</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></li><li><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">ext4 info</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2018-11-13T01:02:56.000Z" title="Created 2018-11-13 09:02:56">2018-11-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2020-10-11T07:23:41.163Z" title="Updated 2020-10-11 15:23:41">2020-10-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Storage/">Storage</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h3 id="mkfs-ext4-for-stripe"><a href="#mkfs-ext4-for-stripe" class="headerlink" title="mkfs ext4 for stripe"></a>mkfs ext4 for stripe</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mkfs.ext4 -E stride=8,stripe-width=128,lazy_itable_init=0,lazy_journal_init=0 /dev/sdxx1</span><br></pre></td></tr></table></figure>

<p>Oh, shit , data loss, here is lustre ldiskfs</p>
<p>backup data<br>When backing up operating system partitions, the partition must be unmounted.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ dd <span class="keyword">if</span>=/dev/mapper/3600a098000b5ea3e000006065be52460 of=3600a098000b5ea3e000006065be52460 bs=1M conv=sparse</span><br><span class="line">or you could </span><br><span class="line">$ dump -0uf /backup-files/sda3.dump /dev/sda3</span><br><span class="line">$ dump -0u -f - /dev/sda1 | ssh root@test-server dd of=/tmp/sda1.dump</span><br><span class="line"><span class="comment"># recovery </span></span><br><span class="line">$ mount -t ext3 /dev/sda3 /mnt/sda3</span><br><span class="line">$ <span class="built_in">cd</span> /mnt/sda3</span><br><span class="line">restore -rf /backup-files/sda3.dump</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">$</span> <span class="string">debugfs</span> <span class="string">/dev/mapper/3600a098000b5ea3e000006065be52460</span></span><br><span class="line"><span class="string">debugfs</span> <span class="number">1.42</span><span class="number">.13</span><span class="string">.wc5</span> <span class="string">(15-Apr-2016)</span></span><br><span class="line"><span class="string">/dev/mapper/3600a098000b5ea3e000006065be52460:</span> <span class="string">Can&#x27;t</span> <span class="string">read</span> <span class="string">an</span> <span class="string">inode</span> <span class="string">bitmap</span> <span class="string">while</span> <span class="string">reading</span> <span class="string">inode</span> <span class="string">bitmap</span></span><br><span class="line"><span class="attr">debugfs:</span>  <span class="string">stats</span></span><br><span class="line"><span class="attr">stats:</span> <span class="string">Filesystem</span> <span class="string">not</span> <span class="string">open</span></span><br><span class="line"></span><br><span class="line"><span class="string">$</span> <span class="string">dumpe2fs</span> <span class="string">/dev/mapper/3600a098000b5ea3e000006065be52460</span></span><br><span class="line"><span class="string">dumpe2fs</span> <span class="number">1.42</span><span class="number">.13</span><span class="string">.wc5</span> <span class="string">(15-Apr-2016)</span></span><br><span class="line"><span class="attr">Filesystem volume name:</span>   <span class="string">ldfsqd1-OST0004</span></span><br><span class="line"><span class="attr">Last mounted on:</span>          <span class="string">/</span></span><br><span class="line"><span class="attr">Filesystem UUID:</span>          <span class="string">8ffd7826-f9f5-4e92-99ef-75cca46c281a</span></span><br><span class="line"><span class="attr">Filesystem magic number:</span>  <span class="number">0xEF53</span></span><br><span class="line"><span class="string">Filesystem</span> <span class="string">revision</span> <span class="comment">#:    1 (dynamic)</span></span><br><span class="line"><span class="attr">Filesystem features:</span>      <span class="string">has_journal</span> <span class="string">ext_attr</span> <span class="string">dir_index</span> <span class="string">filetype</span> <span class="string">needs_recovery</span> <span class="string">extent</span> <span class="string">64bit</span> <span class="string">mmp</span> <span class="string">flex_bg</span> <span class="string">sparse_super</span> <span class="string">large_file</span> <span class="string">huge_file</span> <span class="string">uninit_bg</span> <span class="string">dir_nlink</span> <span class="string">quota</span></span><br><span class="line"><span class="attr">Filesystem flags:</span>         <span class="string">signed_directory_hash</span></span><br><span class="line"><span class="attr">Default mount options:</span>    <span class="string">user_xattr</span> <span class="string">acl</span></span><br><span class="line"><span class="attr">Filesystem state:</span>         <span class="string">clean</span></span><br><span class="line"><span class="attr">Errors behavior:</span>          <span class="string">Continue</span></span><br><span class="line"><span class="attr">Filesystem OS type:</span>       <span class="string">Linux</span></span><br><span class="line"><span class="attr">Inode count:</span>              <span class="number">62914560</span></span><br><span class="line"><span class="attr">Block count:</span>              <span class="number">16106127360</span></span><br><span class="line"><span class="attr">Reserved block count:</span>     <span class="number">805306368</span></span><br><span class="line"><span class="attr">Free blocks:</span>              <span class="number">3782402091</span></span><br><span class="line"><span class="attr">Free inodes:</span>              <span class="number">60311208</span></span><br><span class="line"><span class="attr">First block:</span>              <span class="number">0</span></span><br><span class="line"><span class="attr">Block size:</span>               <span class="number">4096</span></span><br><span class="line"><span class="attr">Fragment size:</span>            <span class="number">4096</span></span><br><span class="line"><span class="attr">Group descriptor size:</span>    <span class="number">64</span></span><br><span class="line"><span class="attr">Blocks per group:</span>         <span class="number">32768</span></span><br><span class="line"><span class="attr">Fragments per group:</span>      <span class="number">32768</span></span><br><span class="line"><span class="attr">Inodes per group:</span>         <span class="number">128</span></span><br><span class="line"><span class="attr">Inode blocks per group:</span>   <span class="number">8</span></span><br><span class="line"><span class="attr">Flex block group size:</span>    <span class="number">256</span></span><br><span class="line"><span class="attr">Filesystem created:</span>       <span class="string">Tue</span> <span class="string">Oct</span> <span class="number">10</span> <span class="number">13</span><span class="string">:54:45</span> <span class="number">2017</span></span><br><span class="line"><span class="attr">Last mount time:</span>          <span class="string">Sat</span> <span class="string">Oct</span> <span class="number">20</span> <span class="number">16</span><span class="string">:15:57</span> <span class="number">2018</span></span><br><span class="line"><span class="attr">Last write time:</span>          <span class="string">Sat</span> <span class="string">Oct</span> <span class="number">20</span> <span class="number">16</span><span class="string">:15:57</span> <span class="number">2018</span></span><br><span class="line"><span class="attr">Mount count:</span>              <span class="number">8</span></span><br><span class="line"><span class="attr">Maximum mount count:</span>      <span class="number">-1</span></span><br><span class="line"><span class="attr">Last checked:</span>             <span class="string">Tue</span> <span class="string">Oct</span> <span class="number">10</span> <span class="number">13</span><span class="string">:54:45</span> <span class="number">2017</span></span><br><span class="line"><span class="attr">Check interval:</span>           <span class="number">0</span> <span class="string">(&lt;none&gt;)</span></span><br><span class="line"><span class="attr">Lifetime writes:</span>          <span class="number">5132 </span><span class="string">GB</span></span><br><span class="line"><span class="attr">Reserved blocks uid:</span>      <span class="number">0</span> <span class="string">(user</span> <span class="string">root)</span></span><br><span class="line"><span class="attr">Reserved blocks gid:</span>      <span class="number">0</span> <span class="string">(group</span> <span class="string">root)</span></span><br><span class="line"><span class="attr">First inode:</span>              <span class="number">11</span></span><br><span class="line"><span class="attr">Inode size:</span>	          <span class="number">256</span></span><br><span class="line"><span class="attr">Required extra isize:</span>     <span class="number">28</span></span><br><span class="line"><span class="attr">Desired extra isize:</span>      <span class="number">28</span></span><br><span class="line"><span class="attr">Journal inode:</span>            <span class="number">8</span></span><br><span class="line"><span class="attr">Default directory hash:</span>   <span class="string">half_md4</span></span><br><span class="line"><span class="attr">Directory Hash Seed:</span>      <span class="string">7d46aee3-a481-456b-b9ff-6c7ab59a6e1c</span></span><br><span class="line"><span class="attr">Journal backup:</span>           <span class="string">inode</span> <span class="string">blocks</span></span><br><span class="line"><span class="attr">MMP block number:</span>         <span class="number">10246</span></span><br><span class="line"><span class="attr">MMP update interval:</span>      <span class="number">5</span></span><br><span class="line"><span class="attr">User quota inode:</span>         <span class="number">3</span></span><br><span class="line"><span class="attr">Group quota inode:</span>        <span class="number">4</span></span><br><span class="line"><span class="string">Journal</span> <span class="string">superblock</span> <span class="string">magic</span> <span class="string">number</span> <span class="string">invalid!</span></span><br><span class="line"><span class="string">......</span></span><br><span class="line"><span class="string">$</span> <span class="string">grep</span>  <span class="string">--binary-files=text</span> <span class="number">0000430</span> <span class="string">3600a09800099437b000008f05be52536</span></span><br><span class="line"><span class="attr">0000430:</span> <span class="string">9aba</span> <span class="string">e45b</span> <span class="string">0c00</span> <span class="string">ffff</span> <span class="string">53ef</span> <span class="number">0100 </span><span class="number">0100 </span><span class="number">0000</span>  <span class="string">...[....S.......</span></span><br><span class="line"><span class="string">The</span> <span class="string">magic</span> <span class="string">number</span> <span class="string">is</span> <span class="string">little-endian</span> <span class="number">0xef53</span></span><br><span class="line"></span><br><span class="line"><span class="string">$</span> <span class="string">dumpe2fs</span> <span class="string">/dev/mapper/3600a098000b5ea3e000006055be52442</span> <span class="string">|</span> <span class="string">grep</span> <span class="string">superblock</span> <span class="string">-i</span></span><br><span class="line"><span class="string">dumpe2fs</span> <span class="number">1.42</span><span class="number">.13</span><span class="string">.wc5</span> <span class="string">(15-Apr-2016)</span></span><br><span class="line">  <span class="string">Primary</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">0</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">1</span><span class="number">-7680</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">32768</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">32769</span><span class="number">-40448</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">98304</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">98305</span><span class="number">-105984</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">163840</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">163841</span><span class="number">-171520</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">229376</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">229377</span><span class="number">-237056</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">294912</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">294913</span><span class="number">-302592</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">819200</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">819201</span><span class="number">-826880</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">884736</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">884737</span><span class="number">-892416</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">1605632</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">1605633</span><span class="number">-1613312</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">2654208</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">2654209</span><span class="number">-2661888</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">4096000</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">4096001</span><span class="number">-4103680</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">7962624</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">7962625</span><span class="number">-7970304</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">11239424</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">11239425</span><span class="number">-11247104</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">20480000</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">20480001</span><span class="number">-20487680</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">23887872</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">23887873</span><span class="number">-23895552</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">71663616</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">71663617</span><span class="number">-71671296</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">78675968</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">78675969</span><span class="number">-78683648</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">102400000</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">102400001</span><span class="number">-102407680</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">214990848</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">214990849</span><span class="number">-214998528</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">512000000</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">512000001</span><span class="number">-512007680</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">550731776</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">550731777</span><span class="number">-550739456</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">644972544</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">644972545</span><span class="number">-644980224</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">1934917632</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">1934917633</span><span class="number">-1934925312</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">2560000000</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">2560000001</span><span class="number">-2560007680</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">3855122432</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">3855122433</span><span class="number">-3855130112</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">5804752896</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">5804752897</span><span class="number">-5804760576</span></span><br><span class="line">  <span class="string">Backup</span> <span class="string">superblock</span> <span class="string">at</span> <span class="number">12800000000</span><span class="string">,</span> <span class="string">Group</span> <span class="string">descriptors</span> <span class="string">at</span> <span class="number">12800000001</span><span class="number">-12800007680</span></span><br></pre></td></tr></table></figure>
<p>Why some parition all superblock were missing ?</p>
<h3 id="For-huge-parttion-there-is-no-enough-memory-it-will-cause-slow"><a href="#For-huge-parttion-there-is-no-enough-memory-it-will-cause-slow" class="headerlink" title="For huge parttion, there is no enough memory, it will cause slow"></a>For huge parttion, there is no enough memory, it will cause slow</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">/etc/</span>e2fsck.conf</span><br><span class="line">[scratch_files]</span><br><span class="line">directory = <span class="regexp">/var/</span>cache/e2fsck</span><br></pre></td></tr></table></figure>

<h3 id="guess-partion-start"><a href="#guess-partion-start" class="headerlink" title="guess partion start"></a><a target="_blank" rel="noopener" href="https://unix.stackexchange.com/questions/103919/how-do-i-find-the-offset-of-an-ext4-filesystem">guess partion start</a></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">bsz=512 <span class="comment"># or 1024, 2048, 4096 higher = faster</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;2..10000000&#125;; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;---&gt;<span class="variable">$i</span>&lt;---&quot;</span></span><br><span class="line">    mount -o offset=$((<span class="variable">$bsz</span>*<span class="variable">$i</span>)) -t ext4 /dev/whatever /mnt/foo</span><br><span class="line">    <span class="keyword">if</span> [ $? == 0 ]; <span class="keyword">then</span> <span class="comment"># whahoo!</span></span><br><span class="line">        <span class="built_in">echo</span> Eureka</span><br><span class="line">        <span class="built_in">break</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<h3 id="Found-ext-magic-number"><a href="#Found-ext-magic-number" class="headerlink" title="Found ext magic number"></a>Found ext magic number</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">0000400: 0000 c003 0000 00c0 0000 0030 60c4 98a4  ...........0`...</span><br><span class="line">0000410: e243 9703 0000 0000 0200 0000 0200 0000  .C..............</span><br><span class="line">0000420: 0080 0000 0080 0000 8000 0000 9aba e45b  ...............[</span><br><span class="line">0000430: 9aba e45b 0c00 ffff 53ef 0100 0100 0000  ...[....S.......</span><br><span class="line">0000440: 8760 dc59 0000 0000 0000 0000 0100 0000  .`.Y............</span><br><span class="line">0000450: 0000 0000 0b00 0000 0001 0000 2c00 0000  ............,...</span><br><span class="line">0000460: c603 0000 3b01 0000 1c09 a61a 05f9 42cb  ....;.........B.</span><br><span class="line">0000470: a3a9 e929 ee10 20be 6c64 6673 7164 312d  ...).. .ldfsqd1-</span><br><span class="line">0000480: 4f53 5430 3030 3000 2f00 6d70 2f6d 6e74  OST0000./.mp/mnt</span><br><span class="line">0000490: 584e 4435 3733 0000 0000 0000 0000 0000  XND573..........</span><br><span class="line">00004a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................</span><br><span class="line">00004b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................</span><br><span class="line">00004c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................</span><br></pre></td></tr></table></figure>

<h3 id="because-there-is-no-any-parttion-in-this-block-dev"><a href="#because-there-is-no-any-parttion-in-this-block-dev" class="headerlink" title="because there is no any parttion in this block dev"></a>because there is no any parttion in this block dev</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ parted /dev/mapper/3600a098000b5ea3e000006065be52460 p</span><br><span class="line">Model: Linux device-mapper (multipath) (dm)</span><br><span class="line">Disk /dev/mapper/3600a098000b5ea3e000006065be52460: 66.0TB</span><br><span class="line">Sector size (logical/physical): 512B/4096B</span><br><span class="line">Partition Table: loop <span class="comment">#######that means there is no parttion </span></span><br><span class="line">Disk Flags:</span><br><span class="line"></span><br><span class="line">Number  Start  End     Size    File system  Flags</span><br><span class="line"> 1      0.00B  66.0TB  66.0TB  ext4</span><br></pre></td></tr></table></figure>

<h3 id="You-can’t-fsck-by-default"><a href="#You-can’t-fsck-by-default" class="headerlink" title="You can’t fsck by default"></a>You can’t fsck by default</h3><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$ e2fsck -n -b <span class="number">32768</span> /dev/mapper/<span class="number">3600</span>a098000b5ea3e000006065be52460</span><br><span class="line">e2fsck <span class="number">1.42</span><span class="number">.13</span>.wc5 (<span class="number">15</span>-Apr<span class="number">-2016</span>)</span><br><span class="line">MMP <span class="built_in">int</span>erval <span class="keyword">is</span> <span class="number">10</span> seconds <span class="keyword">and</span> total wait time <span class="keyword">is</span> <span class="number">42</span> seconds. Please wait...</span><br><span class="line">Superblock has an invalid journal (inode <span class="number">8</span>).</span><br><span class="line">Clear? no</span><br><span class="line"></span><br><span class="line">e2fsck: Illegal inode number <span class="keyword">while</span> checking ext3 journal <span class="keyword">for</span> ldfsqd1-OST0004</span><br><span class="line"></span><br><span class="line">ldfsqd1-OST0004: ********** WARNING: Filesystem still has errors **********</span><br><span class="line"></span><br><span class="line">$ e2fsck -n -b <span class="number">819200</span> /dev/mapper/<span class="number">3600</span>a098000b5ea3e000006065be52460</span><br><span class="line">e2fsck <span class="number">1.42</span><span class="number">.13</span>.wc5 (<span class="number">15</span>-Apr<span class="number">-2016</span>)</span><br><span class="line">MMP <span class="built_in">int</span>erval <span class="keyword">is</span> <span class="number">10</span> seconds <span class="keyword">and</span> total wait time <span class="keyword">is</span> <span class="number">42</span> seconds. Please wait...</span><br><span class="line">Superblock has an invalid journal (inode <span class="number">8</span>).</span><br><span class="line">Clear? no</span><br><span class="line"></span><br><span class="line">e2fsck: Illegal inode number <span class="keyword">while</span> checking ext3 journal <span class="keyword">for</span> ldfsqd1-OST0004</span><br><span class="line"></span><br><span class="line">ldfsqd1-OST0004: ********** WARNING: Filesystem still has errors **********</span><br></pre></td></tr></table></figure>

<h3 id="Found-some-info-form-superblock"><a href="#Found-some-info-form-superblock" class="headerlink" title="Found some info form superblock"></a>Found some info form superblock</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">-n     Causes mke2fs to not actually create a filesystem, but display what it would <span class="keyword">do</span> <span class="keyword">if</span> it were to create  a  filesystem.   </span><br><span class="line">       This can  be used to determine the location of the backup superblocks <span class="keyword">for</span> a particular filesystem, </span><br><span class="line">       so long as the mke2fs parame‐ters that were passed when the filesystem was originally created are used again.  </span><br><span class="line">       (With the -n option added, of course!)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Maybe you could rewrite the superblock</span></span><br><span class="line">mke2fs -S</span><br><span class="line">    -S    Write  superblock and group descriptors only.  This is useful <span class="keyword">if</span> all</span><br><span class="line">          of the superblock and backup superblocks are corrupted, and a  last-</span><br><span class="line">          ditch  recovery method is desired.  It causes mke2fs to reinitialize</span><br><span class="line">          the superblock and group descriptors, <span class="keyword">while</span> not touching  the  inode</span><br><span class="line">          table and the block and inode bitmaps.  The e2fsck program should be</span><br><span class="line">          run immediately after this option is used, and there is no guarantee</span><br><span class="line">          that  any  data  will be salvageable.  It is critical to specify the</span><br><span class="line">          correct filesystem blocksize when using this option, or there is  no</span><br><span class="line">          chance of recovery.</span><br></pre></td></tr></table></figure>

<h3 id="You-have-to-disable-ext-journal-make-it-like-ext2-all-blocks-full-scan"><a href="#You-have-to-disable-ext-journal-make-it-like-ext2-all-blocks-full-scan" class="headerlink" title="You have to disable ext journal, make it like ext2, all blocks full scan"></a>You have to disable ext journal, make it like ext2, all blocks full scan</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ tune2fs -O ^has_journal,needs_rwcovery -f /dev/mapper/3600a098000b5ea3e000006065be52460</span><br><span class="line"><span class="comment">### you can fsck again, but it &#x27;s too slow..............maybe 60TB will wait 10 years</span></span><br><span class="line"></span><br><span class="line">$ e2fsck -y /dev/mapper/3600a098000b5ea3e000006065be52460</span><br><span class="line"><span class="comment">### it &#x27;s worked</span></span><br></pre></td></tr></table></figure>

<h3 id="Looks-like-the-block-dev-has-be-destroy-by-hardware-raid-controller-all-data-has-messed"><a href="#Looks-like-the-block-dev-has-be-destroy-by-hardware-raid-controller-all-data-has-messed" class="headerlink" title="Looks like the block dev has be destroy by hardware raid controller, all data has messed"></a>Looks like the block dev has be destroy by hardware raid controller, all data has messed</h3><p>In 60TiB raw dev, Lustre first 10MB is ext meta data and data map, it will not show any file part<br>But I found the horrible things, reserve space has been overrided as 128KiB, 128KiB is the raid controller segment size.<br>I don ‘t think we can recovery all data. when fsck finish, I ‘m not sure the data is it integrity. maybe some block has corruptted in single file</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">00fffa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................</span><br><span class="line">00fffb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................</span><br><span class="line">00fffc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................</span><br><span class="line">00fffd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................</span><br><span class="line">00fffe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................</span><br><span class="line">00ffff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................</span><br><span class="line">0100000: dcfa 60ef 039f c372 0793 3a8d 4c6a 642d  ..`....r..:.Ljd-</span><br><span class="line">0100010: 50c7 fddf b3f5 fbed f03f 71b5 ccb3 811c  P........?q.....</span><br><span class="line">0100020: 1495 a0c2 ab24 be48 ac46 1109 a19e aadc  .....$.H.F......</span><br><span class="line">0100030: 16d9 0488 2e26 d238 fe48 e492 27c5 dd02  .....&amp;.8.H..<span class="string">&#x27;...</span></span><br><span class="line"><span class="string">.....</span></span><br><span class="line"><span class="string">011ffd0: baf1 35e8 54e1 e97c dab5 e762 e74c 83cc  ..5.T..|...b.L..</span></span><br><span class="line"><span class="string">011ffe0: 7d02 7db3 53f2 613d 6ef4 775b a0e2 767f  &#125;.&#125;.S.a=n.w[..v.</span></span><br><span class="line"><span class="string">011fff0: ff8b 65fe 9c39 1018 3b76 586e 3893 2095  ..e..9..;vXn8. .</span></span><br><span class="line"><span class="string">0120000: c000 8023 c001 8023 0008 8023 0000 0100  ...#...#...#....</span></span><br><span class="line"><span class="string">0120010: 0000 0400 0000 0000 0000 0000 0000 3896  ..............8.</span></span><br><span class="line"><span class="string">0120020: 0000 0000 0000 0000 0000 0000 0000 0000  ................</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">##### After 128KiB</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">##### Another parttion</span></span><br><span class="line"><span class="string">01bffe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................</span></span><br><span class="line"><span class="string">01bfff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................</span></span><br><span class="line"><span class="string">01c0000: 9fac ef20 dd9d fd1c 18ed a503 a19e 5f7a  ... .........._z</span></span><br><span class="line"><span class="string">01c0010: ea7d b6c7 850d 7a52 a0a9 61a6 a912 f489  .&#125;....zR..a.....</span></span><br><span class="line"><span class="string">01c0020: da1f 4941 4fe4 f612 1b25 ff91 9b61 928a  ..IAO....%...a..</span></span><br><span class="line"><span class="string">01c0030: 405d 5026 e2a7 a59e d08a d376 8c57 0d1f  @]P&amp;.......v.W..</span></span><br><span class="line"><span class="string">....</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">01fff90: 5080 aaaa 0ef0 3c5c 0020 0d5c 6408 2400  P.....&lt;\. .\d.$.</span></span><br><span class="line"><span class="string">01fffa0: ef15 08e8 7d00 2399 d60f 1b1e 0000 0000  ....&#125;.#.........</span></span><br><span class="line"><span class="string">01fffb0: 966c 6516 0000 0000 ff37 fb12 0000 0000  .le......7......</span></span><br><span class="line"><span class="string">01fffc0: 954a c013 0000 0000 ea47 c570 2708 0000  .J.......G.p&#x27;</span>...</span><br><span class="line">01fffd0: 45a6 5fd7 6c03 8ca1 be55 4c44 2a6a 1500  E._.l....ULD*j..</span><br><span class="line">01fffe0: aa06 3ba9 aaba e2a6 fc0f 1b1e 0000 0000  ..;.............</span><br><span class="line">01ffff0: b46c 6516 0000 0000 2838 fb12 0000 0000  .le.....(8......</span><br><span class="line">0200000: 6c65 0975 6e6b 6e6f 776e 0930 0930 0969  le.unknown.0.0.i</span><br><span class="line">0200010: 6e74 726f 6e09 6578 6163 7409 3109 0931  ntron.exact.1..1</span><br><span class="line">0200020: 3709 3130 3030 4745 4e4f 4d45 532c 4142  7.1000GENOMES,AB</span><br><span class="line">0200030: 492c 4146 4659 2c42 4749 2c43 4f4d 504c  I,AFFY,BGI,COMPL</span><br><span class="line">0200040: 4554 455f 4745 4e4f 4d49 4353 2c43 5348  ETE_GENOMICS,CSH</span><br><span class="line">0200050: 4c2d 4841 504d 4150 2c45 4e53 454d 424c  L-HAPMAP,ENSEMBL</span><br><span class="line">0200060: 2c45 5641 2d47 4f4e 4c2c 474d 492c 4855  ,EVA-GONL,GMI,HU</span><br><span class="line">0200070: 4d41 4e47 454e 4f4d 455f 4a43 5649 2c4a  MANGENOME_JCVI,J</span><br><span class="line">......</span><br><span class="line"></span><br><span class="line">021ffb0: 454e 4f4d 4553 2c09 3209 2d2c 4154 4141  ENOMES,.2.-,ATAA</span><br><span class="line">021ffc0: 542c 0933 2e30 3030 3030 302c 3530 3035  T,.3.000000,5005</span><br><span class="line">021ffd0: 2e30 3030 3030 302c 0930 2e30 3030 3539  .000000,.0.00059</span><br><span class="line">021ffe0: 392c 302e 3939 3934 3031 2c09 0a37 3032  9,0.999401,..702</span><br><span class="line">021fff0: 0963 6872 3130 0931 3533 3338 3336 3909  .chr10.15338369.</span><br><span class="line">0220000: c000 8043 c001 8043 0008 8043 0000 8000  ...C...C...C....</span><br><span class="line">0220010: 0000 0500 0000 0000 0000 0000 8000 e4f0  ................</span><br><span class="line">0220020: 0000 0000 0000 0000 0000 0000 0000 0000  ................</span><br><span class="line">0220030: 0000 0000 0000 0000 0000 0000 0000 0000  ................</span><br><span class="line">0220040: c100 8043 c101 8043 0808 8043 0000 8000  ...C...C...C....</span><br><span class="line">0220050: 0000 0500 0000 0000 0000 0000 8000 9be0  ................</span><br><span class="line">0220060: 0000 0000 0000 0000 0000 0000 0000 0000  ................</span><br><span class="line">0220070: 0000 0000 0000 0000 0000 0000 0000 0000  ................</span><br><span class="line">0220080: c200 8043 c201 8043 1008 8043 0000 8000  ...C...C...C....</span><br><span class="line">0220090: 0000 0500 0000 0000 0000 0000 8000 1ad0  ................</span><br><span class="line">02200a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................</span><br><span class="line">02200b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................</span><br><span class="line">02200c0: c300 8043 c301 8043 1808 8043 0000 8000  ...C...C...C....</span><br><span class="line"></span><br><span class="line"><span class="comment">## Why there is file part as 128KiB size override file system reserve space ????</span></span><br><span class="line"><span class="comment">## Here is file system log , looks like no problem</span></span><br></pre></td></tr></table></figure>

<h3 id="debugfs"><a href="#debugfs" class="headerlink" title="debugfs"></a>debugfs</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line">$ dd <span class="keyword">if</span>=/dev/zero of=/dev/shm/<span class="built_in">test</span> bs=1M count=512</span><br><span class="line">$ mfks.ext3 -b 4096 /dev/shm/<span class="built_in">test</span></span><br><span class="line">$ mount /dev/shm/<span class="built_in">test</span> /mnt</span><br><span class="line"></span><br><span class="line">$ rm -f <span class="built_in">test</span>;<span class="keyword">for</span> i <span class="keyword">in</span> &#123;0..10000&#125;; <span class="keyword">do</span> <span class="built_in">echo</span> <span class="variable">$i</span>-<span class="variable">$i</span>-<span class="variable">$i</span> &gt;&gt; <span class="built_in">test</span>; <span class="keyword">done</span> </span><br><span class="line">$ filefrag -v <span class="built_in">test</span> </span><br><span class="line">Filesystem <span class="built_in">type</span> is: ef53</span><br><span class="line">Filesystem cylinder groups approximately 4</span><br><span class="line">File size of <span class="built_in">test</span> is 146688 (36 blocks of 4096 bytes)</span><br><span class="line"> ext:     logical_offset:        physical_offset: length:   expected: flags:</span><br><span class="line">   0:        0..      15:       2576..      2591:     16:             merged</span><br><span class="line">   1:       16..      16:      33424..     33424:      1:       2592: merged</span><br><span class="line">   2:       17..      17:      33457..     33457:      1:      33425: merged</span><br><span class="line">   3:       18..      18:      33490..     33490:      1:      33458: merged</span><br><span class="line">   4:       19..      19:      33523..     33523:      1:      33491: merged</span><br><span class="line">   5:       20..      20:      33556..     33556:      1:      33524: merged</span><br><span class="line">   6:       21..      21:      33589..     33589:      1:      33557: merged</span><br><span class="line">   7:       22..      22:      33622..     33622:      1:      33590: merged</span><br><span class="line">   8:       23..      23:      33655..     33655:      1:      33623: merged</span><br><span class="line">   9:       24..      24:      33688..     33688:      1:      33656: merged</span><br><span class="line">  10:       25..      25:      33721..     33721:      1:      33689: merged</span><br><span class="line">  11:       26..      26:      33754..     33754:      1:      33722: merged</span><br><span class="line">  12:       27..      27:      33787..     33787:      1:      33755: merged</span><br><span class="line">  13:       28..      28:      33820..     33820:      1:      33788: merged</span><br><span class="line">  14:       29..      29:      33853..     33853:      1:      33821: merged</span><br><span class="line">  15:       30..      30:      33886..     33886:      1:      33854: merged</span><br><span class="line">  16:       31..      31:      33919..     33919:      1:      33887: merged</span><br><span class="line">  17:       32..      32:      33952..     33952:      1:      33920: merged</span><br><span class="line">  18:       33..      33:      34017..     34017:      1:      33953: merged</span><br><span class="line">  19:       34..      34:      34082..     34082:      1:      34018: merged</span><br><span class="line">  20:       35..      35:      34147..     34147:      1:      34083: last,merged,eof</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">$ debugfs /dev/shm/<span class="built_in">test</span> </span><br><span class="line">debugfs 1.42.13 (17-May-2015)</span><br><span class="line">debugfs: <span class="built_in">stat</span> &lt;14&gt; </span><br><span class="line"></span><br><span class="line">Inode: 14   Type: regular    Mode:  0644   Flags: 0x0</span><br><span class="line">Generation: 3749441442    Version: 0x00000000:00000001</span><br><span class="line">User:     0   Group:     0   Size: 146688</span><br><span class="line">File ACL: 0    Directory ACL: 0</span><br><span class="line">Links: 1   Blockcount: 296</span><br><span class="line">Fragment:  Address: 0    Number: 0    Size: 0</span><br><span class="line"> ctime: 0x58763a68:1f1d1ee4 -- Wed Jan 11 22:00:08 2017</span><br><span class="line"> atime: 0x58763a67:e66e9d44 -- Wed Jan 11 22:00:07 2017</span><br><span class="line"> mtime: 0x58763a68:1f1d1ee4 -- Wed Jan 11 22:00:08 2017</span><br><span class="line">crtime: 0x58763a67:e66e9d44 -- Wed Jan 11 22:00:07 2017</span><br><span class="line">Size of extra inode fields: 32</span><br><span class="line">BLOCKS:</span><br><span class="line">(0-11):2576-2587, (IND):1538, (12-15):2588-2591, (16):33424, (17):33457, (18):33490, (19):33523, (20):33556, (21):33589, (22):33622, (23):33655, (24):33688, (25):33721, (26):33754, (27):33787, (28):33820, (29):33853, (30):33886, (31):33919, (32):33952, (33):34017, (34):34082, (35):34147</span><br><span class="line">TOTAL: 37</span><br><span class="line"></span><br><span class="line">$ dd <span class="keyword">if</span>=/dev/shm/<span class="built_in">test</span> of=test-1 bs=4K skip=2576 count=$((<span class="number">2591</span>-<span class="number">2576</span>+<span class="number">1</span>))</span><br><span class="line">$ head test-1 ; wc -l test-1 ;tail test-1</span><br><span class="line">0-0-0</span><br><span class="line">1-1-1</span><br><span class="line">2-2-2</span><br><span class="line">3-3-3</span><br><span class="line">4-4-4</span><br><span class="line">5-5-5</span><br><span class="line">6-6-6</span><br><span class="line">7-7-7</span><br><span class="line">8-8-8</span><br><span class="line">9-9-9</span><br><span class="line">4591 test-1</span><br><span class="line">4582-4582-4582</span><br><span class="line">4583-4583-4583</span><br><span class="line">4584-4584-4584</span><br><span class="line">4585-4585-4585</span><br><span class="line">4586-4586-4586</span><br><span class="line">4587-4587-4587</span><br><span class="line">4588-4588-4588</span><br><span class="line">4589-4589-4589</span><br><span class="line">4590-4590-4590</span><br><span class="line">4</span><br><span class="line"></span><br><span class="line">$ dd <span class="keyword">if</span>=/dev/shm/<span class="built_in">test</span> of=test-2 bs=4K skip=33424 count=1</span><br><span class="line">1+0 records <span class="keyword">in</span></span><br><span class="line">1+0 records out</span><br><span class="line">4096 bytes (4.1 kB, 4.0 KiB) copied, 0.000193943 s, 21.1 MB/s</span><br><span class="line">$ head test-2 ; wc -l test-2 ;tail test-2</span><br><span class="line">591-4591-4591</span><br><span class="line">4592-4592-4592</span><br><span class="line">4593-4593-4593</span><br><span class="line">4594-4594-4594</span><br><span class="line">4595-4595-4595</span><br><span class="line">4596-4596-4596</span><br><span class="line">4597-4597-4597</span><br><span class="line">4598-4598-4598</span><br><span class="line">4599-4599-4599</span><br><span class="line">4600-4600-4600</span><br><span class="line">273 test-2</span><br><span class="line">4855-4855-4855</span><br><span class="line">4856-4856-4856</span><br><span class="line">4857-4857-4857</span><br><span class="line">4858-4858-4858</span><br><span class="line">4859-4859-4859</span><br><span class="line">4860-4860-4860</span><br><span class="line">4861-4861-4861</span><br><span class="line">4862-4862-4862</span><br><span class="line">4863-4863-4863</span><br><span class="line">48</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$ dd <span class="keyword">if</span>=/dev/shm/<span class="built_in">test</span> of=test-3 bs=4K skip=33457 count=1</span><br><span class="line">1+0 records <span class="keyword">in</span></span><br><span class="line">1+0 records out</span><br><span class="line">4096 bytes (4.1 kB, 4.0 KiB) copied, 0.000193132 s, 21.2 MB/s</span><br><span class="line">$ head test-3 ; wc -l test-3 ;tail test-3</span><br><span class="line">64-4864-4864</span><br><span class="line">4865-4865-4865</span><br><span class="line">4866-4866-4866</span><br><span class="line">4867-4867-4867</span><br><span class="line">4868-4868-4868</span><br><span class="line">4869-4869-4869</span><br><span class="line">4870-4870-4870</span><br><span class="line">4871-4871-4871</span><br><span class="line">4872-4872-4872</span><br><span class="line">4873-4873-4873</span><br><span class="line">273 test-3</span><br><span class="line">5128-5128-5128</span><br><span class="line">5129-5129-5129</span><br><span class="line">5130-5130-5130</span><br><span class="line">5131-5131-5131</span><br><span class="line">5132-5132-5132</span><br><span class="line">5133-5133-5133</span><br><span class="line">5134-5134-5134</span><br><span class="line">5135-5135-5135</span><br><span class="line">5136-5136-5136</span><br><span class="line">513</span><br></pre></td></tr></table></figure>

<h3 id="check-ext4-fragment"><a href="#check-ext4-fragment" class="headerlink" title="check ext4 fragment"></a>check ext4 fragment</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ e4defrag -c /mnt</span><br><span class="line">&lt;Fragmented files&gt;                             now/best       size/ext</span><br><span class="line">1. /mnt/rw.24.9                                313/1            104 KB</span><br><span class="line">2. /mnt/rw.4.89                                265/1            123 KB</span><br><span class="line">3. /mnt/rw.29.99                               319/1            102 KB</span><br><span class="line">4. /mnt/rw.23.7                                291/1            112 KB</span><br><span class="line">5. /mnt/rw.31.71                               366/1             89 KB</span><br><span class="line"></span><br><span class="line"> Total/best extents				1184802/4096</span><br><span class="line"> Average size per extent			113 KB</span><br><span class="line"> Fragmentation score				28</span><br><span class="line"> [0-30 no problem: 31-55 a little bit fragmented: 56- needs defrag]</span><br><span class="line"> This directory (/mnt) does not need defragmentation.</span><br><span class="line"> Done.</span><br><span class="line"></span><br><span class="line">$ e4defrag /dev/sda &amp;</span><br></pre></td></tr></table></figure>

<h3 id="mount-the-backup-superblock"><a href="#mount-the-backup-superblock" class="headerlink" title="mount the backup superblock"></a>mount the backup superblock</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$  dumpe2fs /dev/sda2 | grep superblock</span><br><span class="line">$  fsck -b 32768 /dev/sda2</span><br><span class="line">or you could </span><br><span class="line">$  mount sb=32768 /dev/sda2 /mnt </span><br></pre></td></tr></table></figure>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Ginger</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://yoursite.com/2018/11/13/ext4/">http://yoursite.com/2018/11/13/ext4/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ext4/">ext4</a></div><div class="post_share"><div class="social-share" data-image="https://homerl.github.io/img/hard-disk_223cf.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2018/11/13/nfs/"><img class="prev-cover" src="https://homerl.github.io/img/hard-disk_223cf.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">nfs info</div></div></a></div><div class="next-post pull-right"><a href="/2018/09/27/hba/"><img class="next-cover" src="https://homerl.github.io/img/hard-disk_223cf.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">SAS HBA</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></article></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2015 - 2020 By Ginger</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><div class="js-pjax"><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk({
      clientID: '0b9d5b98d0a972b33cf7',
      clientSecret: '769efc11b32f6c0d03bcbf3ee800dfc4e2690459',
      repo: 'homerl.github.io',
      owner: 'homerl',
      admin: ['homerl'],
      id: '85eccd8e3675281313712fb06d0be2b0',
      language: 'en',
      perPage: 10,
      distractionFreeMode: false,
      pagerDirection: 'last',
      createIssueManually: false,
      updateCountCallback: commentCount
    })
    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    $.getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js', initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></div></body></html>