<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>scsi device maintain | 己不由心，身又岂能由己</title><meta name="keywords" content="scsi"><meta name="author" content="Ginger"><meta name="copyright" content="Ginger"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="How many devices can you connect?Individual SAS RAID adapters can typically support up to 128 end devices with the use of SAS expanders, and can communicate with both SAS and SATA devices. Note: Altho">
<meta property="og:type" content="article">
<meta property="og:title" content="scsi device maintain">
<meta property="og:url" content="http://yoursite.com/2018/07/08/scsi_dev/index.html">
<meta property="og:site_name" content="己不由心，身又岂能由己">
<meta property="og:description" content="How many devices can you connect?Individual SAS RAID adapters can typically support up to 128 end devices with the use of SAS expanders, and can communicate with both SAS and SATA devices. Note: Altho">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://yoursite.com/img/photo_by_spacex.jpg">
<meta property="article:published_time" content="2018-07-08T08:56:34.000Z">
<meta property="article:modified_time" content="2020-10-09T12:22:24.909Z">
<meta property="article:author" content="Ginger">
<meta property="article:tag" content="scsi">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/img/photo_by_spacex.jpg"><link rel="shortcut icon" href="/img/stout-shield.png"><link rel="canonical" href="http://yoursite.com/2018/07/08/scsi_dev/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><script>var GLOBAL_CONFIG = { 
  root: '/',
  hexoversion: '5.2.0',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2020-10-09 20:22:24'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {
  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }

  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }
})()</script><meta name="generator" content="Hexo 5.2.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/244247-guts.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">Articles</div><div class="length_num">58</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">Tags</div><div class="length_num">57</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">Categories</div><div class="length_num">9</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li><li><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#How-many-devices-can-you-connect"><span class="toc-number">1.</span> <span class="toc-text">How many devices can you connect?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Enable-scsi-device-led-from-JBOD"><span class="toc-number">2.</span> <span class="toc-text">Enable scsi device led from JBOD</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Dell"><span class="toc-number">2.1.</span> <span class="toc-text">Dell</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SCSI-command"><span class="toc-number">2.2.</span> <span class="toc-text">SCSI command</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Monitor"><span class="toc-number">2.3.</span> <span class="toc-text">Monitor</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Avoid-multiple-JBOD-devs-across-in-single-raidz"><span class="toc-number">2.4.</span> <span class="toc-text">Avoid multiple JBOD devs across in single raidz</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#map-element-index-and-sas-addr"><span class="toc-number">2.5.</span> <span class="toc-text">map element index and sas addr</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SATA"><span class="toc-number">3.</span> <span class="toc-text">SATA</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Enable-SATA-TLER-ERC-CCTL"><span class="toc-number">3.1.</span> <span class="toc-text">Enable SATA TLER&#x2F;ERC&#x2F;CCTL</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Get-hide-area-from-SATA-SSD"><span class="toc-number">4.</span> <span class="toc-text">Get hide area from SATA SSD</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Enable-SAS-SATA-dev-cache"><span class="toc-number">5.</span> <span class="toc-text">Enable SAS&#x2F;SATA dev cache</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#SAS-cache"><span class="toc-number">5.1.</span> <span class="toc-text">SAS cache</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SATA-cache"><span class="toc-number">5.2.</span> <span class="toc-text">SATA cache</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sector-size"><span class="toc-number">6.</span> <span class="toc-text">sector size</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#512e-SATA"><span class="toc-number">6.1.</span> <span class="toc-text">512e SATA</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4KN"><span class="toc-number">6.2.</span> <span class="toc-text">4KN</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Nominal-media-rotation-rate"><span class="toc-number">6.3.</span> <span class="toc-text">Nominal media rotation rate</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Does-devices-support-the-scsi-Persistent-Reservation"><span class="toc-number">7.</span> <span class="toc-text">Does devices support the scsi-Persistent-Reservation</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Add-it-to-multipath-test-in-HUS-150-worked"><span class="toc-number">7.1.</span> <span class="toc-text">Add it to multipath, test in HUS 150, worked</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Because-brain-split-zfs-will-corrupt"><span class="toc-number">8.</span> <span class="toc-text">Because brain-split, zfs will corrupt</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Register"><span class="toc-number">8.1.</span> <span class="toc-text">Register</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Reserve"><span class="toc-number">8.2.</span> <span class="toc-text">Reserve</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Server-B-preempt-the-reservation"><span class="toc-number">8.3.</span> <span class="toc-text">Server B preempt the reservation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#After-preempt-abort-Server-A-preempt-the-reservation"><span class="toc-number">8.4.</span> <span class="toc-text">After preempt-abort, Server A preempt the reservation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Prout-type"><span class="toc-number">8.5.</span> <span class="toc-text">Prout-type</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Release-reservation"><span class="toc-number">8.6.</span> <span class="toc-text">Release reservation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Unregister-key"><span class="toc-number">8.7.</span> <span class="toc-text">Unregister key</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Force-mode"><span class="toc-number">8.8.</span> <span class="toc-text">Force mode ?</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#After-A-and-B-reboot-the-reservation-worked"><span class="toc-number">8.9.</span> <span class="toc-text">After A and B reboot, the reservation worked</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Plugin-it-to-another-JBOD-all-key-reservation-will-missing"><span class="toc-number">8.10.</span> <span class="toc-text">Plugin it to another JBOD, all key, reservation will missing</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NVME-persist-reservation"><span class="toc-number">9.</span> <span class="toc-text">NVME persist reservation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#the-others-sg-tools"><span class="toc-number">10.</span> <span class="toc-text">the others sg tools</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#sg-readcap"><span class="toc-number">10.1.</span> <span class="toc-text">sg_readcap</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sginfo"><span class="toc-number">10.2.</span> <span class="toc-text">sginfo</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sg-senddiag"><span class="toc-number">10.3.</span> <span class="toc-text">sg_senddiag</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sg-inq"><span class="toc-number">10.4.</span> <span class="toc-text">sg_inq</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sg-opcodes"><span class="toc-number">10.5.</span> <span class="toc-text">sg_opcodes</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sg-write-same"><span class="toc-number">10.6.</span> <span class="toc-text">sg_write_same</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#sg-readcap-1"><span class="toc-number">10.7.</span> <span class="toc-text">sg_readcap</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#reset-bus-host-target"><span class="toc-number">10.8.</span> <span class="toc-text">reset bus, host, target</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mpt2sas-driver-layer"><span class="toc-number">11.</span> <span class="toc-text">mpt2sas driver layer</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#mpt2sas-debug-code"><span class="toc-number">11.1.</span> <span class="toc-text">mpt2sas debug code</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#mpt2sas-fwfault-debug"><span class="toc-number">11.1.1.</span> <span class="toc-text">mpt2sas_fwfault_debug</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-to-calculate-scsi-logging-level"><span class="toc-number">12.</span> <span class="toc-text">How to calculate scsi logging_level</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#smp-utils"><span class="toc-number">13.</span> <span class="toc-text">smp_utils</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#T10-PI-practice"><span class="toc-number">14.</span> <span class="toc-text">T10 PI practice</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#About-dell-PERC-9"><span class="toc-number">14.0.1.</span> <span class="toc-text">About dell PERC 9</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#nvme-pi"><span class="toc-number">14.1.</span> <span class="toc-text">nvme pi</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SAS-smart"><span class="toc-number">15.</span> <span class="toc-text">SAS smart</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sdparm"><span class="toc-number">16.</span> <span class="toc-text">sdparm</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#command"><span class="toc-number">16.1.</span> <span class="toc-text">command</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#enumerate"><span class="toc-number">16.2.</span> <span class="toc-text">enumerate</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sdparm-with-hdparm"><span class="toc-number">17.</span> <span class="toc-text">sdparm with hdparm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SAS-2-Support-multiple-STP-affiliations"><span class="toc-number">18.</span> <span class="toc-text">SAS-2 Support multiple STP affiliations</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#disable-background-scans"><span class="toc-number">19.</span> <span class="toc-text">disable background scans</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Power-status"><span class="toc-number">20.</span> <span class="toc-text">Power status</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Disable-SATA-power-save"><span class="toc-number">20.1.</span> <span class="toc-text">Disable SATA power save</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#upgrade-LSI-firmware"><span class="toc-number">21.</span> <span class="toc-text">upgrade LSI firmware</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Some-of-HDD-utils-100-in-the-zpool"><span class="toc-number">22.</span> <span class="toc-text">Some of HDD utils 100% in the zpool</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SAS-Link-layer-2-has-the-flow-control"><span class="toc-number">23.</span> <span class="toc-text">SAS Link layer 2 has the flow control</span></a></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(/img/photo_by_spacex.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">己不由心，身又岂能由己</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li><li><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">scsi device maintain</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2018-07-08T08:56:34.000Z" title="Created 2018-07-08 16:56:34">2018-07-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2020-10-09T12:22:24.909Z" title="Updated 2020-10-09 20:22:24">2020-10-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Storage/">Storage</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h3 id="How-many-devices-can-you-connect"><a href="#How-many-devices-can-you-connect" class="headerlink" title="How many devices can you connect?"></a><a target="_blank" rel="noopener" href="https://www.microsemi.com/document-portal/doc_download/136098-university-training-what-is-sas">How many devices can you connect?</a></h3><p>Individual SAS RAID adapters can typically support up to 128 end devices with the use of SAS expanders, and can communicate with both SAS and SATA devices.</p>
<p>Note: Although you can use both SAS and SATA disk drives in the same SAS domain (see page 93), we recommend that you not combine SAS and SATA disk drives within the same array or logical<br>drive. The difference in performance between the two types of disk drives may adversely affect the performance of the array.</p>
<p>However, as you read in the previous section, with the use of fanout and edge expanders, a single SAS domain can comprise up to 16,384 SAS ports.</p>
<a id="more"></a>

<h3 id="Enable-scsi-device-led-from-JBOD"><a href="#Enable-scsi-device-led-from-JBOD" class="headerlink" title="Enable scsi device led from JBOD"></a>Enable scsi device led from JBOD</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">### Active sas/sata dev led</span><br><span class="hljs-comment">#### LSI</span><br>```bash<br>sas3ircu 0 display<br><br>Device is a Hard disk<br>  Enclosure <span class="hljs-comment">#                             : 3</span><br>  Slot <span class="hljs-comment">#                                  : 14</span><br>  SAS Address                             : 0000000-0-0000-0000<br>  State                                   : Ready (RDY)<br>  Size (<span class="hljs-keyword">in</span> MB)/(<span class="hljs-keyword">in</span> sectors)               : 3815447/976754645<br>  Manufacturer                            : HGST<br>  Model Number                            : HUS726040AL4210<br>  Firmware Revision                       : AD05<br>  Serial No                               : 00000000<br>  Unit Serial No(VPD)                     : 00000000<br>  GUID                                    : 0000000000000000<br>  Protocol                                : SAS<br>  Drive Type                              : SAS_HDD<br><br>sas3ircu 0 locate 3:14 on<br>sas3ircu 0 locate 3:14 off<br></code></pre></td></tr></table></figure>

<h4 id="Dell"><a href="#Dell" class="headerlink" title="Dell"></a>Dell</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ lsscsi -gi | grep 35000cca2735b4104<br>[17:0:132:0] disk    HGST     HUH721010AL5200  LS14  /dev/sddw  35000cca2735b4104  /dev/sg134<br><br>$ shmcli list drives | grep /dev/sg134<br>     5000cca2735b4107 /dev/sg134                   HGST                          HUH721010AL5200            2YHM5T6D     LS14      8.91TB          50050cc11ac013c6 (EN-8435A-E6EBD)  TH007FPRHGT0087762ZGA02<br><br>$ shmcli blink drive -d = 5000cca2735b4107<br>blink drive - Executing <span class="hljs-built_in">command</span>..<br><br>Blink drive successful.<br><br>blink drive - Command execution complete.<br><br>$ shmcli list drive slots -a = 0 -enc = 0 -verbose | grep 2000000D -i <br><span class="hljs-comment"># -a = 0 was SAS HBA index</span><br><span class="hljs-comment"># -enc = 0 was enclosure index</span><br><br>Enc Slot Drwr/Slot Status Vendor  ProductId       Serial   Size   Lnk   Rev Blnk? Logical Vols       SAS Connections<br>65    1 / 23         OK    HGST   HUH721010AL5200 2000000D 8.91TB 6G,6G LS14 YES,  5000cca27330a695,      n/a<br><br><span class="hljs-comment">#disable led</span><br>$ shmcli blink drive -d = 5000cca2736726c7 -off<br></code></pre></td></tr></table></figure>

<h4 id="SCSI-command"><a href="#SCSI-command" class="headerlink" title="SCSI command"></a>SCSI command</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># looks like solt number could be map</span><br><br>$ sas3ircu 0 display | grep c3b1 -A 5 -B 3<br><br>Device is a Hard disk<br>  Enclosure <span class="hljs-comment">#                             : 2</span><br>  Slot <span class="hljs-comment">#                                  : 49</span><br>  SAS Address                             : 5000cca-2-6b90-c3b1<br>  State                                   : Ready (RDY)<br>  Size (<span class="hljs-keyword">in</span> MB)/(<span class="hljs-keyword">in</span> sectors)               : 9537535/19532873727<br>  Manufacturer                            : HGST<br>  Model Number                            : HUH721010AL5200<br>  Firmware Revision                       : A384<br><br>$ sg_ses /dev/sg52 -p0x2 -j | grep c3b1  -i -A 8<br>join_work: oi=0, ei=9, eiioe=1 not <span class="hljs-keyword">in</span> join_arr<br>Drive Slot <span class="hljs-comment">#50_5000CCA26B90C3B1 [0,49]  Element type: Array device slot</span><br>  Enclosure Status:<br>    Predicted failure=0, Disabled=0, Swap=0, status: OK<br>    OK=0, Reserved device=0, Hot spare=0, Cons check=0<br>    In crit array=0, In failed array=0, Rebuild/remap=0, R/R abort=0<br>    App client bypass A=0, Do not remove=0, Enc bypass A=0, Enc bypass B=0<br>    Ready to insert=0, RMV=0, Ident=0, Report=0                           <span class="hljs-comment"># here is the device status</span><br>    App client bypass B=0, Fault sensed=0, Fault reqstd=0, Device off=0<br>    Bypassed A=0, Bypassed B=0, Dev bypassed A=0, Dev bypassed B=0<br><br>$ $ lsscsi -git<br>[0:0:0:0]    disk    sas:0x500056b3787358c0          /dev/sda   -  /dev/sg0<br>[0:0:1:0]    disk    sas:0x500056b3787358c1          /dev/sdb   -  /dev/sg1<br>[0:0:2:0]    disk    sas:0x500056b3787358c2          /dev/sdc   -  /dev/sg2<br>[0:0:3:0]    disk    sas:0x500056b3787358c3          /dev/sdd   -  /dev/sg3<br>[0:0:4:0]    disk    sas:0x500056b3787358c4          /dev/sde   -  /dev/sg4<br>[0:0:5:0]    disk    sas:0x500056b3787358c5          /dev/sdf   -  /dev/sg5<br>[0:0:6:0]    disk    sas:0x500056b3787358c6          /dev/sdg   -  /dev/sg6<br>[0:0:7:0]    disk    sas:0x500056b3787358c7          /dev/sdh   -  /dev/sg7<br>[0:0:8:0]    disk    sas:0x500056b3787358c8          /dev/sdi   -  /dev/sg8<br>[0:0:9:0]    disk    sas:0x500056b3787358c9          /dev/sdj   -  /dev/sg9<br>[0:0:10:0]   disk    sas:0x500056b3787358ca          /dev/sdk   -  /dev/sg10<br>[0:0:11:0]   disk    sas:0x500056b3787358cb          /dev/sdl   -  /dev/sg11<br>[0:0:12:0]   enclosu sas:0x500056b3787358fd          -          -  /dev/sg12<br>[15:0:0:0]   disk    sata:                           /dev/sdm   -  /dev/sg13<br>[17:0:0:0]   process sata:                           -          -  /dev/sg14<br><br>$ sg_ses -p 0xa /dev/sg12 |grep -E <span class="hljs-string">&#x27;Element|slot&#x27;</span><br>    &lt;&lt;&lt;additional: response too short&gt;&gt;&gt;<br>    Element <span class="hljs-built_in">type</span>: Array device slot, subenclosure id: 0 [ti=0]<br>      Element index: 0  eiioe=0<br>        number of phys: 2, not all phys: 0, device slot number: 0<br>      Element index: 1  eiioe=0<br>        number of phys: 2, not all phys: 0, device slot number: 1<br>      Element index: 2  eiioe=0<br>        number of phys: 2, not all phys: 0, device slot number: 2<br>      Element index: 3  eiioe=0<br>        number of phys: 2, not all phys: 0, device slot number: 3<br>      Element index: 4  eiioe=0<br>        number of phys: 2, not all phys: 0, device slot number: 4<br>      Element index: 5  eiioe=0<br>        number of phys: 2, not all phys: 0, device slot number: 5<br>      Element index: 6  eiioe=0<br>        number of phys: 2, not all phys: 0, device slot number: 6<br>      Element index: 7  eiioe=0<br>        number of phys: 2, not all phys: 0, device slot number: 7<br>      Element index: 8  eiioe=0<br>        number of phys: 2, not all phys: 0, device slot number: 8<br>      Element index: 9  eiioe=0<br>        number of phys: 2, not all phys: 0, device slot number: 9<br>      Element index: 10  eiioe=0<br>        number of phys: 2, not all phys: 0, device slot number: 10<br>      Element index: 11  eiioe=0<br>        number of phys: 2, not all phys: 0, device slot number: 11<br><br><span class="hljs-comment"># the light color depends hardware vendor</span><br><br><br>--clear, --get, --<span class="hljs-built_in">set</span> acronyms <span class="hljs-keyword">for</span> Enclosure Status/Control [<span class="hljs-string">&#x27;es&#x27;</span> or <span class="hljs-string">&#x27;ec&#x27;</span>] page:<br>    active  [Device slot] [2:7:1]<br>    active  [Array device slot] [2:7:1]<br>    <span class="hljs-built_in">disable</span>  [*] [0:5:1]<br>    devoff  [Device slot] [3:4:1]<br>    devoff  [Array device slot] [3:4:1]<br>    dnr  [Device slot] [2:6:1]<br>    dnr  [Array device slot] [2:6:1]<br>    fault  [Device slot] [3:5:1]<br>    fault  [Array device slot] [3:5:1]<br>    ident  [Device slot] [2:1:1]<br>    ident  [Array device slot] [2:1:1]<br>    ident  [Power supply] [1:7:1]<br>    ident  [Cooling] [1:7:1]<br>    ident  [Enclosure] [1:7:1]<br>    insert  [Device slot] [2:3:1]<br>    insert  [Array device slot] [2:3:1]<br>    locate  [Device slot] [2:1:1]<br>    locate  [Array device slot] [2:1:1]<br>    locate  [Power supply] [1:7:1]<br>    locate  [Cooling] [1:7:1]<br>    locate  [Enclosure] [1:7:1]<br>    missing  [Device slot] [2:4:1]<br>    missing  [Array device slot] [2:4:1]<br>    locate  [Device slot] [2:1:1]<br>    locate  [Array device slot] [2:1:1]<br>    prdfail  [*] [0:6:1]<br>    remove  [Device slot] [2:2:1]<br>    remove  [Array device slot] [2:2:1]<br>    speed_act  [Cooling] [2:7:8]<br>    speed_code  [Cooling] [3:2:3]<br>    swap  [*] [0:4:1]<br><br>--clear, --get, --<span class="hljs-built_in">set</span> acronyms <span class="hljs-keyword">for</span> Threshold In/Out [<span class="hljs-string">&#x27;th&#x27;</span>] page:<br>    high_crit  [*] [0:7:8]<br>    high_warn  [*] [1:7:8]<br>    low_crit  [*] [2:7:8]<br>    low_warn  [*] [3:7:8]<br><br>--get acronyms <span class="hljs-keyword">for</span> Additional Element Status [<span class="hljs-string">&#x27;aes&#x27;</span>] page (SAS EIP=1):<br>    at_sas_addr  [*] [20:7:64]<br>    dev_type  [*] [8:6:3]<br>    phy_id  [*] [28:7:8]<br>    sas_addr  [*] [12:7:64]<br>    sata_dev  [*] [11:0:1]<br>    sata_port_sel  [*] [11:7:1]<br>    smp_init  [*] [10:1:1]<br>    smp_targ  [*] [11:1:1]<br>    ssp_init  [*] [10:3:1]<br>    ssp_targ  [*] [11:3:1]<br>    stp_init  [*] [10:2:1]<br>    stp_targ  [*] [11:2:1]<br><br>$ sg_ses --index=7 --setl=ident /dev/sg12<br><span class="hljs-comment">### rebuild , green led blink</span><br>$ sg_ses --index=7 --<span class="hljs-built_in">set</span>=1:1:1 /dev/sg12<br>$ sg_ses --index=7 --<span class="hljs-built_in">set</span>=1:1:1 /dev/sg12<br><span class="hljs-comment">### fault , red led blink</span><br>$ sg_ses --index=7 --<span class="hljs-built_in">set</span>=fault /dev/sg12<br>$ sg_ses --index=7 --clear=fault /dev/sg12<br><span class="hljs-comment">### prdfail, orange and green blink by turn</span><br>$ sg_ses --index=7 --<span class="hljs-built_in">set</span>=prdfail /dev/sg12<br>$ sg_ses --index=7 --clear=prdfail /dev/sg12<br><span class="hljs-comment">### locate not work</span><br>$ sg_ses --index=7 --<span class="hljs-built_in">set</span>=2:1:1 /dev/sg12<br>$ sg_ses --index=7 --clear=2:1:1 /dev/sg12<br></code></pre></td></tr></table></figure>
<p>Element Customization<br>Array device slot control element</p>
<table>
<thead>
<tr>
<th>Byte Bit</th>
<th align="center">7</th>
<th align="right">6</th>
<th align="right">5</th>
<th align="right">4</th>
<th align="right">3</th>
<th align="right">2</th>
<th align="right">1</th>
<th align="right">0</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td align="center">select</td>
<td align="right">PRDFAIL</td>
<td align="right">DISABLED</td>
<td align="right">RST SWAP</td>
<td align="right">RESERVED</td>
<td align="right">RESERVED</td>
<td align="right">RESERVED</td>
<td align="right">RESERVED</td>
</tr>
<tr>
<td>1</td>
<td align="center">RQST OK</td>
<td align="right">RQSD RSVE DEV</td>
<td align="right">RQST HOT SPA</td>
<td align="right">RQST CONS CHK</td>
<td align="right">RQST IN CRIT ARR</td>
<td align="right">RQST IN FAILED ARR</td>
<td align="right">RQST REBUILD/REMAP</td>
<td align="right">RQST R/R ABORT</td>
</tr>
<tr>
<td>2</td>
<td align="center">RQST active</td>
<td align="right">DO NOT REMOVE</td>
<td align="right">RESERVED</td>
<td align="right">RQST MISSING</td>
<td align="right">RQST REMOVE</td>
<td align="right">RQST REMOVE</td>
<td align="right">RQST IDENT</td>
<td align="right">RESERVED</td>
</tr>
<tr>
<td>3</td>
<td align="center">RESERVED</td>
<td align="right">RESERVED</td>
<td align="right">RQST FAULT</td>
<td align="right">DEVICE OFF</td>
<td align="right">ENABLE BYP B</td>
<td align="right">ENABLE BYP B</td>
<td align="right">RESERVED</td>
<td align="right">RESERVED</td>
</tr>
</tbody></table>
<h4 id="Monitor"><a href="#Monitor" class="headerlink" title="Monitor"></a>Monitor</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">### view pages from the enclosure</span><br>$ sg_ses -p 0 /dev/sg103<br><br><br>$ lsscsi -git<br>[15:0:50:0]  enclosu sas:0x5000ccab0202777d          -          -  /dev/sg103<br><br>$ sg_ses -p 2 /dev/sg103<br><br>....<br>        Actual speed=0 rpm, Fan stopped<br>        Actual speed=4100 rpm, Fan at lowest speed<br>        Actual speed=4100 rpm, Fan at lowest speed<br>        Actual speed=4100 rpm, Fan at lowest speed<br>        Actual speed=4100 rpm, Fan at lowest speed<br>        Actual speed=4100 rpm, Fan at lowest speed<br>        Actual speed=4100 rpm, Fan at lowest speed<br><br>.....<br>    Element <span class="hljs-built_in">type</span>: Temperature sensor, subenclosure id: 0 [ti=3]<br>        Temperature: &lt;reserved&gt;<br>        Temperature=32 C<br>        Temperature=30 C<br>        Temperature=37 C<br>        Temperature=59 C<br>        Temperature=31 C<br>        Temperature=32 C<br>        Temperature=32 C<br>        Temperature=57 C<br>        Temperature=21 C<br>        Temperature=21 C<br>        Temperature=45 C<br>        Temperature=29 C<br>        Temperature=35 C<br>        Temperature=47 C<br>        Temperature=31 C<br>        Temperature=36 C<br><br>$  sg_ses -p 2 /dev/sg103 -r<br>        00 00 00 00 05 00 00 00  01 00 00 00 01 00 00 00<br>        01 00 00 00 01 00 00 00  01 00 00 00 01 00 00 00<br>        01 00 00 00 01 00 00 00  01 00 00 00 01 00 00 00<br>        01 00 00 00 01 00 00 00  01 00 00 00 01 00 00 00<br>        01 00 00 00 01 00 00 00  01 00 00 00 01 00 00 00<br>        01 00 00 00 01 00 00 00  01 00 00 00 01 00 00 00<br>        01 00 00 00 01 00 00 00  01 00 00 00 01 00 00 00<br>        01 00 00 00 01 00 00 00  01 00 00 00 01 00 00 00<br>        01 00 00 00 01 00 00 00  01 00 00 00 01 00 00 00<br>        01 00 00 00 01 00 00 00  01 00 00 00 01 00 00 00<br>        01 00 00 00 01 00 00 00  01 00 00 00 01 00 00 00<br>        01 00 00 00 01 00 00 00  01 00 00 00 01 00 00 00<br>        01 00 00 00 01 00 00 00  01 00 00 00 01 00 00 00<br>        05 00 00 00 05 00 00 00  05 00 00 00 05 00 00 00<br>        05 00 00 00 05 00 00 00  05 00 00 00 05 00 00 00<br>        05 00 00 00 05 00 00 00  01 00 00 00 01 00 00 00<br>        01 00 00 00 01 00 00 00  01 01 9a 01 01 01 95 01<br>        01 01 9a 01 01 01 9a 01  01 01 9a 01 01 01 9a 01<br>        01 00 00 00 01 00 34 00  01 00 32 00 01 00 39 00<br>        01 00 50 00 01 00 33 00  01 00 34 00 01 00 34 00<br>        01 00 4e 00 01 00 29 00  01 00 29 00 01 00 41 00<br>        01 00 31 00 01 00 37 00  01 00 43 00 01 00 33 00<br>        01 00 38 00 01 00 00 00  01 00 01 80 01 00 01 80<br>        01 00 00 00 01 00 00 00  01 00 00 00 01 00 00 5f<br>        01 00 00 64 01 00 00 b6  01 00 01 4c 01 00 00 5c<br>        01 00 00 63 01 00 00 b4  01 00 01 46 01 00 04 bf<br>        01 00 04 bf 01 00 00 00  01 00 00 00 01 00 00 00<br>        01 00 00 00 01 03 ff 00  01 03 ff 00 01 03 ff 00<br>        01 03 ff 00<br><br>$ sg_ses /dev/sg129 -p0x2 -I2,1 -j<br>first 2 menas Fan,1 is power,3 is temperature<br>-I2,0 means the first Fan, -I 2,1 means second fan<br><br>$ sg_ses -p 0 /dev/sg343<br>  SMC946    R39                 1C<br>Supported diagnostic pages:<br>  Supported Diagnostic Pages [sdp] [0x0]<br>  Configuration (SES) [cf] [0x1]<br>  Enclosure Status/Control (SES) [ec,es] [0x2]<br>  String In/Out (SES) [str] [0x4]<br>  Threshold In/Out (SES) [th] [0x5]<br>  Element Descriptor (SES) [ed] [0x7]<br>  Additional Element Status (SES-2) [aes] [0xa]<br>  Supported SES Diagnostic Pages (SES-2) [ssp] [0xd]<br>  Download Microcode (SES-2) [dm] [0xe]<br>  Subenclosure Nickname (SES-2) [snic] [0xf]<br><br>$ sg_ses -p 0 /dev/sg103<br>  HGST      4U60_STOR_ENCL    0210<br>Supported diagnostic pages:<br>  Supported Diagnostic Pages [sdp] [0x0]<br>  Configuration (SES) [cf] [0x1]<br>  Enclosure Status/Control (SES) [ec,es] [0x2]<br>  String In/Out (SES) [str] [0x4]<br>  Threshold In/Out (SES) [th] [0x5]<br>  Element Descriptor (SES) [ed] [0x7]<br>  Additional Element Status (SES-2) [aes] [0xa]<br>  Download Microcode (SES-2) [dm] [0xe]<br>  &lt;unknown&gt; [0x10]<br>  &lt;unknown&gt; [0x11]<br>  &lt;unknown&gt; [0x12]<br>  &lt;unknown&gt; [0x13]<br>  &lt;unknown&gt; [0x14]<br>  &lt;unknown&gt; [0x15]<br>  &lt;unknown&gt; [0x16]<br>$ sg_ses -p 0 /dev/sg91<br>  DELL      EN-8435A-E6EBD    3535<br>Supported diagnostic pages:<br>  Supported Diagnostic Pages [sdp] [0x0]<br>  Configuration (SES) [cf] [0x1]<br>  Enclosure Status/Control (SES) [ec,es] [0x2]<br>  Threshold In/Out (SES) [th] [0x5]<br>  Element Descriptor (SES) [ed] [0x7]<br>  Additional Element Status (SES-2) [aes] [0xa]<br>  Download Microcode (SES-2) [dm] [0xe]<br>  &lt;unknown&gt; [0x84]<br>  &lt;unknown&gt; [0x85]<br>  &lt;unknown&gt; [0x90]<br>  &lt;unknown&gt; [0x91]<br>  &lt;unknown&gt; [0x92]<br>  &lt;unknown&gt; [0x93]<br>$ sg_ses -p 0 /dev/sg335<br>  HPE       D6020             1.63<br>Supported diagnostic pages:<br>  Supported Diagnostic Pages [sdp] [0x0]<br>  Configuration (SES) [cf] [0x1]<br>  Enclosure Status/Control (SES) [ec,es] [0x2]<br>  Help Text (SES) [ht] [0x3]<br>  Element Descriptor (SES) [ed] [0x7]<br>  Additional Element Status (SES-2) [aes] [0xa]<br>  &lt;unknown&gt; [0x10]<br>  &lt;unknown&gt; [0x14]<br><br>sg_ses -ee /dev/sg291<br>&gt;&gt;&gt; DEVICE /dev/sg291 ignored when --enumerate option given.<br>--clear, --get, --<span class="hljs-built_in">set</span> acronyms <span class="hljs-keyword">for</span> Enclosure Status/Control [<span class="hljs-string">&#x27;es&#x27;</span> or <span class="hljs-string">&#x27;ec&#x27;</span>] page:<br>    active  [Device slot] [2:7:1]<br>    active  [Array device slot] [2:7:1]<br>    <span class="hljs-built_in">disable</span>  [*] [0:5:1]<br>    devoff  [Device slot] [3:4:1]<br>    devoff  [Array device slot] [3:4:1]<br>    dnr  [Device slot] [2:6:1]<br>    dnr  [Array device slot] [2:6:1]<br>    fault  [Device slot] [3:5:1]<br>    fault  [Array device slot] [3:5:1]<br>    ident  [Device slot] [2:1:1]<br>    ident  [Array device slot] [2:1:1]<br>    ident  [Power supply] [1:7:1]<br>    ident  [Cooling] [1:7:1]<br>    ident  [Enclosure] [1:7:1]<br>    insert  [Device slot] [2:3:1]<br>    insert  [Array device slot] [2:3:1]<br>    locate  [Device slot] [2:1:1]<br>    locate  [Array device slot] [2:1:1]<br>    locate  [Power supply] [1:7:1]<br>    locate  [Cooling] [1:7:1]<br>    locate  [Enclosure] [1:7:1]<br>    missing  [Device slot] [2:4:1]<br>    missing  [Array device slot] [2:4:1]<br>    locate  [Device slot] [2:1:1]<br>    locate  [Array device slot] [2:1:1]<br>    prdfail  [*] [0:6:1]<br>    remove  [Device slot] [2:2:1]<br>    remove  [Array device slot] [2:2:1]<br>    speed_act  [Cooling] [2:7:8]<br>    speed_code  [Cooling] [3:2:3]<br>    swap  [*] [0:4:1]<br><br>--clear, --get, --<span class="hljs-built_in">set</span> acronyms <span class="hljs-keyword">for</span> Threshold In/Out [<span class="hljs-string">&#x27;th&#x27;</span>] page:<br>    high_crit  [*] [0:7:8]<br>    high_warn  [*] [1:7:8]<br>    low_crit  [*] [2:7:8]<br>    low_warn  [*] [3:7:8]<br><br>--get acronyms <span class="hljs-keyword">for</span> Additional Element Status [<span class="hljs-string">&#x27;aes&#x27;</span>] page (SAS EIP=1):<br>    at_sas_addr  [*] [20:7:64]<br>    dev_type  [*] [8:6:3]<br>    phy_id  [*] [28:7:8]<br>    sas_addr  [*] [12:7:64]<br>    sata_dev  [*] [11:0:1]<br>    sata_port_sel  [*] [11:7:1]<br>    smp_init  [*] [10:1:1]<br>    smp_targ  [*] [11:1:1]<br>    ssp_init  [*] [10:3:1]<br>    ssp_targ  [*] [11:3:1]<br>    stp_init  [*] [10:2:1]<br>    stp_targ  [*] [11:2:1]<br><br>$ sg_ses -es /dev/sg291<br>&gt;&gt;&gt; DEVICE /dev/sg291 ignored when --enumerate option given.<br>Diagnostic pages, followed by abbreviation(s) <span class="hljs-keyword">then</span> page code:<br>    Supported Diagnostic Pages  [sdp] [0x0]<br>    Configuration (SES)  [cf] [0x1]<br>    Enclosure Status/Control (SES)  [ec,es] [0x2]<br>    Help Text (SES)  [ht] [0x3]<br>    String In/Out (SES)  [str] [0x4]<br>    Threshold In/Out (SES)  [th] [0x5]<br>    Array Status/Control (SES, obsolete)  [ac,as] [0x6]<br>    Element Descriptor (SES)  [ed] [0x7]<br>    Short Enclosure Status (SES)  [ses] [0x8]<br>    Enclosure Busy (SES-2)  [eb] [0x9]<br>    Additional Element Status (SES-2)  [aes] [0xa]<br>    Subenclosure Help Text (SES-2)  [sht] [0xb]<br>    Subenclosure String In/Out (SES-2)  [sstr] [0xc]<br>    Supported SES Diagnostic Pages (SES-2)  [ssp] [0xd]<br>    Download Microcode (SES-2)  [dm] [0xe]<br>    Subenclosure Nickname (SES-2)  [snic] [0xf]<br>    Protocol Specific (SAS transport)  [] [0x3f]<br>    Translate Address (SBC)  [] [0x40]<br>    Device Status (SBC)  [] [0x41]<br>    Rebuild Assist (SBC)  [] [0x42]<br><br>SES element <span class="hljs-built_in">type</span> names, followed by abbreviation and element <span class="hljs-built_in">type</span> code:<br>    Unspecified  [un] [0x0]<br>    Device slot  [dev] [0x1]<br>    Power supply  [ps] [0x2]<br>    Cooling  [coo] [0x3]<br>    Temperature sensor  [ts] [0x4]<br>    Door  [<span class="hljs-keyword">do</span>] [0x5]<br>    Audible alarm  [aa] [0x6]<br>    Enclosure services controller electronics  [esc] [0x7]<br>    SCC controller electronics  [sce] [0x8]<br>    Nonvolatile cache  [nc] [0x9]<br>    Invalid operation reason  [ior] [0xa]<br>    Uninterruptible power supply  [ups] [0xb]<br>    Display  [dis] [0xc]<br>    Key pad entry  [kpe] [0xd]<br>    Enclosure  [enc] [0xe]<br>    SCSI port/transceiver  [sp] [0xf]<br>    Language  [lan] [0x10]<br>    Communication port  [cp] [0x11]<br>    Voltage sensor  [vs] [0x12]<br>    Current sensor  [cs] [0x13]<br>    SCSI target port  [stp] [0x14]<br>    SCSI initiator port  [sip] [0x15]<br>    Simple subenclosure  [ss] [0x16]<br>    Array device slot  [arr] [0x17]<br>    SAS expander  [sse] [0x18]<br>    SAS connector  [ssc] [0x19]<br><br>[13:0:90:0]  disk    HGST     HUH721010AL5200  A21D  /dev/sdji  35000cca251ae9e94  /dev/sg278  10.0TB<br>[13:0:91:0]  disk    HGST     HUH721010AL5200  A21D  /dev/sdmv  35000cca251ac584c  /dev/sg372  10.0TB<br>[13:0:92:0]  disk    HGST     HUH721010AL5200  A21D  /dev/sdmw  35000cca251aca1b4  /dev/sg373  10.0TB<br>[14:0:0:0]   disk    HGST     HUH721010AL5200  A21D  /dev/sdjj  35000cca251b137a0  /dev/sg279  10.0TB<br>[14:0:1:0]   disk    HGST     HUH721010AL5200  A21D  /dev/sdjk  35000cca251b29994  /dev/sg280  10.0TB<br>[14:0:2:0]   disk    HGST     HUH721010AL5200  A21D  /dev/sdjl  35000cca251ab4d30  /dev/sg281  10.0TB<br>[14:0:3:0]   disk    HGST     HUH721010AL5200  A21D  /dev/sdjm  35000cca25198c678  /dev/sg282  10.0TB<br>[14:0:4:0]   disk    HGST     HUH721010AL5200  A21D  /dev/sdjn  35000cca251b12a14  /dev/sg283  10.0TB<br>[14:0:5:0]   disk    HGST     HUH721010AL5200  A21D  /dev/sdjo  35000cca251ac5a14  /dev/sg284  10.0TB<br>[14:0:6:0]   disk    HGST     HUH721010AL5200  A21D  /dev/sdjp  35000cca251b21390  /dev/sg285  10.0TB<br>[14:0:7:0]   disk    HGST     HUH721010AL5200  A21D  /dev/sdjq  35000cca251b25234  /dev/sg286  10.0TB<br>[14:0:8:0]   disk    HGST     HUH721010AL5200  A21D  /dev/sdjr  35000cca251b2f228  /dev/sg287  10.0TB<br>[14:0:9:0]   disk    HGST     HUH721010AL5200  A21D  /dev/sdjs  35000cca251b380d8  /dev/sg288  10.0TB<br>[14:0:10:0]  disk    HGST     HUH721010AL5200  A21D  /dev/sdjt  35000cca251b272ec  /dev/sg289  10.0TB<br>[14:0:11:0]  disk    HGST     HUH721010AL5200  A21D  /dev/sdju  35000cca251b13860  /dev/sg290  10.0TB<br>[14:0:12:0]  enclosu SMC946   12                 1C  -          -  /dev/sg291<br><br><span class="hljs-comment"># Get all descriptor</span><br>$ sg_ses -p 0x7 /dev/sg291<br>  SMC946    12                  1C<br>  Primary enclosure logical identifier (hex): 5003048009281a3f<br>Element Descriptor In diagnostic page:<br>  generation code: 0x0<br>  element descriptor by <span class="hljs-built_in">type</span> list<br>    Element <span class="hljs-built_in">type</span>: Array device slot, subenclosure id: 0 [ti=0]<br>      Overall descriptor: ArrayDevicesInSubEnclsr0<br>      Element 0 descriptor: Slot00<br>      Element 1 descriptor: Slot01<br>      Element 2 descriptor: Slot02<br>      Element 3 descriptor: Slot03<br>      Element 4 descriptor: Slot04<br>      Element 5 descriptor: Slot05<br>      Element 6 descriptor: Slot06<br>      Element 7 descriptor: Slot07<br>      Element 8 descriptor: Slot08<br>      Element 9 descriptor: Slot09<br>      Element 10 descriptor: Slot10<br>      Element 11 descriptor: Slot11<br>    Element <span class="hljs-built_in">type</span>: SAS expander, subenclosure id: 0 [ti=1]<br>      Overall descriptor: SAS Expander<br>      Element 0 descriptor: Expander0<br>    Element <span class="hljs-built_in">type</span>: SAS connector, subenclosure id: 0 [ti=2]<br>      Overall descriptor: SAS Connectors<br>      Element 0 descriptor: ConnectorA<br>      Element 1 descriptor: ConnectorB<br>      Element 2 descriptor: ConnectorC<br>      Element 3 descriptor: ConnectorD<br>      Element 4 descriptor: Drive Connector 00<br>      Element 5 descriptor: Drive Connector 01<br>      Element 6 descriptor: Drive Connector 02<br>      Element 7 descriptor: Drive Connector 03<br>      Element 8 descriptor: Drive Connector 04<br>      Element 9 descriptor: Drive Connector 05<br>      Element 10 descriptor: Drive Connector 06<br>      Element 11 descriptor: Drive Connector 07<br>      Element 12 descriptor: Drive Connector 08<br>      Element 13 descriptor: Drive Connector 09<br>      Element 14 descriptor: Drive Connector 10<br>      Element 15 descriptor: Drive Connector 11<br>    Element <span class="hljs-built_in">type</span>: Enclosure, subenclosure id: 0 [ti=3]<br>      Overall descriptor: EnclosureElementInSubEnclsr0<br>      Element 0 descriptor: RD-BHE-000-02343<br>    Element <span class="hljs-built_in">type</span>: Temperature sensor, subenclosure id: 0 [ti=4]<br>      Overall descriptor: TempSensorsInSubEnclsr0<br>      Element 0 descriptor: ChipDie<br>      Element 1 descriptor: VRM1<br>      Element 2 descriptor: VRM2<br>      Element 3 descriptor: SYSTemp<br>      Element 4 descriptor: HDDBPN<br>    Element <span class="hljs-built_in">type</span>: Voltage sensor, subenclosure id: 0 [ti=5]<br>      Overall descriptor: VoltageSensorsInSubEnclsr0<br>      Element 0 descriptor: 12VSB<br>      Element 1 descriptor: 3P3VSB<br>      Element 2 descriptor: 1P2BMC<br>      Element 3 descriptor: 1P5BMC<br>      Element 4 descriptor: VBAT<br>      Element 5 descriptor: 12VCC<br>      Element 6 descriptor: 3P3VCC<br>      Element 7 descriptor: 1P8VEXP1<br>      Element 8 descriptor: 0P9VEXP1<br>      Element 9 descriptor: 0P9VREXP1<br>      Element 10 descriptor: 1P8VEXP2<br>      Element 11 descriptor: 0P9VEXP2<br>      Element 12 descriptor: 0P9VREXP2<br>      Element 13 descriptor: 1P8VEXP3<br>      Element 14 descriptor: 0P9VEXP3<br>      Element 15 descriptor: 0P9VREXP3<br>    Element <span class="hljs-built_in">type</span>: Cooling, subenclosure id: 0 [ti=6]<br>      Overall descriptor: CoolingElementInSubEnclsr0<br>      Element 0 descriptor: Fan1<br>      Element 1 descriptor: Fan2<br>      Element 2 descriptor: Fan3<br>      Element 3 descriptor: Fan4<br>      Element 4 descriptor: Fan5<br>      Element 5 descriptor: Fan1C<br>      Element 6 descriptor: Fan2C<br>      Element 7 descriptor: Fan3C<br>      Element 8 descriptor: Fan4C<br>      Element 9 descriptor: Fan5C<br>    Element <span class="hljs-built_in">type</span>: Power supply, subenclosure id: 0 [ti=7]<br>      Overall descriptor: PowerSupplyStatus<br>      Element 0 descriptor: PWS1<br>      Element 1 descriptor: PWS2<br>      Element 2 descriptor: PWS3<br>      Element 3 descriptor: PWS4<br><br>$  sg_ses -p 0x2 /dev/sg291<br>  SMC946    12                  1C<br>  Primary enclosure logical identifier (hex): 5003048009281a3f<br>Enclosure Status diagnostic page:<br>  INVOP=0, INFO=0, NON-CRIT=0, CRIT=1, UNRECOV=0<br>  generation code: 0x0<br>  status descriptor list<br>    Element <span class="hljs-built_in">type</span>: Array device slot, subenclosure id: 0 [ti=0]<br>      Overall descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: Unsupported<br>        OK=0, Reserved device=0, Hot spare=0, Cons check=0<br>        In crit array=0, In failed array=0, Rebuild/remap=0, R/R abort=0<br>        App client bypass A=0, Do not remove=0, Enc bypass A=0, Enc bypass B=0<br>        Ready to insert=0, RMV=0, Ident=0, Report=0<br>        App client bypass B=0, Fault sensed=0, Fault reqstd=0, Device off=0<br>        Bypassed A=0, Bypassed B=0, Dev bypassed A=0, Dev bypassed B=0<br>      Element 0 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        OK=0, Reserved device=0, Hot spare=0, Cons check=0<br>        In crit array=0, In failed array=0, Rebuild/remap=0, R/R abort=0<br>        App client bypass A=0, Do not remove=0, Enc bypass A=0, Enc bypass B=0<br>        Ready to insert=0, RMV=0, Ident=0, Report=0<br>        App client bypass B=0, Fault sensed=0, Fault reqstd=0, Device off=0<br>        Bypassed A=0, Bypassed B=0, Dev bypassed A=0, Dev bypassed B=0<br>      Element 1 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        OK=0, Reserved device=0, Hot spare=0, Cons check=0<br>        In crit array=0, In failed array=0, Rebuild/remap=0, R/R abort=0<br>        App client bypass A=0, Do not remove=0, Enc bypass A=0, Enc bypass B=0<br>        Ready to insert=0, RMV=0, Ident=0, Report=0<br>        App client bypass B=0, Fault sensed=0, Fault reqstd=0, Device off=0<br>        Bypassed A=0, Bypassed B=0, Dev bypassed A=0, Dev bypassed B=0<br>      Element 2 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        OK=0, Reserved device=0, Hot spare=0, Cons check=0<br>        In crit array=0, In failed array=0, Rebuild/remap=0, R/R abort=0<br>        App client bypass A=0, Do not remove=0, Enc bypass A=0, Enc bypass B=0<br>        Ready to insert=0, RMV=0, Ident=0, Report=0<br>        App client bypass B=0, Fault sensed=0, Fault reqstd=0, Device off=0<br>        Bypassed A=0, Bypassed B=0, Dev bypassed A=0, Dev bypassed B=0<br>      Element 3 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        OK=0, Reserved device=0, Hot spare=0, Cons check=0<br>        In crit array=0, In failed array=0, Rebuild/remap=0, R/R abort=0<br>        App client bypass A=0, Do not remove=0, Enc bypass A=0, Enc bypass B=0<br>        Ready to insert=0, RMV=0, Ident=0, Report=0<br>        App client bypass B=0, Fault sensed=0, Fault reqstd=0, Device off=0<br>        Bypassed A=0, Bypassed B=0, Dev bypassed A=0, Dev bypassed B=0<br>      Element 4 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        OK=0, Reserved device=0, Hot spare=0, Cons check=0<br>        In crit array=0, In failed array=0, Rebuild/remap=0, R/R abort=0<br>        App client bypass A=0, Do not remove=0, Enc bypass A=0, Enc bypass B=0<br>        Ready to insert=0, RMV=0, Ident=0, Report=0<br>        App client bypass B=0, Fault sensed=0, Fault reqstd=0, Device off=0<br>        Bypassed A=0, Bypassed B=0, Dev bypassed A=0, Dev bypassed B=0<br>      Element 5 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        OK=0, Reserved device=0, Hot spare=0, Cons check=0<br>        In crit array=0, In failed array=0, Rebuild/remap=0, R/R abort=0<br>        App client bypass A=0, Do not remove=0, Enc bypass A=0, Enc bypass B=0<br>        Ready to insert=0, RMV=0, Ident=0, Report=0<br>        App client bypass B=0, Fault sensed=0, Fault reqstd=0, Device off=0<br>        Bypassed A=0, Bypassed B=0, Dev bypassed A=0, Dev bypassed B=0<br>      Element 6 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        OK=0, Reserved device=0, Hot spare=0, Cons check=0<br>        In crit array=0, In failed array=0, Rebuild/remap=0, R/R abort=0<br>        App client bypass A=0, Do not remove=0, Enc bypass A=0, Enc bypass B=0<br>        Ready to insert=0, RMV=0, Ident=0, Report=0<br>        App client bypass B=0, Fault sensed=0, Fault reqstd=0, Device off=0<br>        Bypassed A=0, Bypassed B=0, Dev bypassed A=0, Dev bypassed B=0<br>      Element 7 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        OK=0, Reserved device=0, Hot spare=0, Cons check=0<br>        In crit array=0, In failed array=0, Rebuild/remap=0, R/R abort=0<br>        App client bypass A=0, Do not remove=0, Enc bypass A=0, Enc bypass B=0<br>        Ready to insert=0, RMV=0, Ident=0, Report=0<br>        App client bypass B=0, Fault sensed=0, Fault reqstd=0, Device off=0<br>        Bypassed A=0, Bypassed B=0, Dev bypassed A=0, Dev bypassed B=0<br>      Element 8 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        OK=0, Reserved device=0, Hot spare=0, Cons check=0<br>        In crit array=0, In failed array=0, Rebuild/remap=0, R/R abort=0<br>        App client bypass A=0, Do not remove=0, Enc bypass A=0, Enc bypass B=0<br>        Ready to insert=0, RMV=0, Ident=0, Report=0<br>        App client bypass B=0, Fault sensed=0, Fault reqstd=0, Device off=0<br>        Bypassed A=0, Bypassed B=0, Dev bypassed A=0, Dev bypassed B=0<br>      Element 9 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        OK=0, Reserved device=0, Hot spare=0, Cons check=0<br>        In crit array=0, In failed array=0, Rebuild/remap=0, R/R abort=0<br>        App client bypass A=0, Do not remove=0, Enc bypass A=0, Enc bypass B=0<br>        Ready to insert=0, RMV=0, Ident=0, Report=0<br>        App client bypass B=0, Fault sensed=0, Fault reqstd=0, Device off=0<br>        Bypassed A=0, Bypassed B=0, Dev bypassed A=0, Dev bypassed B=0<br>      Element 10 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        OK=0, Reserved device=0, Hot spare=0, Cons check=0<br>        In crit array=0, In failed array=0, Rebuild/remap=0, R/R abort=0<br>        App client bypass A=0, Do not remove=0, Enc bypass A=0, Enc bypass B=0<br>        Ready to insert=0, RMV=0, Ident=0, Report=0<br>        App client bypass B=0, Fault sensed=0, Fault reqstd=0, Device off=0<br>        Bypassed A=0, Bypassed B=0, Dev bypassed A=0, Dev bypassed B=0<br>      Element 11 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        OK=0, Reserved device=0, Hot spare=0, Cons check=0<br>        In crit array=0, In failed array=0, Rebuild/remap=0, R/R abort=0<br>        App client bypass A=0, Do not remove=0, Enc bypass A=0, Enc bypass B=0<br>        Ready to insert=0, RMV=0, Ident=0, Report=0<br>        App client bypass B=0, Fault sensed=0, Fault reqstd=0, Device off=0<br>        Bypassed A=0, Bypassed B=0, Dev bypassed A=0, Dev bypassed B=0<br>    Element <span class="hljs-built_in">type</span>: SAS expander, subenclosure id: 0 [ti=1]<br>      Overall descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: Unsupported<br>        Ident=0, Fail=0<br>      Element 0 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Fail=0<br>    Element <span class="hljs-built_in">type</span>: SAS connector, subenclosure id: 0 [ti=2]<br>      Overall descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: Unsupported<br>        Ident=0, No information<br>        Connector physical link=0x0, Fail=0<br>      Element 0 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Mini SAS HD 4i receptacle (SFF-8643) [max 4 phys]<br>        Connector physical link=0x0, Fail=0<br>      Element 1 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Mini SAS HD 4i receptacle (SFF-8643) [max 4 phys]<br>        Connector physical link=0x0, Fail=0<br>      Element 2 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Mini SAS HD 4i receptacle (SFF-8643) [max 4 phys]<br>        Connector physical link=0x0, Fail=0<br>      Element 3 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Mini SAS HD 4i receptacle (SFF-8643) [max 4 phys]<br>        Connector physical link=0x0, Fail=0<br>      Element 4 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, SAS Drive backplane receptacle (SFF-8482) [max 2 phys]<br>        Connector physical link=0x0, Fail=0<br>      Element 5 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, SAS Drive backplane receptacle (SFF-8482) [max 2 phys]<br>        Connector physical link=0x0, Fail=0<br>      Element 6 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, SAS Drive backplane receptacle (SFF-8482) [max 2 phys]<br>        Connector physical link=0x0, Fail=0<br>      Element 7 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, SAS Drive backplane receptacle (SFF-8482) [max 2 phys]<br>        Connector physical link=0x0, Fail=0<br>      Element 8 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, SAS Drive backplane receptacle (SFF-8482) [max 2 phys]<br>        Connector physical link=0x0, Fail=0<br>      Element 9 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, SAS Drive backplane receptacle (SFF-8482) [max 2 phys]<br>        Connector physical link=0x0, Fail=0<br>      Element 10 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, SAS Drive backplane receptacle (SFF-8482) [max 2 phys]<br>        Connector physical link=0x0, Fail=0<br>      Element 11 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, SAS Drive backplane receptacle (SFF-8482) [max 2 phys]<br>        Connector physical link=0x0, Fail=0<br>      Element 12 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, SAS Drive backplane receptacle (SFF-8482) [max 2 phys]<br>        Connector physical link=0x0, Fail=0<br>      Element 13 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, SAS Drive backplane receptacle (SFF-8482) [max 2 phys]<br>        Connector physical link=0x0, Fail=0<br>      Element 14 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, SAS Drive backplane receptacle (SFF-8482) [max 2 phys]<br>        Connector physical link=0x0, Fail=0<br>      Element 15 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, SAS Drive backplane receptacle (SFF-8482) [max 2 phys]<br>        Connector physical link=0x0, Fail=0<br>    Element <span class="hljs-built_in">type</span>: Enclosure, subenclosure id: 0 [ti=3]<br>      Overall descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: Unsupported<br>        Ident=0, Time until power cycle=0, Failure indication=0<br>        Warning indication=0, Requested power off duration=0<br>        Failure requested=0, Warning requested=0<br>      Element 0 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Time until power cycle=0, Failure indication=0<br>        Warning indication=0, Requested power off duration=0<br>        Failure requested=0, Warning requested=0<br>    Element <span class="hljs-built_in">type</span>: Temperature sensor, subenclosure id: 0 [ti=4]<br>      Overall descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: Unsupported<br>        Ident=0, Fail=0, OT failure=0, OT warning=0, UT failure=0<br>        UT warning=0<br>        Temperature: &lt;reserved&gt;<br>      Element 0 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Fail=0, OT failure=0, OT warning=0, UT failure=0<br>        UT warning=0<br>        Temperature=79 C<br>      Element 1 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Fail=0, OT failure=0, OT warning=0, UT failure=0<br>        UT warning=0<br>        Temperature=46 C<br>      Element 2 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Fail=0, OT failure=0, OT warning=0, UT failure=0<br>        UT warning=0<br>        Temperature=43 C<br>      Element 3 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Fail=0, OT failure=0, OT warning=0, UT failure=0<br>        UT warning=0<br>        Temperature=78 C<br>      Element 4 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Fail=0, OT failure=0, OT warning=0, UT failure=0<br>        UT warning=0<br>        Temperature=29 C<br>    Element <span class="hljs-built_in">type</span>: Voltage sensor, subenclosure id: 0 [ti=5]<br>      Overall descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: Unsupported<br>        Ident=0, Fail=0,  Warn Over=0, Warn Under=0, Crit Over=0<br>        Crit Under=0<br>        Voltage: 0.00 volts<br>      Element 0 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Fail=0,  Warn Over=0, Warn Under=0, Crit Over=0<br>        Crit Under=0<br>        Voltage: 12.20 volts<br>      Element 1 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Fail=0,  Warn Over=0, Warn Under=0, Crit Over=0<br>        Crit Under=0<br>        Voltage: 3.20 volts<br>      Element 2 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Fail=0,  Warn Over=0, Warn Under=0, Crit Over=0<br>        Crit Under=0<br>        Voltage: 1.20 volts<br>      Element 3 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Fail=0,  Warn Over=0, Warn Under=0, Crit Over=0<br>        Crit Under=0<br>        Voltage: 1.50 volts<br>      Element 4 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Fail=0,  Warn Over=0, Warn Under=0, Crit Over=0<br>        Crit Under=0<br>        Voltage: 3.20 volts<br>      Element 5 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Fail=0,  Warn Over=0, Warn Under=0, Crit Over=0<br>        Crit Under=0<br>        Voltage: 11.90 volts<br>      Element 6 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Fail=0,  Warn Over=0, Warn Under=0, Crit Over=0<br>        Crit Under=0<br>        Voltage: 3.20 volts<br>      Element 7 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Fail=0,  Warn Over=0, Warn Under=0, Crit Over=0<br>        Crit Under=0<br>        Voltage: 1.80 volts<br>      Element 8 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Fail=0,  Warn Over=0, Warn Under=0, Crit Over=0<br>        Crit Under=0<br>        Voltage: 0.90 volts<br>      Element 9 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Fail=0,  Warn Over=0, Warn Under=0, Crit Over=0<br>        Crit Under=0<br>        Voltage: 0.90 volts<br>      Element 10 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Fail=0,  Warn Over=0, Warn Under=0, Crit Over=0<br>        Crit Under=0<br>        Voltage: 1.80 volts<br>      Element 11 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Fail=0,  Warn Over=0, Warn Under=0, Crit Over=0<br>        Crit Under=0<br>        Voltage: 0.80 volts<br>      Element 12 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Fail=0,  Warn Over=0, Warn Under=0, Crit Over=0<br>        Crit Under=0<br>        Voltage: 0.90 volts<br>      Element 13 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Fail=0,  Warn Over=0, Warn Under=0, Crit Over=0<br>        Crit Under=0<br>        Voltage: 1.80 volts<br>      Element 14 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Fail=0,  Warn Over=0, Warn Under=0, Crit Over=0<br>        Crit Under=0<br>        Voltage: 0.90 volts<br>      Element 15 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Fail=0,  Warn Over=0, Warn Under=0, Crit Over=0<br>        Crit Under=0<br>        Voltage: 0.90 volts<br>    Element <span class="hljs-built_in">type</span>: Cooling, subenclosure id: 0 [ti=6]<br>      Overall descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: Unsupported<br>        Ident=0, Hot swap=0, Fail=0, Requested on=0, Off=0<br>        Actual speed=0 rpm, Fan stopped<br>      Element 0 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Hot swap=1, Fail=0, Requested on=0, Off=0<br>        Actual speed=12000 rpm, Fan stopped<br>      Element 1 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Hot swap=1, Fail=0, Requested on=0, Off=0<br>        Actual speed=11700 rpm, Fan stopped<br>      Element 2 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Hot swap=1, Fail=0, Requested on=0, Off=0<br>        Actual speed=11100 rpm, Fan stopped<br>      Element 3 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Hot swap=1, Fail=0, Requested on=0, Off=0<br>        Actual speed=11700 rpm, Fan stopped<br>      Element 4 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Hot swap=1, Fail=0, Requested on=0, Off=0<br>        Actual speed=11800 rpm, Fan stopped<br>      Element 5 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Hot swap=1, Fail=0, Requested on=0, Off=0<br>        Actual speed=11000 rpm, Fan stopped<br>      Element 6 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Hot swap=1, Fail=0, Requested on=0, Off=0<br>        Actual speed=10900 rpm, Fan stopped<br>      Element 7 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Hot swap=1, Fail=0, Requested on=0, Off=0<br>        Actual speed=11900 rpm, Fan stopped<br>      Element 8 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Hot swap=1, Fail=0, Requested on=0, Off=0<br>        Actual speed=10800 rpm, Fan stopped<br>      Element 9 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=0, Hot swap=1, Fail=0, Requested on=0, Off=0<br>        Actual speed=11000 rpm, Fan stopped<br>    Element <span class="hljs-built_in">type</span>: Power supply, subenclosure id: 0 [ti=7]<br>      Overall descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: Unsupported<br>        Ident=0, DC overvoltage=0, DC undervoltage=0, DC overcurrent=0<br>        Hot swap=0, Fail=0, Requested on=0, Off=0, Overtmp fail=0<br>        Temperature warn=0, AC fail=0, DC fail=0<br>      Element 0 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=1, DC overvoltage=0, DC undervoltage=0, DC overcurrent=0<br>        Hot swap=1, Fail=0, Requested on=1, Off=0, Overtmp fail=0<br>        Temperature warn=0, AC fail=0, DC fail=0<br>      Element 1 descriptor:<br>        Predicted failure=1, Disabled=0, Swap=0, status: OK<br>        Ident=1, DC overvoltage=0, DC undervoltage=0, DC overcurrent=0<br>        Hot swap=1, Fail=0, Requested on=1, Off=0, Overtmp fail=0<br>        Temperature warn=0, AC fail=0, DC fail=0<br>      Element 2 descriptor:<br>        Predicted failure=1, Disabled=0, Swap=0, status: OK<br>        Ident=1, DC overvoltage=0, DC undervoltage=0, DC overcurrent=0<br>        Hot swap=1, Fail=0, Requested on=1, Off=0, Overtmp fail=0<br>        Temperature warn=0, AC fail=0, DC fail=0<br>      Element 3 descriptor:<br>        Predicted failure=0, Disabled=0, Swap=0, status: OK<br>        Ident=1, DC overvoltage=0, DC undervoltage=0, DC overcurrent=0<br>        Hot swap=1, Fail=0, Requested on=1, Off=0, Overtmp fail=0<br>        Temperature warn=0, AC fail=0, DC fail=0 <br><br><br>---------------------------------<br>[0:0:9:0]    disk    HGST     HUH721010AL5200  LS14  /dev/sdj   35000cca26c1b8630  /dev/sg9   10.0TB<br><br>Element 9 descriptor: Drive Slot 9<br><br>      Element index: 9  eiioe=0<br>        Transport protocol: SAS<br>        number of phys: 2, not all phys: 0, device slot number: 9<br>        phy index: 0<br>          SAS device <span class="hljs-built_in">type</span>: end device<br>          initiator port <span class="hljs-keyword">for</span>:<br>          target port <span class="hljs-keyword">for</span>: SSP<br>          attached SAS address: 0x500056b3787358ff<br>          SAS address: 0x5000cca26c1b8631<br>          phy identifier: 0x0<br><br><br><span class="hljs-comment"># Turn off the device slot power</span><br>$ sg_ses --descriptor=<span class="hljs-string">&quot;Drive Slot 9&quot;</span> --<span class="hljs-built_in">set</span>=3:4:1 /dev/sg12<br><br>$ sg_ses --descriptor=<span class="hljs-string">&quot;Drive Slot 9&quot;</span> --get=3:4:1 /dev/sg12<br>0<br><br><span class="hljs-comment"># Turn on the device slot power</span><br>$ sg_ses --descriptor=<span class="hljs-string">&quot;Drive Slot 9&quot;</span> --clear=3:4:1 /dev/sg12<br><br><span class="hljs-comment">########## Power</span><br>    Element <span class="hljs-built_in">type</span>: Power supply, subenclosure id: 0 [ti=7]<br>      Overall descriptor: PowerSupplyStatus<br>      Element 0 descriptor: PWS1<br>      Element 1 descriptor: PWS2<br>      Element 2 descriptor: PWS3<br>      Element 3 descriptor: PWS4<br><br><span class="hljs-comment"># Turn off PWS1</span><br>$ sg_ses --discriptor=<span class="hljs-string">&quot;PWS1&quot;</span> --clear=3:5:1 /dev/sg291<br><br><span class="hljs-comment"># Power on </span><br>$ sg_ses --discriptor=<span class="hljs-string">&quot;PWS1&quot;</span> --<span class="hljs-built_in">set</span>=3:5:1 /dev/sg291<br><br><span class="hljs-comment">############ Fan</span><br>    Element <span class="hljs-built_in">type</span>: Cooling, subenclosure id: 0 [ti=6]<br>      Overall descriptor: CoolingElementInSubEnclsr0<br>      Element 0 descriptor: Fan1<br>      Element 1 descriptor: Fan2<br>      Element 2 descriptor: Fan3<br>      Element 3 descriptor: Fan4<br>      Element 4 descriptor: Fan5<br>      Element 5 descriptor: Fan1C<br>      Element 6 descriptor: Fan2C<br>      Element 7 descriptor: Fan3C<br>      Element 8 descriptor: Fan4C<br>      Element 9 descriptor: Fan5C<br><br><span class="hljs-comment">#Light the FAN led</span><br>$ sg_ses --descriptor=Fan1C --<span class="hljs-built_in">set</span>=1:7:1 /dev/sg291<br><br><span class="hljs-comment">#REQUESTED SPEED MODE  PWM</span><br>7 Full speed<br>6 Second highest <br>5 third highest<br>4 Intermediate<br>3 Third Loweest<br>2 Second lowest<br>1 Lowest speed<br>0 Leave at current speed<br><br>$ sg_ses --descriptor=Fan1C --<span class="hljs-built_in">set</span>=3:2:3=7 /dev/sg291<br>$ sg_ses --descriptor=Fan1C --<span class="hljs-built_in">set</span>=3:2:3=5 /dev/sg291<br><br></code></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>Byte Bit</th>
<th align="center">7</th>
<th align="right">6</th>
<th align="right">5</th>
<th align="right">4</th>
<th align="right">3</th>
<th align="right">2</th>
<th align="right">1</th>
<th align="right">0</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td align="center">select</td>
<td align="right">PRDFAIL</td>
<td align="right">DISABLED</td>
<td align="right">RST SWAP</td>
<td align="right">RESERVED</td>
<td align="right">RESERVED</td>
<td align="right">RESERVED</td>
<td align="right">RESERVED</td>
</tr>
<tr>
<td>1</td>
<td align="center">RQST IDENT</td>
<td align="right">RESERVED</td>
<td align="right">RESERVED</td>
<td align="right">RESERVED</td>
<td align="right">RESERVED</td>
<td align="right">RESERVED</td>
<td align="right">RESERVED</td>
<td align="right">RESERVED</td>
</tr>
<tr>
<td>2</td>
<td align="center">RESERVED</td>
<td align="right">RESERVED</td>
<td align="right">RESERVED</td>
<td align="right">RESERVED</td>
<td align="right">RESERVED</td>
<td align="right">RESERVED</td>
<td align="right">RESERVED</td>
<td align="right">RESERVED</td>
</tr>
<tr>
<td>3</td>
<td align="center">RESERVED</td>
<td align="right">RQST FAIL</td>
<td align="right">RQST ON</td>
<td align="right">RESERVED</td>
<td align="right">RESERVED</td>
<td align="right">REQUESTED SPEED CODE</td>
<td align="right">REQUESTED SPEED CODE</td>
<td align="right">REQUESTED SPEED CODE</td>
</tr>
</tbody></table>
<h4 id="Avoid-multiple-JBOD-devs-across-in-single-raidz"><a href="#Avoid-multiple-JBOD-devs-across-in-single-raidz" class="headerlink" title="Avoid multiple JBOD devs across in single raidz"></a>Avoid multiple JBOD devs across in single raidz</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">tempdir=/tmp;<br>lsscsi -tiv  | sed -z <span class="hljs-string">&#x27;s/\n  dir:/ /g&#x27;</span> | awk -v tempdir=<span class="hljs-string">&quot;<span class="hljs-variable">$tempdir</span>&quot;</span> -F <span class="hljs-string">&#x27;[:\\[/ ]+&#x27;</span> <span class="hljs-string">&#x27;$10!~/-/ &amp;&amp; $0~/disk/ &amp;&amp; $7~/sas/ &#123;print &quot;/dev/disk/by-id/scsi-&quot;$11,$2 &gt; tempdir&quot;/&quot;$30&quot;_&quot;$31&quot;_&quot;$32&quot;_&quot;$33&quot;_&quot;$34&#125;&#x27;</span><br></code></pre></td></tr></table></figure>

<h4 id="map-element-index-and-sas-addr"><a href="#map-element-index-and-sas-addr" class="headerlink" title="map element index and sas addr"></a>map element index and sas addr</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">[0:0:12:0]   enclosu DP       BP14G+EXP        2.25  -          -  /dev/sg12<br><br>$ sg_ses -p 0xa /dev/sg12 | awk <span class="hljs-string">&#x27;&#123;if($0!~/0x0000000000000000/ &amp;&amp; $0!~/attached SAS address/) &#123;if ($0~/Element index/) &#123;printf &quot;Element_index &quot;$3&quot; &quot;&#125;; if ($0~/number of phys/) &#123;printf &quot;slot &quot;$NF&quot; &quot;&#125;; if ($0~/SAS address/) &#123;print &quot;sasaddr &quot;$NF&#125; &#125;&#125;&#x27;</span><br>Element_index 0 slot 0 sasaddr 0x500056b3787358c0<br>Element_index 1 slot 1 sasaddr 0x500056b3787358c1<br>Element_index 2 slot 2 sasaddr 0x500056b3787358c2<br>Element_index 3 slot 3 sasaddr 0x500056b3787358c3<br>Element_index 4 slot 4 sasaddr 0x500056b3787358c4<br>Element_index 5 slot 5 sasaddr 0x500056b3787358c5<br>Element_index 6 slot 6 sasaddr 0x500056b3787358c6<br>Element_index 7 slot 7 sasaddr 0x500056b3787358c7<br>Element_index 8 slot 8 sasaddr 0x500056b3787358c8<br>Element_index 9 slot 9 sasaddr 0x500056b3787358c9<br>Element_index 10 slot 10 sasaddr 0x500056b3787358ca<br></code></pre></td></tr></table></figure>


<h3 id="SATA"><a href="#SATA" class="headerlink" title="SATA"></a>SATA</h3><h4 id="Enable-SATA-TLER-ERC-CCTL"><a href="#Enable-SATA-TLER-ERC-CCTL" class="headerlink" title="Enable SATA TLER/ERC/CCTL"></a>Enable SATA TLER/ERC/CCTL</h4><p>Western Digital/HGST TLER - Time-Limited Error Recovery<br>Seagate ERC- Error Recovery Control<br>Hitachi/Samsung CCTL - Command Completion Time Limit</p>
<p>Streaming Commands<br>When the device is in standby mode, Streaming Commands can’t be completed<br>while waiting for the spindle to reach operating speed even if execution time<br>exceeds specified CCTL(Command Completion Time Limit). The minimum CCTL<br>is 50ms.CCTL is set to 50ms when the specified value is shorter than 50ms.</p>
<p>SCT<br>When the device is in standby mode, any command where error recovery time<br>limit is specified can’t be completed while waiting for the spindle to reach operating<br>speed even if execution time exceeds specified recovery time limit. The minimum<br>time limit is 6.5 second. When the specified time limit is shorter than 6.5 second,<br>the issued command is aborted.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ lsscsi -gi | grep sdy<br>[1:0:18:0]   disk    ATA      HGST HUH721212AL T3D0  /dev/sdy   -  /dev/sg25<br><br>$ smartctl -l scterc,70,70 /dev/sdy<br>smartctl 6.5 2016-05-07 r4318 [x86_64-linux-3.10.0-957.el7_lustre.x86_64] (<span class="hljs-built_in">local</span> build)<br>Copyright (C) 2002-16, Bruce Allen, Christian Franke, www.smartmontools.org<br><br>SCT Error Recovery Control <span class="hljs-built_in">set</span> to:<br>           Read:     70 (7.0 seconds)<br>          Write:     70 (7.0 seconds)<br><br>$ smartctl -l scterc /dev/sdy<br>martctl 6.5 2016-05-07 r4318 [x86_64-linux-3.10.0-957.el7_lustre.x86_64] (<span class="hljs-built_in">local</span> build)<br>Copyright (C) 2002-16, Bruce Allen, Christian Franke, www.smartmontools.org<br><br>SCT Error Recovery Control:<br>           Read:     70 (7.0 seconds)<br>          Write:     70 (7.0 seconds)<br></code></pre></td></tr></table></figure>

<h3 id="Get-hide-area-from-SATA-SSD"><a href="#Get-hide-area-from-SATA-SSD" class="headerlink" title="Get hide area from SATA SSD"></a><a target="_blank" rel="noopener" href="https://tinyapps.org/docs/wipe_drives_hdparm.html">Get hide area from SATA SSD</a></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><code class="hljs sql">$ hdparm -I /dev/sdx<br>....<br>Security:<br>        Master password revision code = 65534<br>                supported<br>        not     enabled<br>        not     locked<br>        not     frozen<br>        not     expired: security count<br>                supported: enhanced erase<br>        4min for SECURITY ERASE UNIT. 4min for ENHANCED SECURITY ERASE UNIT.<br><br><span class="hljs-comment"># set password</span><br>$ hdparm <span class="hljs-comment">--user-master u --security-set-pass p /dev/sdx</span><br><br><span class="hljs-comment"># Erase the dev</span><br>$ hdparm <span class="hljs-comment">--user-master u --security-erase p /dev/sdx</span><br><span class="hljs-comment"># if you dev support security-erase-enhanced, you could use security-erase-enhanced</span><br>Secure erase overwrites all user data areas <span class="hljs-keyword">with</span> <span class="hljs-built_in">binary</span> zeroes. Enhanced secure erase writes predetermined <span class="hljs-keyword">data</span> patterns (<span class="hljs-keyword">set</span> <span class="hljs-keyword">by</span> the manufacturer) <span class="hljs-keyword">to</span> <span class="hljs-keyword">all</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">data</span> areas, <span class="hljs-keyword">including</span> sectors that <span class="hljs-keyword">are</span> <span class="hljs-keyword">no</span> longer <span class="hljs-keyword">in</span> <span class="hljs-keyword">use</span> due <span class="hljs-keyword">to</span> reallocation. ***NOTE: the enhanced secure erase <span class="hljs-keyword">option</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> supported <span class="hljs-keyword">by</span> <span class="hljs-keyword">all</span> ATA drives.<br><br>$ <span class="hljs-keyword">after</span> <span class="hljs-keyword">security</span>-erase<br>$ dd <span class="hljs-keyword">if</span>=/dev/sdx bs=<span class="hljs-number">8192</span> <span class="hljs-keyword">status</span>=progress | hexdump<br><span class="hljs-number">0000000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span> <span class="hljs-number">0000</span><br><br><span class="hljs-comment"># if your dev has locked</span><br>    <span class="hljs-keyword">locked</span><br><br><span class="hljs-comment">#unlock</span><br>$ hdparm <span class="hljs-comment">--user-master u --security-unlock p /dev/sdx</span><br><br><span class="hljs-comment">#disable security</span><br>$ hdparm <span class="hljs-comment">--user-master u --security-disable p /dev/sdx</span><br><br>$ hdparm -I /dev/sdx<br><span class="hljs-keyword">not</span>     enabled<br><span class="hljs-keyword">not</span>     <span class="hljs-keyword">locked</span><br><br><span class="hljs-comment">## hide Areas</span><br>$ hdparm -N /dev/sda<br><br>/dev/sda:<br> READ_NATIVE_MAX_ADDRESS_EXT <span class="hljs-keyword">failed</span>: <span class="hljs-keyword">Input</span>/<span class="hljs-keyword">output</span> <span class="hljs-keyword">error</span><br><br>$ hdparm -N /dev/sdd<br><br>/dev/sdd:<br> <span class="hljs-keyword">max</span> sectors   = <span class="hljs-number">3907029168</span>/<span class="hljs-number">3907029168</span>, HPA <span class="hljs-keyword">is</span> disabled<br><br><span class="hljs-comment">##</span><br><br>$ hdparm -N /dev/sdx<br><br>/dev/sdx:<br><span class="hljs-keyword">max</span> sectors   = <span class="hljs-number">78125000</span>/<span class="hljs-number">78165360</span>, HPA <span class="hljs-keyword">is</span> enabled<br><br>$ hdparm -N p78165360 /dev/sdx<br><br>/dev/sdx:<br>setting <span class="hljs-keyword">max</span> <span class="hljs-keyword">visible</span> sectors <span class="hljs-keyword">to</span> <span class="hljs-number">78165360</span> (<span class="hljs-keyword">permanent</span>)<br><span class="hljs-keyword">max</span> sectors   = <span class="hljs-number">78165360</span>/<span class="hljs-number">78165360</span>, HPA <span class="hljs-keyword">is</span> disabled<br><br>$ hdparm <span class="hljs-comment">--dco-identify /dev/sdx</span><br><br>/dev/sdx:<br>DCO Revision: <span class="hljs-number">0x0001</span><br>The <span class="hljs-keyword">following</span> features can be selectively disabled via DCO:<br>       Transfer modes:<br>                udma0 udma1 udma2 udma3 udma4 udma5<br>       <span class="hljs-built_in">Real</span> <span class="hljs-keyword">max</span> sectors: <span class="hljs-number">78165360</span><br>       ATA command/feature <span class="hljs-keyword">sets</span>:<br>                AAM HPA<br><br>$ hdparm <span class="hljs-comment">--dco-restore /dev/sdx</span><br><br>/dev/sdx:<br><span class="hljs-keyword">Use</span> <span class="hljs-keyword">of</span> <span class="hljs-comment">--dco-restore is VERY DANGEROUS.</span><br>You <span class="hljs-keyword">are</span> trying <span class="hljs-keyword">to</span> deliberately <span class="hljs-keyword">reset</span> your drive configuration back <span class="hljs-keyword">to</span><br>the factory defaults.<br>This may <span class="hljs-keyword">change</span> the apparent <span class="hljs-keyword">capacity</span> <span class="hljs-keyword">and</span> feature <span class="hljs-keyword">set</span> <span class="hljs-keyword">of</span> the drive,<br>making <span class="hljs-keyword">all</span> <span class="hljs-keyword">data</span> <span class="hljs-keyword">on</span> it inaccessible.<br>You could lose *everything*.<br>Please supply the <span class="hljs-comment">--yes-i-know-what-i-am-doing flag if you really want this.</span><br>Program aborted.<br><br>$ hdparm <span class="hljs-comment">--yes-i-know-what-i-am-doing --dco-restore /dev/sdx</span><br><br>/dev/sdx:<br>issuing DCO <span class="hljs-keyword">restore</span> command<br></code></pre></td></tr></table></figure>

<h3 id="Enable-SAS-SATA-dev-cache"><a href="#Enable-SAS-SATA-dev-cache" class="headerlink" title="Enable SAS/SATA dev cache"></a>Enable SAS/SATA dev cache</h3><h4 id="SAS-cache"><a href="#SAS-cache" class="headerlink" title="SAS cache"></a>SAS cache</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment">#simple way</span><br><span class="hljs-string">$</span> <span class="hljs-string">sdparm</span> <span class="hljs-string">-s</span> <span class="hljs-string">WCE=1,RCD=0</span> <span class="hljs-string">/dev/sdX</span><br><br><span class="hljs-string">Byte</span>  <span class="hljs-number">7</span>   <span class="hljs-number">6</span>    <span class="hljs-number">5</span>   <span class="hljs-number">4</span>    <span class="hljs-number">3</span>   <span class="hljs-number">2</span>   <span class="hljs-number">1</span>   <span class="hljs-number">0</span>               <span class="hljs-string">Default</span><br><span class="hljs-number">0</span>    <span class="hljs-string">ps</span> <span class="hljs-number">0</span>  <span class="hljs-string">page</span> <span class="hljs-string">code=08h</span>                             <span class="hljs-string">88h</span><br><span class="hljs-number">1</span>    <span class="hljs-string">page</span> <span class="hljs-string">length</span> <span class="hljs-string">=</span> <span class="hljs-string">12h</span>                               <span class="hljs-string">12h</span><br><span class="hljs-number">2</span>    <span class="hljs-string">ic</span> <span class="hljs-string">ABPF</span> <span class="hljs-string">CAP</span> <span class="hljs-string">DISC</span> <span class="hljs-string">SIZE</span> <span class="hljs-string">WCE</span> <span class="hljs-string">MF</span> <span class="hljs-string">RCD</span>                <span class="hljs-string">04h</span><br><br><span class="hljs-comment">#show detail</span><br><span class="hljs-string">$</span> <span class="hljs-string">sg_wr_mode</span> <span class="hljs-string">-p</span> <span class="hljs-number">0x8</span> <span class="hljs-string">/dev/sda</span><br><span class="hljs-string">&gt;&gt;&gt;</span> <span class="hljs-literal">No</span> <span class="hljs-string">contents</span> <span class="hljs-string">given,</span> <span class="hljs-attr">so show current mode page data:</span><br>  <span class="hljs-attr">header:</span><br><span class="hljs-number">00</span> <span class="hljs-number">22</span> <span class="hljs-number">00</span> <span class="hljs-number">10</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">08</span><br>  <span class="hljs-string">block</span> <span class="hljs-string">descriptor(s):</span><br><span class="hljs-string">ff</span> <span class="hljs-string">ff</span> <span class="hljs-string">ff</span> <span class="hljs-string">ff</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">02</span> <span class="hljs-number">00</span><br>  <span class="hljs-attr">mode page:</span><br><span class="hljs-number">88</span> <span class="hljs-number">12</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-string">ff</span> <span class="hljs-string">ff</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>  <span class="hljs-string">ff</span> <span class="hljs-string">ff</span> <span class="hljs-string">ff</span> <span class="hljs-string">ff</span> <span class="hljs-number">00</span> <span class="hljs-number">08</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><br><span class="hljs-comment">#Enable read and write cache</span><br><span class="hljs-string">$</span> <span class="hljs-string">sg_wr_mode</span> <span class="hljs-string">-p</span> <span class="hljs-number">0x8</span> <span class="hljs-string">/dev/sda</span><br><span class="hljs-string">&gt;&gt;&gt;</span> <span class="hljs-literal">No</span> <span class="hljs-string">contents</span> <span class="hljs-string">given,</span> <span class="hljs-attr">so show current mode page data:</span><br>  <span class="hljs-attr">header:</span><br><span class="hljs-number">00</span> <span class="hljs-number">22</span> <span class="hljs-number">00</span> <span class="hljs-number">10</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">08</span><br>  <span class="hljs-string">block</span> <span class="hljs-string">descriptor(s):</span><br><span class="hljs-string">ff</span> <span class="hljs-string">ff</span> <span class="hljs-string">ff</span> <span class="hljs-string">ff</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">02</span> <span class="hljs-number">00</span><br>  <span class="hljs-attr">mode page:</span><br><span class="hljs-number">88</span> <span class="hljs-number">12</span> <span class="hljs-number">04</span> <span class="hljs-number">00</span> <span class="hljs-string">ff</span> <span class="hljs-string">ff</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>  <span class="hljs-string">ff</span> <span class="hljs-string">ff</span> <span class="hljs-string">ff</span> <span class="hljs-string">ff</span> <span class="hljs-number">00</span> <span class="hljs-number">08</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><br><span class="hljs-comment">#Disable all</span><br><span class="hljs-string">$</span> <span class="hljs-string">sg_wr_mode</span> <span class="hljs-string">-p</span> <span class="hljs-number">0x8</span> <span class="hljs-string">/dev/sda</span><br><span class="hljs-string">&gt;&gt;&gt;</span> <span class="hljs-literal">No</span> <span class="hljs-string">contents</span> <span class="hljs-string">given,</span> <span class="hljs-attr">so show current mode page data:</span><br>  <span class="hljs-attr">header:</span><br><span class="hljs-number">00</span> <span class="hljs-number">22</span> <span class="hljs-number">00</span> <span class="hljs-number">10</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">08</span><br>  <span class="hljs-string">block</span> <span class="hljs-string">descriptor(s):</span><br><span class="hljs-string">ff</span> <span class="hljs-string">ff</span> <span class="hljs-string">ff</span> <span class="hljs-string">ff</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">02</span> <span class="hljs-number">00</span><br>  <span class="hljs-attr">mode page:</span><br><span class="hljs-number">88</span> <span class="hljs-number">12</span> <span class="hljs-number">05</span> <span class="hljs-number">00</span> <span class="hljs-string">ff</span> <span class="hljs-string">ff</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span>  <span class="hljs-string">ff</span> <span class="hljs-string">ff</span> <span class="hljs-string">ff</span> <span class="hljs-string">ff</span> <span class="hljs-number">00</span> <span class="hljs-number">08</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br><span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span><br></code></pre></td></tr></table></figure>


<h4 id="SATA-cache"><a href="#SATA-cache" class="headerlink" title="SATA cache"></a>SATA cache</h4><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">#simple way<br>$ hdparm -W1 /dev/sdc<br><br>#show detail<br>$ sg_sat_set_features --feature=<span class="hljs-number">2</span>h -v /dev/sdc #Enable write cache<br>    ATA pass-through(<span class="hljs-number">16</span>) cdb: <span class="hljs-number">85</span> <span class="hljs-number">06</span> <span class="hljs-number">0</span>c <span class="hljs-number">00</span> <span class="hljs-number">02</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> ef <span class="hljs-number">00</span><br>    <span class="hljs-number">85</span>      -     <span class="hljs-number">0x7429</span>   Commands <span class="hljs-keyword">and</span> feature sets supported <span class="hljs-keyword">or</span> enabled<br>   <span class="hljs-number">255</span>      -     <span class="hljs-number">0xe0a5</span>   Integrity word<br>   <span class="hljs-number">255</span>     <span class="hljs-number">15</span>:<span class="hljs-number">8</span>     <span class="hljs-number">0xe0</span>   Checksum<br><span class="hljs-number">0x7429</span>=<span class="hljs-number">111</span>,<span class="hljs-number">0100</span>,<span class="hljs-number">0010</span>,<span class="hljs-number">1001</span><br><br>$ sg_sat_set_features --feature=AAh -v /dev/sdc #after enable write cache, <span class="hljs-keyword">continue</span> to enabel read cahe<br>    ATA pass-through(<span class="hljs-number">16</span>) cdb: <span class="hljs-number">85</span> <span class="hljs-number">06</span> <span class="hljs-number">0</span>c <span class="hljs-number">00</span> aa <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> ef <span class="hljs-number">00</span><br>    <span class="hljs-number">85</span>      -     <span class="hljs-number">0x7469</span>   Commands <span class="hljs-keyword">and</span> feature sets supported <span class="hljs-keyword">or</span> enabled   <br>   <span class="hljs-number">255</span>      -     <span class="hljs-number">0xa0a5</span>   Integrity word<br>   <span class="hljs-number">255</span>     <span class="hljs-number">15</span>:<span class="hljs-number">8</span>     <span class="hljs-number">0xa0</span>   Checksum<br><span class="hljs-number">0x7469</span>=<span class="hljs-number">111</span>,<span class="hljs-number">0100</span>,<span class="hljs-number">0110</span>,<span class="hljs-number">1001</span><br>   <br>$ sg_sat_set_features --feature=<span class="hljs-number">55</span>h -v /dev/sdc #disable read cache<br>    ATA pass-through(<span class="hljs-number">16</span>) cdb: <span class="hljs-number">85</span> <span class="hljs-number">06</span> <span class="hljs-number">0</span>c <span class="hljs-number">00</span> <span class="hljs-number">55</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> ef <span class="hljs-number">00</span><br>    <span class="hljs-number">85</span>      -     <span class="hljs-number">0x7429</span>   Commands <span class="hljs-keyword">and</span> feature sets supported <span class="hljs-keyword">or</span> enabled<br>    <span class="hljs-number">85</span>      <span class="hljs-number">5</span>          <span class="hljs-number">1</span>   Write cache enabled  ## Here will <span class="hljs-built_in">auto</span> add a new line<br>   <span class="hljs-number">255</span>      -     <span class="hljs-number">0xe0a5</span>   Integrity word<br>   <span class="hljs-number">255</span>     <span class="hljs-number">15</span>:<span class="hljs-number">8</span>     <span class="hljs-number">0xe0</span>   Checksum<br><span class="hljs-number">0x7429</span>=<span class="hljs-number">111</span>,<span class="hljs-number">0100</span>,<span class="hljs-number">0010</span>,<span class="hljs-number">1001</span><br><br>$ sg_sat_set_features --feature=<span class="hljs-number">82</span>h -v /dev/sdc #after disable read cache, <span class="hljs-keyword">continue</span> to disable write cache<br>    ATA pass-through(<span class="hljs-number">16</span>) cdb: <span class="hljs-number">85</span> <span class="hljs-number">06</span> <span class="hljs-number">0</span>c <span class="hljs-number">00</span> <span class="hljs-number">82</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> <span class="hljs-number">00</span> ef <span class="hljs-number">00</span><br>    <span class="hljs-number">85</span>      -     <span class="hljs-number">0x7409</span>   Commands <span class="hljs-keyword">and</span> feature sets supported <span class="hljs-keyword">or</span> enabled<br>   <span class="hljs-number">255</span>      -     <span class="hljs-number">0x00a5</span>   Integrity word<br><span class="hljs-number">0x7409</span>=<span class="hljs-number">111</span>,<span class="hljs-number">0100</span>,<span class="hljs-number">0000</span>,<span class="hljs-number">1001</span><br></code></pre></td></tr></table></figure>
<p>Set Features (EFh)</p>
<table>
<thead>
<tr>
<th align="center">FUNCTION</th>
<th align="center">FEATURES REGISTER</th>
<th align="center">SECTOR COUNTREGISTER</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Enable read cache1</td>
<td align="center">AAh</td>
<td align="center">Don’t care</td>
</tr>
<tr>
<td align="center">Disable read cache1</td>
<td align="center">55h</td>
<td align="center">Don’t care</td>
</tr>
<tr>
<td align="center">Enable write cache1</td>
<td align="center">02h</td>
<td align="center">Don’t care</td>
</tr>
<tr>
<td align="center">Disable write cache1</td>
<td align="center">82h</td>
<td align="center">Don’t care</td>
</tr>
<tr>
<td align="center">Set Transfer Mode</td>
<td align="center">03h</td>
<td align="center">Don’t care</td>
</tr>
<tr>
<td align="center">Enable use of Serial ATA Feature</td>
<td align="center">10h</td>
<td align="center">02h-DMA Setup FIS Auto-Activate optimization 06h-Software Settings</td>
</tr>
<tr>
<td align="center">Disable use of Serial ATA Feature</td>
<td align="center">90h</td>
<td align="center">02h-DMA Setup FIS Auto-Activate optimization 06h-Software Settings</td>
</tr>
</tbody></table>
<p>Note: Changes are only valid while power remains applied to the drive. After power is cycled, the drive reverts to the<br>default settings.</p>
<p>Sends an ATA SET FEATURES command via a SAT pass through.<br>Primary feature code is placed in ‘–feature=FEA’ with ‘–count=CO’ and ‘–lba=LBA’ being auxiliaries for some features.  The arguments CO, FEA and LBA are decimal unless prefixed by ‘0x’ or have a trailing ‘h’.</p>
<h3 id="sector-size"><a href="#sector-size" class="headerlink" title="sector size"></a><a target="_blank" rel="noopener" href="http://people.redhat.com/msnitzer/docs/linux-advanced-storage-6.1.pdf">sector size</a></h3><h4 id="512e-SATA"><a href="#512e-SATA" class="headerlink" title="512e SATA"></a>512e SATA</h4><p>the first logical block does begin on a boundary aligned to the physical block size</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">...<br> 106      -     0x6003   Physical sector size / logical sector size<br> 106     15:14     0x1   Must be <span class="hljs-built_in">set</span> to 0x1<br> 106     13          1   Multiple logical sectors per physical sector<br> 106      3:0      0x3   2^X logical sectors per physical sector<br>...<br> 209      -     0x4000   Alignment of logical sectors<br> 209     15:14     0x1   Must be <span class="hljs-built_in">set</span> to 0x1<br><br>$ dc -e <span class="hljs-string">&#x27;16i2o0x6003p&#x27;</span><br>110000000000011<br>110,0000,0000,0011 &lt;- 2^3=8, 512 Bytes x 8 = 4096 Bytes (phy)<br> ^<br> |<br><span class="hljs-comment">#Word 106 bit 15 must be 0 and bit 14 must be 1. This signals that word 106 is valid. Bit 13 must be set to indicate that bits 3:0 are valid and that word 209 is specified.</span><br>first 110, I guess 0 means 3:0 are valid  and that word 209 is specified<br><br><span class="hljs-comment">#Bits 3:0 indicate the physical block size exponent. I.e. 2n logical blocks/physical block. For a drive with 4096-byte physical blocks and 512-byte logical blocks, a value of 3 is reported in bits 3:0 (23 = 8).</span><br><br>$ dc -e <span class="hljs-string">&#x27;16i2o0x4000p&#x27;</span><br>100000000000000<br>100,0000,0000,0000<br></code></pre></td></tr></table></figure>

<p>If the first logical block does <code>not</code> begin on a boundary aligned to the physical block size<br>word 209 should be reported by the device. Bit 15 must be zero, bit 14 must be 1. Bits 13:0 indicate the logical sector offset within the first physical sector where the first logical sector is placed.<br>For compatibility with legacy operating systems some vendors may align the blocks so that LBA 63 falls on a physical block boundary. In that case an alignment of 1 should be reported.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">### I have not reproduce this case</span><br>IDENTIFY DEVICE 106 0110 0000 0000 0011 0x6003<br>IDENTIFY DEVICE 209 0100 0000 0000 0001 0x4001<br></code></pre></td></tr></table></figure>

<h4 id="4KN"><a href="#4KN" class="headerlink" title="4KN"></a>4KN</h4><p>If a drive uses 4KiB logical and physical blocks, IDENTIFY DEVICE words 106, 117, and 118 must be specified.<br>Word 106 bit 15 must be 0 and bit 14 must be 1. This signals that word 106 is valid. Bit 12 must be set to indicate that words 117 and 118 are specified.<br>Word 117 (LSB) and 118 (MSB) specify the logical block size in words. </p>
<p>I.e. for a 4KiB drive that would be 2048.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">IDENTIFY DEVICE 106 0101 0000 0000 0000 0x5000<br>IDENTIFY DEVICE 117 0000 1000 0000 0000 0x0800 <span class="hljs-comment"># 2^11=2048=0x0800</span><br>IDENTIFY DEVICE 118 0000 0000 0000 0000 0x0000<br></code></pre></td></tr></table></figure>

<h4 id="Nominal-media-rotation-rate"><a href="#Nominal-media-rotation-rate" class="headerlink" title="Nominal media rotation rate"></a>Nominal media rotation rate</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">217      -     0x1c20   Nominal media rotation rate<br>$ dc -e <span class="hljs-string">&#x27;16i2o0x1c20p&#x27;</span><br>100000<br>10,0000<br><span class="hljs-comment"># why dell SATA HDD not be 0x1.</span><br>IDENTIFY DEVICE 217 0000 0000 0000 0001 0x0001<br></code></pre></td></tr></table></figure>
<p>If the storage device is non-rotational (i.e. SSD or array) word 217 of IDENTIFY DEVICE should be set to one. The I/O scheduler may then be less agressive in terms of seek avoidance. Any other value reported in 217 will be ignored.</p>
<h3 id="Does-devices-support-the-scsi-Persistent-Reservation"><a href="#Does-devices-support-the-scsi-Persistent-Reservation" class="headerlink" title="Does devices support the scsi-Persistent-Reservation"></a>Does devices support the scsi-Persistent-Reservation</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sg_persist -c /dev/sdi<br>  ATA       HGST HUH721010AL  LT14<br>  Peripheral device <span class="hljs-built_in">type</span>: disk<br>PR <span class="hljs-keyword">in</span> (Report capabilities): <span class="hljs-built_in">command</span> not supported<br>sg_persist failed: Illegal request, Invalid opcode<br><br>$ sg_persist -c /dev/sdj<br>  HGST      HUH721010AL5200   LS14<br>  Peripheral device <span class="hljs-built_in">type</span>: disk<br>Report capabilities response:<br>  Replace Lost Reservation Capable(RLR_C): 0<br>  Compatible Reservation Handling(CRH): 0<br>  Specify Initiator Ports Capable(SIP_C): 1<br>  All Target Ports Capable(ATP_C): 1<br>  Persist Through Power Loss Capable(PTPL_C): 1<br>  Type Mask Valid(TMV): 1<br>  Allow Commands: 0<br>  Persist Through Power Loss Active(PTPL_A): 0<br>    Support indicated <span class="hljs-keyword">in</span> Type mask:<br>      Write Exclusive, all registrants: 0<br>      Exclusive Access, registrants only: 1<br>      Write Exclusive, registrants only: 1<br>      Exclusive Access: 1<br>      Write Exclusive: 1<br>      Exclusive Access, all registrants: 0<br><br>A: [1:0:14:0]   disk    HP       MK0800JVYPQ      HPD6  /dev/sdo   35001173d028c863c  /dev/sg16<br>B: [1:0:14:0]   disk    HP       MK0800JVYPQ      HPD6  /dev/sdo   35001173d028c863c  /dev/sg16<br><br>$ sg_persist --read-keys /dev/sdo<br>  HP        MK0800JVYPQ       HPD6<br>  Peripheral device <span class="hljs-built_in">type</span>: disk<br>  PR generation=0x0, there are NO registered reservation keys<br>$ sg_persist --read-reservation /dev/sdo<br>  HP        MK0800JVYPQ       HPD6<br>  Peripheral device <span class="hljs-built_in">type</span>: disk<br>  PR generation=0x0, there is NO reservation held<br>$ sg_persist /dev/sdo<br>&gt;&gt; No service action given; assume Persistent Reserve In <span class="hljs-built_in">command</span><br>&gt;&gt; with Read Keys service action<br>  HP        MK0800JVYPQ       HPD6<br>  Peripheral device <span class="hljs-built_in">type</span>: disk<br>  PR generation=0x0, there are NO registered reservation keys<br>$ sg_persist -n -i -r -d /dev/sdo<br>  PR generation=0x0, there is NO reservation held<br></code></pre></td></tr></table></figure>

<h4 id="Add-it-to-multipath-test-in-HUS-150-worked"><a href="#Add-it-to-multipath-test-in-HUS-150-worked" class="headerlink" title="Add it to multipath, test in HUS 150, worked"></a>Add it to multipath, test in HUS 150, worked</h4><p>mulitpath just for little device, not for software raid solution</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">no_path_retry queue<br>features <span class="hljs-string">&quot;0&quot;</span><br></code></pre></td></tr></table></figure>

<h3 id="Because-brain-split-zfs-will-corrupt"><a href="#Because-brain-split-zfs-will-corrupt" class="headerlink" title="Because brain-split, zfs will corrupt"></a>Because brain-split, zfs will corrupt</h3><p>process<br>register -&gt; reserve -&gt; preempt-abort -&gt; re-register another node</p>
<h4 id="Register"><a href="#Register" class="headerlink" title="Register"></a>Register</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># register</span><br>A $ openssl rand -hex 4<br>f089a155<br>A $ sg_persist --out --register --param-sark=f089a155 -d /dev/sdo<br>  HP        MK0800JVYPQ       HPD6<br>  Peripheral device <span class="hljs-built_in">type</span>: disk<br>A $ sg_persist --read-keys /dev/sdo<br>  HP        MK0800JVYPQ       HPD6<br>  Peripheral device <span class="hljs-built_in">type</span>: disk<br>  PR generation=0x7, 1 registered reservation key follows:<br>    0xf089a155<br></code></pre></td></tr></table></figure>

<h4 id="Reserve"><a href="#Reserve" class="headerlink" title="Reserve"></a>Reserve</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">A</span> $ sg_persist --out --reserve --param-rk=f<span class="hljs-number">089</span>a<span class="hljs-number">155</span> --prout-type=<span class="hljs-number">1</span> /dev/sdo<br>  <span class="hljs-attribute">HP</span>        MK<span class="hljs-number">0800</span>JVYPQ       HPD<span class="hljs-number">6</span><br>  <span class="hljs-attribute">Peripheral</span> device type: disk<br><br><span class="hljs-attribute">B</span> $ sg_persist --read-keys /dev/sdo<br>  <span class="hljs-attribute">HP</span>        MK<span class="hljs-number">0800</span>JVYPQ       HPD<span class="hljs-number">6</span><br>  <span class="hljs-attribute">Peripheral</span> device type: disk<br>  <span class="hljs-attribute">PR</span> generation=<span class="hljs-number">0</span>xd, <span class="hljs-number">1</span> registered reservation key follows:<br>    <span class="hljs-attribute">0xf089a155</span><br><br><span class="hljs-attribute">B</span> $ sg_persist --read-reservation /dev/sdo<br>  <span class="hljs-attribute">HP</span>        MK<span class="hljs-number">0800</span>JVYPQ       HPD<span class="hljs-number">6</span><br>  <span class="hljs-attribute">Peripheral</span> device type: disk<br>  <span class="hljs-attribute">PR</span> generation=<span class="hljs-number">0</span>xd, Reservation follows:<br>    <span class="hljs-attribute">Key</span>=<span class="hljs-number">0</span>xf<span class="hljs-number">089</span>a<span class="hljs-number">155</span><br>    <span class="hljs-attribute">scope</span>: LU_SCOPE,  type: Write Exclusive<br><br><span class="hljs-attribute">A</span> $ dd if=/dev/zero of=/dev/sdo bs=<span class="hljs-number">1</span>M count=<span class="hljs-number">10</span> oflag=sync<br><span class="hljs-attribute">10</span>+<span class="hljs-number">0</span> records in<br><span class="hljs-attribute">10</span>+<span class="hljs-number">0</span> records out<br><span class="hljs-attribute">10485760</span> bytes (<span class="hljs-number">10</span> MB) copied, <span class="hljs-number">0</span>.<span class="hljs-number">0191827</span> s, <span class="hljs-number">547</span> MB/s<br><br><span class="hljs-attribute">B</span> $ dd if=/dev/zero of=/dev/mapper/<span class="hljs-number">35000</span>cca<span class="hljs-number">2515</span>f<span class="hljs-number">34</span>c<span class="hljs-number">4</span> bs=<span class="hljs-number">1</span>M count=<span class="hljs-number">10</span> oflag=sync<br><span class="hljs-attribute">dd</span>: error writing ‘/dev/sdo’: Input/output error<br><span class="hljs-attribute">1</span>+<span class="hljs-number">0</span> records in<br><span class="hljs-attribute">0</span>+<span class="hljs-number">0</span> records out<br><span class="hljs-attribute">0</span> bytes (<span class="hljs-number">0</span> B) copied, <span class="hljs-number">0</span>.<span class="hljs-number">618006</span> s, <span class="hljs-number">0</span>.<span class="hljs-number">0</span> kB/s<br></code></pre></td></tr></table></figure>

<h4 id="Server-B-preempt-the-reservation"><a href="#Server-B-preempt-the-reservation" class="headerlink" title="Server B preempt the reservation"></a>Server B preempt the reservation</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs bash">B $ openssl rand -hex 4<br>f7ec3033<br>B $ sg_persist --read-keys /dev/sdo<br>  HP        MK0800JVYPQ       HPD6<br>  Peripheral device <span class="hljs-built_in">type</span>: disk<br>  PR generation=0x1, 1 registered reservation key follows:<br>    0xf089a155<br><br>B $ sg_persist --out --register --param-sark=f7ec3033 -d /dev/sdo<br>B $ sg_persist --read-keys /dev/sdo<br>  HP        MK0800JVYPQ       HPD6<br>  Peripheral device <span class="hljs-built_in">type</span>: disk<br>  PR generation=0xa, 2 registered reservation keys follow:<br>    0xf089a155<br>    0xf7ec3033<br><br>B $ sg_persist --read-reservation /dev/sdo<br>  HP        MK0800JVYPQ       HPD6<br>  Peripheral device <span class="hljs-built_in">type</span>: disk<br>  PR generation=0xa, Reservation follows:<br>    Key=0xf089a155<br>    scope: LU_SCOPE,  <span class="hljs-built_in">type</span>: Write Exclusive<br><br><br>B $ sg_persist -n -o -A -K f7ec3033 -S f089a155  -T 1 -v -d /dev/sdo<br>    Persistent Reservation Out cmd: 5f 05 01 00 00 00 00 00 18 00<br>PR out: <span class="hljs-built_in">command</span> (Preempt and abort) successful<br><br>B $ sg_persist --read-reservation -d /dev/sdo<span class="hljs-string">&quot;</span><br><span class="hljs-string">  HP        MK0800JVYPQ       HPD6</span><br><span class="hljs-string">  Peripheral device type: disk</span><br><span class="hljs-string">  PR generation=0xf, Reservation follows:</span><br><span class="hljs-string">    Key=0xf7ec3033</span><br><span class="hljs-string">    scope: LU_SCOPE,  type: Write Exclusive</span><br><span class="hljs-string"></span><br><span class="hljs-string">A $ dd if=/dev/zero of=/dev/sdo bs=1M count=10 oflag=sync</span><br><span class="hljs-string">dd: error writing ‘/dev/sdo’: Input/output error</span><br><span class="hljs-string">1+0 records in</span><br><span class="hljs-string">0+0 records out</span><br><span class="hljs-string">0 bytes (0 B) copied, 0.617521 s, 0.0 kB/s</span><br><span class="hljs-string"></span><br><span class="hljs-string">B $ dd if=/dev/zero of=/dev/sdo bs=1M count=10 oflag=sync</span><br><span class="hljs-string">10+0 records in</span><br><span class="hljs-string">10+0 records out</span><br><span class="hljs-string">10485760 bytes (10 MB) copied, 0.0212361 s, 494 MB/s</span><br><span class="hljs-string"></span><br><span class="hljs-string">### if you input wrong -K and -S value, it will return error</span><br><span class="hljs-string">B $ sg_persist -n -o -A -d /dev/sdo -K f7ec3zzz -S f08fsd55  -T 1 -v</span><br><span class="hljs-string">    Persistent Reservation Out cmd: 5f 05 01 00 00 00 00 00 18 00</span><br><span class="hljs-string">    persistent reserve out: scsi status: Reservation Conflict</span><br><span class="hljs-string">    PR out: command failed</span><br></code></pre></td></tr></table></figure>

<h4 id="After-preempt-abort-Server-A-preempt-the-reservation"><a href="#After-preempt-abort-Server-A-preempt-the-reservation" class="headerlink" title="After preempt-abort, Server A preempt the reservation"></a>After preempt-abort, Server A preempt the reservation</h4><p>Need to be register again</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs bash">A $ sg_persist --read-keys /dev/sdo<span class="hljs-string">&quot;</span><br><span class="hljs-string">  HP        MK0800JVYPQ       HPD6</span><br><span class="hljs-string">  Peripheral device type: disk</span><br><span class="hljs-string">  PR generation=0xf, 1 registered reservation key follows:</span><br><span class="hljs-string">    0xf7ec3033</span><br><span class="hljs-string">A $ sg_persist --out --register --param-sark=f089a155 -d /dev/sdo</span><br><span class="hljs-string">  HP        MK0800JVYPQ       HPD6</span><br><span class="hljs-string">  Peripheral device type: disk</span><br><span class="hljs-string"></span><br><span class="hljs-string">A $ sg_persist --read-keys /dev/sdo</span><br><span class="hljs-string">  HP        MK0800JVYPQ       HPD6</span><br><span class="hljs-string">  Peripheral device type: disk</span><br><span class="hljs-string">  PR generation=0x10, 2 registered reservation keys follow:</span><br><span class="hljs-string">    0xf089a155</span><br><span class="hljs-string">    0xf7ec3033</span><br><span class="hljs-string"></span><br><span class="hljs-string">A $ sg_persist -n -o -A -K f089a155 -S f7ec3033  -T 1 -v -d /dev/sdo</span><br><span class="hljs-string">    Persistent Reservation Out cmd: 5f 05 01 00 00 00 00 00 18 00</span><br><span class="hljs-string">PR out: command (Preempt and abort) successful</span><br><span class="hljs-string"></span><br><span class="hljs-string">A $ sg_persist --read-reservation /dev/sdo</span><br><span class="hljs-string">  HP        MK0800JVYPQ       HPD6</span><br><span class="hljs-string">  Peripheral device type: disk</span><br><span class="hljs-string">  PR generation=0x11, Reservation follows:</span><br><span class="hljs-string">    Key=0xf089a155</span><br><span class="hljs-string">    scope: LU_SCOPE,  type: Write Exclusive</span><br><span class="hljs-string"></span><br><span class="hljs-string">A $ dd if=/dev/zero of=/dev/sdo bs=1M count=10 oflag=sync</span><br><span class="hljs-string">10+0 records in</span><br><span class="hljs-string">10+0 records out</span><br><span class="hljs-string">10485760 bytes (10 MB) copied, 0.0188563 s, 556 MB/s</span><br><span class="hljs-string"></span><br><span class="hljs-string">B $ dd if=/dev/zero of=/dev/sdo bs=1M count=10 oflag=sync&quot;</span><br>dd: error writing ‘/dev/sdo’: Input/output error<br>1+0 records <span class="hljs-keyword">in</span><br>0+0 records out<br>0 bytes (0 B) copied, 0.744081 s, 0.0 kB/s<br></code></pre></td></tr></table></figure>

<h4 id="Prout-type"><a href="#Prout-type" class="headerlink" title="Prout-type"></a>Prout-type</h4><p>1-&gt; write exclusive<br>3-&gt; exclusive access<br>5-&gt; write exclusive - registrants only<br>6-&gt; exclusive access - registrants only<br>7-&gt; write exclusive - all registrants<br>8-&gt; exclusive access - all registrants</p>
<h4 id="Release-reservation"><a href="#Release-reservation" class="headerlink" title="Release reservation"></a>Release reservation</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sg_persist --out --release -K f089a155 --prout-type=1 /dev/sdo<br>  HP        MK0800JVYPQ       HPD6<br>  Peripheral device <span class="hljs-built_in">type</span>: disk<br><br>$ sg_persist --<span class="hljs-keyword">in</span> -r --no-inquiry -d /dev/sdo<br>  PR generation=0x5f, there is NO reservation held<br><br>$ sg_persist --read-reservation /dev/sdo<br>  HP        MK0800JVYPQ       HPD6<br>  Peripheral device <span class="hljs-built_in">type</span>: disk<br>  PR generation=0x11, there is NO reservation held<br></code></pre></td></tr></table></figure>

<h4 id="Unregister-key"><a href="#Unregister-key" class="headerlink" title="Unregister key"></a>Unregister key</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">A $ sg_persist --out --register -K f089a155 -d /dev/sdo<br>  HGST      HUH721010AL5200   A21D<br>  Peripheral device <span class="hljs-built_in">type</span>: disk<br>A $ sg_persist --<span class="hljs-keyword">in</span> -k --no-inquiry -d /dev/sdo<br>  PR generation=0x60, there are NO registered reservation keys<br></code></pre></td></tr></table></figure>

<h4 id="Force-mode"><a href="#Force-mode" class="headerlink" title="Force mode ?"></a>Force mode ?</h4><p>It releases the persistent reservation (if any) and clears all registrations from the device</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">A $ sg_persist --out --clear -K f089a155 /dev/sdo<br></code></pre></td></tr></table></figure>

<h4 id="After-A-and-B-reboot-the-reservation-worked"><a href="#After-A-and-B-reboot-the-reservation-worked" class="headerlink" title="After A and B reboot, the reservation worked"></a>After A and B reboot, the reservation worked</h4><h4 id="Plugin-it-to-another-JBOD-all-key-reservation-will-missing"><a href="#Plugin-it-to-another-JBOD-all-key-reservation-will-missing" class="headerlink" title="Plugin it to another JBOD, all key, reservation will missing"></a>Plugin it to another JBOD, all key, reservation will missing</h4><pre><code>   -Z, --param-aptpl
          set  the &#39;activate persist through power loss&#39; (APTPL) flag in the parameter block of the PROUT command. Relevant for &#39;regis‐
          ter&#39;, &#39;register and ignore existing key&#39; and &#39;register and move&#39; sub-commands.</code></pre>
<p><a target="_blank" rel="noopener" href="http://scsi3pr.blogspot.com/2010/11/scsi-3-persistent-group-reservation.html">SCSI-3 Persistent Group Reservation</a><br><a target="_blank" rel="noopener" href="https://dhelios.blogspot.com/2015/04/how-can-i-view-create-and-remove-scsi.html">How can I view create and remove scsi</a><br><a target="_blank" rel="noopener" href="http://lkml.iu.edu/hypermail/linux/kernel/0903.3/02074.html">Target_Core_Mod</a><br><a target="_blank" rel="noopener" href="https://lists.wpkg.org/pipermail/stgt/2010-October/017304.html">Support for persistent reservations</a><br><a target="_blank" rel="noopener" href="https://assets.cdn.sap.com/sapcom/docs/2016/06/84ea994f-767c-0010-82c7-eda71af511fa.pdf">SAP HANA Fiber Channel Storage Connector Admin Guide</a><br><a target="_blank" rel="noopener" href="http://scsi3pr.blogspot.com/2010/11/scsi-3-persistent-group-reservation.html">When to use SCSI-3 Persistent Group Reservation</a></p>
<h3 id="NVME-persist-reservation"><a href="#NVME-persist-reservation" class="headerlink" title="NVME persist reservation"></a><a target="_blank" rel="noopener" href="https://blogs.vmware.com/virtualblocks/2018/08/20/nvme-over-fabrics-part-two/">NVME persist reservation</a></h3><h3 id="the-others-sg-tools"><a href="#the-others-sg-tools" class="headerlink" title="the others sg tools"></a>the others sg tools</h3><h4 id="sg-readcap"><a href="#sg-readcap" class="headerlink" title="sg_readcap"></a>sg_readcap</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sg_readcap -l /dev/sdc<br>Read Capacity results:<br>   Protection: prot_en=0, p_type=0, p_i_exponent=0<br>   Thin provisioning: tpe=0, tprz=0<br>   Last logical block address=15628053167 (0x3a3812aaf), Number of logical blocks=15628053168<br>   Logical block length=512 bytes<br>   Logical blocks per physical block exponent=3<br>   Lowest aligned logical block address=0<br>Hence:<br>   Device size: 8001563222016 bytes, 7630885.3 MiB, 8001.56 GB<br></code></pre></td></tr></table></figure>

<h4 id="sginfo"><a href="#sginfo" class="headerlink" title="sginfo"></a>sginfo</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ $ sginfo -e /dev/sdg<br>Read-Write Error Recovery mode page (0x1)<br>-----------------------------------------<br>AWRE                               1<br>ARRE                               0<br>TB                                 0<br>RC                                 0<br>EER                                0<br>PER                                0<br>DTE                                0<br>DCR                                0<br>Read Retry Count                   0<br>Correction Span                    0<br>Head Offset Count                  0<br>Data Strobe Offset Count           0<br>Write Retry Count                  0<br>Recovery Time Limit (ms)           0<br><br>$ sginfo -f /dev/sdg<br>Format Device mode page (0x3)<br>-----------------------------<br>Tracks per Zone                    128<br>Alternate sectors per zone         0<br>Alternate tracks per zone          0<br>Alternate tracks per lu            0<br>Sectors per track                  128<br>Data bytes per physical sector     512<br>Interleave                         0<br>Track skew factor                  1<br>Cylinder skew factor               0<br>Supports Soft Sectoring            0<br>Supports Hard Sectoring            1<br>Removable Medium                   0<br>Surface                            0<br><br>$ sginfo -d /dev/sdg<br>INQUIRY response (cmd: 0x12)<br>----------------------------<br>Device Type                        0<br>Vendor:                    ATA<br>Product:                   HGST HUH721010AL<br>Revision level:            LT14<br><br>&gt;&gt;&gt; Unable to <span class="hljs-built_in">read</span> primary (PLIST) defect data.<br>&gt;&gt;&gt; Unable to <span class="hljs-built_in">read</span> grown (GLIST) defect data.<br><br>$ sginfo -c /dev/sdg<br>Caching mode page (0x8)<br>-----------------------<br>Initiator Control                  0<br>ABPF                               0<br>CAP                                0<br>DISC                               0<br>SIZE                               0<br>Write Cache Enabled                1<br>MF                                 0<br>Read Cache Disabled                0<br>Demand Read Retention Priority     0<br>Demand Write Retention Priority    0<br>Disable Pre-fetch Transfer Length  0<br>Minimum Pre-fetch                  0<br>Maximum Pre-fetch                  0<br>Maximum Pre-fetch Ceiling          0<br>FSW                                0<br>LBCSS                              0<br>DRA                                0<br>NV_DIS                             0<br>Number of Cache Segments           0<br>Cache Segment size                 0<br>Non-Cache Segment size             0<br>``` <br><br><span class="hljs-comment">#### sg_logs</span><br>```bash<br>$ sg_logs -q /dev/sdj<br>    HGST      HUH721010AL5200   LS14<br>Supported <span class="hljs-built_in">log</span> pages  [0x0]:<br>    0x00        Supported <span class="hljs-built_in">log</span> pages [sp]<br>    0x02        Write error [we]<br>    0x03        Read error [re]<br>    0x05        Verify error [ve]<br>    0x06        Non medium [nm]<br>    0x08        Format status [fs]<br>    0x0d        Temperature [temp]<br>    0x0e        Start-stop cycle counter [sscc]<br>    0x0f        Application client [ac]<br>    0x10        Self <span class="hljs-built_in">test</span> results [str]<br>    0x15        Background scan results [bsr]<br>    0x18        Protocol specific port [psp]<br>    0x19        General Statistics and Performance [gsp]<br>    0x1a        Power condition transitions [pct]<br>    0x2f        Informational exceptions [ie]<br>    0x30        Performance counters (Hitachi) [pc_hi]<br>    0x37        Cache (seagate) [c_se]<br><br>$ sg_logs -p 0x18 /dev/sdj<br>    HGST      HUH721010AL5200   LS14<br>Protocol Specific port page <span class="hljs-keyword">for</span> SAS SSP  (sas-2) [0x18]<br>relative target port id = 1<br>  generation code = 2<br>  number of phys = 1<br>  phy identifier = 0<br>    attached device <span class="hljs-built_in">type</span>: expander device<br>    attached reason: SMP phy control <span class="hljs-keyword">function</span><br>    reason: unknown<br>    negotiated logical link rate: 12 Gbps<br>    attached initiator port: ssp=0 stp=0 smp=0<br>    attached target port: ssp=0 stp=0 smp=1<br>    SAS address = 0x5000cca26c1b8631<br>    attached SAS address = 0x500056b3787358ff<br>    attached phy identifier = 9<br>    Invalid DWORD count = 0<br>    Running disparity error count = 0<br>    Loss of DWORD synchronization = 0<br>    Phy reset problem = 0<br>    Phy event descriptors:<br>     Invalid word count: 0<br>     Running disparity error count: 0<br>     Loss of dword synchronization count: 0<br>     Phy reset problem count: 0<br>relative target port id = 2<br>  generation code = 2<br>  number of phys = 1<br>  phy identifier = 1<br>    attached device <span class="hljs-built_in">type</span>: no device attached<br>    attached reason: unknown<br>    reason: power on<br>    negotiated logical link rate: phy enabled; unknown reason<br>    attached initiator port: ssp=0 stp=0 smp=0<br>    attached target port: ssp=0 stp=0 smp=0<br>    SAS address = 0x5000cca26c1b8632<br>    attached SAS address = 0x0<br>    attached phy identifier = 0<br>    Invalid DWORD count = 0<br>    Running disparity error count = 0<br>    Loss of DWORD synchronization = 0<br>    Phy reset problem = 0<br>    Phy event descriptors:<br>     Invalid word count: 0<br>     Running disparity error count: 0<br>     Loss of dword synchronization count: 0<br>     Phy reset problem count: 0<br><br><span class="hljs-comment">#write err</span><br>$ sg_logs -p 0x02 /dev/sdj<br>    HGST      HUH721010AL5200   LS14<br>Write error counter page  [0x2]<br>  Errors corrected without substantial delay = 0<br>  Errors corrected with possible delays = 0<br>  Total rewrites or rereads = 0<br>  Total errors corrected = 1<br>  Total <span class="hljs-built_in">times</span> correction algorithm processed = 404822<br>  Total bytes processed = 35127905470928<br>  Total uncorrected errors = 0<br><br><span class="hljs-comment">#read err</span><br>$ sg_logs -p 0x03 /dev/sdj<br>    HGST      HUH721010AL5200   LS14<br>Read error counter page  [0x3]<br>  Errors corrected without substantial delay = 0<br>  Errors corrected with possible delays = 0<br>  Total rewrites or rereads = 0<br>  Total errors corrected = 0<br>  Total <span class="hljs-built_in">times</span> correction algorithm processed = 1350903<br>  Total bytes processed = 49018892496048<br>  Total uncorrected errors = 0<br>$ sg_logs -p 0x05 /dev/sdj<br>    HGST      HUH721010AL5200   LS14<br>Verify error counter page  [0x5]<br>  Errors corrected without substantial delay = 0<br>  Errors corrected with possible delays = 0<br>  Total rewrites or rereads = 0<br>  Total errors corrected = 0<br>  Total <span class="hljs-built_in">times</span> correction algorithm processed = 5154<br>  Total bytes processed = 101563105280<br>  Total uncorrected errors = 0<br>$ sg_logs -p 0x06 /dev/sdj<br>    HGST      HUH721010AL5200   LS14<br>Non-medium error page  [0x6]<br>  Non-medium error count = 0<br><br><span class="hljs-comment">## the &quot;Total errors corrected&quot; has the a lot of growth in some of issue seagate HDDs</span><br><br>$ sg_logs -p 0x08 /dev/sdj<br>    HGST      HUH721010AL5200   LS14<br>Format status page  [0x8]<br>  Format data out:<br> 00     00 02 00 00                                         ....<br>  Grown defects during certification = 0<br>  Total blocks reassigned during format = 0<br>  Total new blocks reassigned = 0<br>  Power on minutes since format = 10647<br><br>$ sg_logs -p 0x1a /dev/sdj<br>    HGST      HUH721010AL5200   LS14<br>Power condition transitions page  [0x1a]<br>  Accumulated transitions to active = 700283<br>  Accumulated transitions to idle_a = 698441<br>  Accumulated transitions to idle_b = 1855<br>  Accumulated transitions to idle_c = 0<br>  Accumulated transitions to standby_z = 0<br>  Accumulated transitions to standby_y = 0<br><br>$ sg_logs -p 0x2f /dev/sdj<br>    HGST      HUH721010AL5200   LS14<br>Informational Exceptions page  [0x2f]<br>  IE asc = 0x0, ascq = 0x0<br>    Current temperature = 29 C<br>    Threshold temperature = 85 C  [common extension]<br>  parameter code = 0x1, contents <span class="hljs-keyword">in</span> hex:<br> 00     00 01 03 03 64 64 19<br></code></pre></td></tr></table></figure>

<h4 id="sg-senddiag"><a href="#sg-senddiag" class="headerlink" title="sg_senddiag"></a>sg_senddiag</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs routeros">sg_senddiag -l /dev/sg18<br>Supported diagnostic pages response:<br>  0x00  Supported diagnostic pages<br>  0x3f  Protocol specific (SAS transport)<br>  0x40  Translate<span class="hljs-built_in"> address </span>(direct access)<br>  0xdf  &lt;unknown&gt;<br></code></pre></td></tr></table></figure>

<h4 id="sg-inq"><a href="#sg-inq" class="headerlink" title="sg_inq"></a>sg_inq</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sg_inq -d /dev/sdj<br>standard INQUIRY:<br>  PQual=0  Device_type=0  RMB=0  LU_CONG=0  version=0x06  [SPC-4]<br>  [AERC=0]  [TrmTsk=0]  NormACA=0  HiSUP=1  Resp_data_format=2<br>  SCCS=0  ACC=0  TPGS=0  3PC=0  Protect=1  [BQue=0]<br>  EncServ=0  MultiP=1 (VS=0)  [MChngr=0]  [ACKREQQ=0]  Addr16=0<br>  [RelAdr=0]  WBus16=0  Sync=0  [Linked=0]  [TranDis=0]  CmdQue=1<br>  [SPI: Clocking=0x0  QAS=0  IUS=0]<br>    length=164 (0xa4)   Peripheral device <span class="hljs-built_in">type</span>: disk<br> Vendor identification: HGST<br> Product identification: HUH721010AL5200<br> Product revision level: LS14<br> Unit serial number: 1DGH47ZZ<br><br>$ sg_inq -e /dev/sdj<br>VPD INQUIRY, page code=0x00:<br>   Supported VPD pages:<br>     0x0        Supported VPD pages<br>     0x3<br>     0x80       Unit serial number<br>     0x83       Device identification<br>     0x86       Extended INQUIRY data<br>     0x87       Mode page policy<br>     0x88       SCSI ports<br>     0x8a       Power condition<br>     0x8d       Power consumption<br>     0x90       Protocol-specific logical unit information<br>     0x91       Protocol-specific port information<br>     0xb0       Block limits (sbc2)<br>     0xb1       Block device characteristics (sbc3)<br>     0xb2       Logical block provisioning (sbc3)<br>     0xd1<br>     0xd2<br>     0xdc<br><br>$ sg_vpd /dev/sdj<br>Supported VPD pages VPD page:<br>  Supported VPD pages [sv]<br>  0x3<br>  Unit serial number [sn]<br>  Device identification [di]<br>  Extended inquiry data [ei]<br>  Mode page policy [mpp]<br>  SCSI ports [sp]<br>  Power condition [pc]<br>  Power consumption [psm]<br>  Protocol-specific logical unit information [pslu]<br>  Protocol-specific port information [pspo]<br>  Block limits (SBC) [bl]<br>  Block device characteristics (SBC) [bdc]<br>  Logical block provisioning (SBC) [lbpv]<br>  0xd1<br>  0xd2<br>  0xdc<br><br>$ sg_vpd --page=xx /dev/sdj<br>abbreviation doesn<span class="hljs-string">&#x27;t match a VPD page</span><br><span class="hljs-string">Available standard VPD pages:</span><br><span class="hljs-string">  ai         0x89      ATA information (SAT)</span><br><span class="hljs-string">  aod        0x82      ASCII implemented operating definition (obsolete)</span><br><span class="hljs-string">  adsn       0xb3      Automation device serial number (SSC)</span><br><span class="hljs-string">  bl         0xb0      Block limits (SBC)</span><br><span class="hljs-string">  ble        0xb7      Block limits extension (SBC)</span><br><span class="hljs-string">  bdc        0xb1      Block device characteristics (SBC)</span><br><span class="hljs-string">  bdce       0xb5      Block device characteristics extension (SBC)</span><br><span class="hljs-string">  cfa        0x8c      CFA profile information</span><br><span class="hljs-string">  dc         0x8b      Device constituents</span><br><span class="hljs-string">  di         0x83      Device identification</span><br><span class="hljs-string">  di_asis    0x83      Like &#x27;</span>di<span class="hljs-string">&#x27; but designators ordered as found</span><br><span class="hljs-string">  di_lu      0x83      Device identification, lu only</span><br><span class="hljs-string">  di_port    0x83      Device identification, target port only</span><br><span class="hljs-string">  di_target  0x83      Device identification, target device only</span><br><span class="hljs-string">  dtde       0xb4      Data transfer device element address (SSC)</span><br><span class="hljs-string">  ei         0x86      Extended inquiry data</span><br><span class="hljs-string">  iod        0x81      Implemented operating definition (obsolete)</span><br><span class="hljs-string">  lbpro      0xb5      Logical block protection (SSC)</span><br><span class="hljs-string">  lbpv       0xb2      Logical block provisioning (SBC)</span><br><span class="hljs-string">  mas        0xb1      Manufacturer assigned serial number (SSC)</span><br><span class="hljs-string">  masa       0xb1      Manufacturer assigned serial number (ADC)</span><br><span class="hljs-string">  mna        0x85      Management network addresses</span><br><span class="hljs-string">  mpp        0x87      Mode page policy</span><br><span class="hljs-string">  oi         0xb0      OSD information</span><br><span class="hljs-string">  pc         0x8a      Power condition</span><br><span class="hljs-string">  psm        0x8d      Power consumption</span><br><span class="hljs-string">  pslu       0x90      Protocol-specific logical unit information</span><br><span class="hljs-string">  pspo       0x91      Protocol-specific port information</span><br><span class="hljs-string">  ref        0xb3      Referrals (SBC)</span><br><span class="hljs-string">  sad        0xb0      Sequential access device capabilities (SSC)</span><br><span class="hljs-string">  sbl        0xb4      Supported block lengths and protection types (SBC)</span><br><span class="hljs-string">  sfs        0x92      SCSI feature sets</span><br><span class="hljs-string">  sii        0x84      Software interface identification</span><br><span class="hljs-string">  sinq       -1        Standard inquiry response</span><br><span class="hljs-string">  sn         0x80      Unit serial number</span><br><span class="hljs-string">  sp         0x88      SCSI ports</span><br><span class="hljs-string">  st         0xb1      Security token (OSD)</span><br><span class="hljs-string">  sv         0x00      Supported VPD pages</span><br><span class="hljs-string">  tas        0xb2      TapeAlert supported flags (SSC)</span><br><span class="hljs-string">  tpc        0x8f      Third party copy</span><br><span class="hljs-string">  zbdc       0xb6      Zoned block device characteristics</span><br><span class="hljs-string"></span><br><span class="hljs-string">Vendor/product identifiers:</span><br><span class="hljs-string">  dds        3      DDS tape family from IBM</span><br><span class="hljs-string">  emc        2      EMC (company)</span><br><span class="hljs-string">  hit        7      WDC/Hitachi disk</span><br><span class="hljs-string">  hp3par     4      3PAR array (HP was Left Hand)</span><br><span class="hljs-string">  hp_lto     6      HP LTO tape/systems</span><br><span class="hljs-string">  ibm_lto    5      IBM LTO tape/systems</span><br><span class="hljs-string">  nvme       8      NVMe related</span><br><span class="hljs-string">  rdac       1      RDAC array (NetApp E-Series)</span><br><span class="hljs-string">  sea        0      Seagate disk</span><br><span class="hljs-string">  sg         9      sg3_utils extensions</span><br><span class="hljs-string">  wdc        7      WDC/Hitachi disk</span><br><span class="hljs-string"></span><br><span class="hljs-string">Vendor specific VPD pages:</span><br><span class="hljs-string">  aci        0xc5,6      ACI revision level (HP LTO)</span><br><span class="hljs-string">  datc       0xc1,0      Date code (Seagate)</span><br><span class="hljs-string">  dcrl       0xc0,5      Drive component revision levels (IBM LTO)</span><br><span class="hljs-string">  ddsver     0xc0,3      Firmware revision (DDS)</span><br><span class="hljs-string">  devb       0xc3,0      Device behavior (Seagate)</span><br><span class="hljs-string">  dsn        0xc1,5      Drive serial numbers (IBM LTO)</span><br><span class="hljs-string">  ducd       0xc7,5      Device unique configuration data (IBM LTO)</span><br><span class="hljs-string">  edid       0xc8,1      Extended device identification (RDAC)</span><br><span class="hljs-string">  firm       0xc0,0      Firmware numbers (Seagate)</span><br><span class="hljs-string">  frl        0xc0,6      Firmware revision level (HP LTO)</span><br><span class="hljs-string">  fwr4       0xc1,1      Firmware version (RDAC)</span><br><span class="hljs-string">  head       0xc4,6      Head Assy revision level (HP LTO)</span><br><span class="hljs-string">  hp3par     0xc0,4      Volume information (HP/3PAR)</span><br><span class="hljs-string">  hrl        0xc1,6      Hardware revision level (HP LTO)</span><br><span class="hljs-string">  hwr4       0xc0,1      Hardware version (RDAC)</span><br><span class="hljs-string">  jump       0xc2,0      Jump setting (Seagate)</span><br><span class="hljs-string">  mech       0xc3,6      Mechanism revision level (HP LTO)</span><br><span class="hljs-string">  mpds       0xc8,5      Mode parameter default settings (IBM LTO)</span><br><span class="hljs-string">  nicr       0xde,9      NVMe Identify Controller Response (sg3_utils)</span><br><span class="hljs-string">  pca        0xc2,6      PCA revision level (HP LTO)</span><br><span class="hljs-string">  prm4       0xc3,1      Feature Parameters (RDAC)</span><br><span class="hljs-string">  rvsi       0xca,1      Replicated volume source identifier (RDAC)</span><br><span class="hljs-string">  said       0xd0,1      Storage array world wide name (RDAC)</span><br><span class="hljs-string">  subs       0xc4,1      Subsystem identifier (RDAC)</span><br><span class="hljs-string">  swr4       0xc2,1      Software version (RDAC)</span><br><span class="hljs-string">  upr        0xc0,2      Unit path report (EMC)</span><br><span class="hljs-string">  vac1       0xc9,1      Volume access control (RDAC)</span><br><span class="hljs-string">  wp3        0x03,7      Page 0x3 (WDC/Hitachi)</span><br><span class="hljs-string">  wpd1       0xd1,7      Page 0xd1 (WDC/Hitachi)</span><br><span class="hljs-string">  wpd2       0xd2,7      Page 0xd2 (WDC/Hitachi)</span><br><span class="hljs-string"></span><br><span class="hljs-string">$ sg_vpd --page=sp /dev/sdj</span><br><span class="hljs-string">SCSI Ports VPD page:</span><br><span class="hljs-string">  Relative port=1</span><br><span class="hljs-string">    Target port descriptor(s):</span><br><span class="hljs-string">  SCSI Ports:</span><br><span class="hljs-string">    designator type: NAA,  code set: Binary</span><br><span class="hljs-string">     transport: Serial Attached SCSI Protocol (SPL-4)</span><br><span class="hljs-string">      0x5000cca26c1b8631</span><br><span class="hljs-string">  Relative port=2</span><br><span class="hljs-string">    Target port descriptor(s):</span><br><span class="hljs-string">  SCSI Ports:</span><br><span class="hljs-string">    designator type: NAA,  code set: Binary</span><br><span class="hljs-string">     transport: Serial Attached SCSI Protocol (SPL-4)</span><br><span class="hljs-string">      0x5000cca26c1b8632</span><br><span class="hljs-string"></span><br><span class="hljs-string">$ sg_vpd --page=pc /dev/sdj</span><br><span class="hljs-string">Power condition VPD page:</span><br><span class="hljs-string">  Standby_y=0 Standby_z=1 Idle_c=1 Idle_b=1 Idle_a=1</span><br><span class="hljs-string">  Stopped condition recovery time (ms) 18400</span><br><span class="hljs-string">  Standby_z condition recovery time (ms) 10200</span><br><span class="hljs-string">  Standby_y condition recovery time (ms) 3350</span><br><span class="hljs-string">  Idle_a condition recovery time (ms) 10</span><br><span class="hljs-string">  Idle_b condition recovery time (ms) 900</span><br><span class="hljs-string">  Idle_c condition recovery time (ms) 3350</span><br><span class="hljs-string"></span><br><span class="hljs-string">$  sg_scan -x</span><br><span class="hljs-string">/dev/sg0: scsi0 channel=0 id=0 lun=0  cmd_per_lun=7 queue_depth=32</span><br><span class="hljs-string">/dev/sg1: scsi0 channel=0 id=1 lun=0  cmd_per_lun=7 queue_depth=32</span><br><span class="hljs-string">/dev/sg2: scsi0 channel=0 id=2 lun=0  cmd_per_lun=7 queue_depth=32</span><br><span class="hljs-string">/dev/sg3: scsi0 channel=0 id=3 lun=0  cmd_per_lun=7 queue_depth=32</span><br><span class="hljs-string">/dev/sg4: scsi0 channel=0 id=4 lun=0  cmd_per_lun=7 queue_depth=32</span><br><span class="hljs-string">/dev/sg5: scsi0 channel=0 id=5 lun=0  cmd_per_lun=7 queue_depth=32</span><br><span class="hljs-string">/dev/sg6: scsi0 channel=0 id=6 lun=0  cmd_per_lun=7 queue_depth=32</span><br><span class="hljs-string">/dev/sg7: scsi0 channel=0 id=7 lun=0  cmd_per_lun=7 queue_depth=32</span><br><span class="hljs-string">/dev/sg8: scsi0 channel=0 id=8 lun=0  cmd_per_lun=7 queue_depth=32</span><br><span class="hljs-string">/dev/sg9: scsi0 channel=0 id=9 lun=0  cmd_per_lun=7 queue_depth=254</span><br><span class="hljs-string">/dev/sg10: scsi0 channel=0 id=10 lun=0  cmd_per_lun=7 queue_depth=32</span><br><span class="hljs-string">/dev/sg11: scsi0 channel=0 id=11 lun=0  cmd_per_lun=7 queue_depth=32</span><br><span class="hljs-string">/dev/sg12: scsi0 channel=0 id=12 lun=0  cmd_per_lun=7 queue_depth=254</span><br><span class="hljs-string">/dev/sg13: scsi15 channel=0 id=0 lun=0 [em]  cmd_per_lun=0 queue_depth=32</span><br><span class="hljs-string">/dev/sg14: scsi17 channel=0 id=0 lun=0 [em]  cmd_per_lun=0 queue_depth=1</span><br><span class="hljs-string"></span><br><span class="hljs-string">[0:0:0:0]    disk    ATA      HGST HUH721010AL LT14  /dev/sda   -  /dev/sg0   10.0TB</span><br><span class="hljs-string">[0:0:1:0]    disk    ATA      HGST HUH721010AL LT14  /dev/sdb   -  /dev/sg1   10.0TB</span><br><span class="hljs-string">[0:0:2:0]    disk    ATA      HGST HUH721010AL LT14  /dev/sdc   -  /dev/sg2   10.0TB</span><br><span class="hljs-string">[0:0:3:0]    disk    ATA      HGST HUH721010AL LT14  /dev/sdd   -  /dev/sg3   10.0TB</span><br><span class="hljs-string">[0:0:4:0]    disk    ATA      HGST HUH721010AL LT14  /dev/sde   -  /dev/sg4   10.0TB</span><br><span class="hljs-string">[0:0:5:0]    disk    ATA      HGST HUH721010AL LT14  /dev/sdf   -  /dev/sg5   10.0TB</span><br><span class="hljs-string">[0:0:6:0]    disk    ATA      HGST HUH721010AL LT14  /dev/sdg   -  /dev/sg6   10.0TB</span><br><span class="hljs-string">[0:0:7:0]    disk    ATA      HGST HUH721010AL LT14  /dev/sdh   -  /dev/sg7   10.0TB</span><br><span class="hljs-string">[0:0:8:0]    disk    ATA      HGST HUH721010AL LT14  /dev/sdi   -  /dev/sg8   10.0TB</span><br><span class="hljs-string">[0:0:9:0]    disk    HGST     HUH721010AL5200  LS14  /dev/sdj   35000cca26c1b8630  /dev/sg9   9.79TB</span><br><span class="hljs-string">[0:0:10:0]   disk    ATA      HGST HUH721010AL LT14  /dev/sdk   -  /dev/sg10  10.0TB</span><br><span class="hljs-string">[0:0:11:0]   disk    ATA      HGST HUH721010AL LT14  /dev/sdl   -  /dev/sg11  10.0TB</span><br><span class="hljs-string">[0:0:12:0]   enclosu DP       BP14G+EXP        2.25  -          -  /dev/sg12       -</span><br><span class="hljs-string">[15:0:0:0]   disk    ATA      DELLBOSS VD      00-0  /dev/sdm   -  /dev/sg13   119GB</span><br><span class="hljs-string">[17:0:0:0]   process Marvell  Console          1.01  -          -  /dev/sg14       -</span><br></code></pre></td></tr></table></figure>

<h4 id="sg-opcodes"><a href="#sg-opcodes" class="headerlink" title="sg_opcodes"></a>sg_opcodes</h4><p>sg_opcodes -n /dev/sg9</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs bash">sg_opcodes -n /dev/sg9<br>--no-inquiry ignored because --pdt= not given<br><br>Opcode  Service    CDB    CDLP   Name<br>(hex)   action(h)  size<br>-----------------------------------------------<br> 00                  6      0    Test Unit Ready<br> 01                  6      0    Rezero Unit<br> 03                  6      0    Request Sense<br> 04                  6      0    Format Unit<br> 07                  6      0    Reassign Blocks<br> 08                  6      0    Read(6)<br> 0a                  6      0    Write(6)<br> 0b                  6      0    Seek(6)<br> 12                  6      0    Inquiry<br> 15                  6      0    Mode select(6)<br> 16                  6      0    Reserve(6)<br> 17                  6      0    Release(6)<br> 1a                  6      0    Mode sense(6)<br> 1b                  6      0    Start stop unit<br> 1c                  6      0    Receive diagnostic results<br> 1d                  6      0    Send diagnostic<br> 25                 10      0    Read capacity(10)<br> 28                 10      0    Read(10)<br> 2a                 10      0    Write(10)<br> 2b                 10      0    Seek(10)<br> 2e                 10      0    Write and verify(10)<br> 2f                 10      0    Verify(10)<br> 34                 10      0    Pre-fetch(10)<br> 35                 10      0    Synchronize cache(10)<br> 37                 10      0    Read defect data(10)<br> 3b        0        10      0    Write buffer, combined header and data [or multiple modes]<br> 3b        2        10      0    Write buffer, data<br> 3b        4        10      0    Write buffer, download microcode and activate<br> 3b        5        10      0    Write buffer, download microcode, save, and activate<br> 3b        7        10      0    Write buffer, download microcode with offsets, save, and activate<br> 3b        a        10      0    Write buffer, write data to <span class="hljs-built_in">echo</span> buffer<br> 3b        d        10      0    Write buffer, download microcode with offsets, select activation events, save and defer activate<br> 3b        e        10      0    Write buffer, download microcode with offsets, save and defer activate<br> 3b        f        10      0    Write buffer, activate deferred microcode<br> 3b       1a        10      0    Write buffer, <span class="hljs-built_in">enable</span> expander comms protocol and <span class="hljs-built_in">echo</span> buffer<br> 3c        0        10      0    Read buffer(10), combined header and data [or multiple modes]<br> 3c        2        10      0    Read buffer(10), data<br> 3c        3        10      0    Read buffer(10), descriptor<br> 3c        a        10      0    Read buffer(10), <span class="hljs-built_in">read</span> data from <span class="hljs-built_in">echo</span> buffer<br> 3c        b        10      0    Read buffer(10), <span class="hljs-built_in">echo</span> buffer descriptor<br> 3c       1a        10      0    Read buffer(10), <span class="hljs-built_in">enable</span> expander comms protocol and <span class="hljs-built_in">echo</span> buffer<br> 3c       1c        10      0    Read buffer(10), error <span class="hljs-built_in">history</span><br> 3e                 10      0    Read long(10)<br> 3f                 10      0    Write long(10)<br>41                 10      0    Write same(10)<br> 48        1        10      0    Sanitize, overwrite<br> 48        3        10      0    Sanitize, cryptographic erase<br> 48       1f        10      0    Sanitize, <span class="hljs-built_in">exit</span> failure mode<br> 4c                 10      0    Log select<br> 4d                 10      0    Log sense<br> 55                 10      0    Mode select(10)<br> 56                 10      0    Reserve(10)<br> 57                 10      0    Release(10)<br> 5a                 10      0    Mode sense(10)<br> 5e        0        10      0    Persistent reserve <span class="hljs-keyword">in</span>, <span class="hljs-built_in">read</span> keys<br> 5e        1        10      0    Persistent reserve <span class="hljs-keyword">in</span>, <span class="hljs-built_in">read</span> reservation<br> 5e        2        10      0    Persistent reserve <span class="hljs-keyword">in</span>, report capabilities<br> 5e        3        10      0    Persistent reserve <span class="hljs-keyword">in</span>, <span class="hljs-built_in">read</span> full status<br> 5f        0        10      0    Persistent reserve out, register<br> 5f        1        10      0    Persistent reserve out, reserve<br> 5f        2        10      0    Persistent reserve out, release<br> 5f        3        10      0    Persistent reserve out, clear<br> 5f        4        10      0    Persistent reserve out, preempt<br> 5f        5        10      0    Persistent reserve out, preempt and abort<br> 5f        6        10      0    Persistent reserve out, register and ignore existing key<br> 88                 16      0    Read(16)<br> 8a                 16      0    Write(16)<br> 8e                 16      0    Write and verify(16)<br> 8f                 16      0    Verify(16)<br> 90                 16      0    Pre-fetch(16)<br> 91                 16      0    Synchronize cache(16)<br> 93                 16      0    Write same(16)<br> 9e       10        16      0    Read capacity(16)<br> 9e       11        16      0    Read long(16)<br> 9f       11        16      0    Write long(16)<br> a0                 12      0    Report luns<br> a3        5        12      0    Report identifying information<br> a3        c        12      0    Report supported operation codes<br> a3        d        12      0    Report supported task management <span class="hljs-built_in">functions</span><br> a3        f        12      0    Report timestamp<br> a4        6        12      0    Set identifying information<br> a4        f        12      0    Set timestamp<br> a8                 12      0    Read(12)<br> aa                 12      0    Write(12)<br> ae                 12      0    Write and verify(12)<br> af                 12      0    Verify(12)<br> b7                 12      0    Read defect data(12)<br></code></pre></td></tr></table></figure>

<h4 id="sg-write-same"><a href="#sg-write-same" class="headerlink" title="sg_write_same"></a>sg_write_same</h4><p>not make sure<br>This command writes the given block NUM times to consecutive blocks on  the  DEVICE  starting  at  logical  block address LBA.<br>If these conditions are not met and the LBPRZ bit is set then the UNMAP  bit  is  ignored  and  the data-out  buffer  is  written  to the DEVICE as if the UNMAP bit was zero</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">sg_write_same man page<br>sg_unmap - send SCSI UNMAP <span class="hljs-built_in">command</span> (known as <span class="hljs-string">&#x27;trim&#x27;</span> <span class="hljs-keyword">in</span> ATA specs)<br>$ cat /sys/block/sdb/size<br>488397168<br>$ sg_write_same --16 --unmap --verbose --lba=488397167 --num=1 /dev/sdb<br><span class="hljs-comment">#The same func with sg_write_same ?</span><br>$ sg_unmap --verbose --lba=488397167 --num=1 /dev/sdb<br><br>$ sg_unmap --verbose --lba=0 --num=488397167 /dev/sdb<br></code></pre></td></tr></table></figure>

<h4 id="sg-readcap-1"><a href="#sg-readcap-1" class="headerlink" title="sg_readcap"></a>sg_readcap</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ --16   Use the 16 byte cdb variant of the READ CAPACITY <span class="hljs-built_in">command</span>. See the <span class="hljs-string">&#x27;--long&#x27;</span> option.  -b, --brief outputs two  hex  numbers  (prefixed  with  <span class="hljs-string">&#x27;0x&#x27;</span>  and  space  separated) to stdout. The first number is the maximum number of blocks on the device (<span class="hljs-built_in">which</span> is one plus the lba of the last accessible block). The second number is the size <span class="hljs-keyword">in</span> bytes of each block.If the operation fails <span class="hljs-keyword">then</span> <span class="hljs-string">&quot;0x0 0x0&quot;</span> is written to stdout.<br><br>$ sg_readcap --16 -b /dev/sdj <span class="hljs-comment">#10TB 512E</span><br>0x474800000 0x200<br><br>Raw Size: 8.910 TB [0x474800000 Sectors]<br>0x200 = 512 Bytes<br><br>$ sg_readcap --16 -b /dev/sdj <span class="hljs-comment">#8TB 4KN</span><br>0x74702556 0x1000<br>Vendor:               HGST<br>Product:              HUH728080AL4200<br>Revision:             A7J0<br>User Capacity:        8,001,563,222,016 bytes [8.00 TB]<br>Logical block size:   4096 bytes<br>$ cat logical_block_size minimum_io_size physical_block_size<br>4096<br>4096<br>4096<br><br></code></pre></td></tr></table></figure>

<p>Got the issue, dell SAS 10TB HDD looks like only 9.79TB, Dell hide some area, the physical sector only 4096 Bytes</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Dell SATA</span><br>Model Family:     HGST Ultrastar He10<br>Device Model:     HGST HUH721010ALE600<br>LU WWN Device Id: 5 000cca 26aef5ec1<br>Add. Product Id:  DELL(tm)<br>Firmware Version: LHDELT14<br>User Capacity:    10,000,831,348,736 bytes [10.0 TB]<br>Sector Sizes:     512 bytes logical, 4096 bytes physical<br><br><span class="hljs-comment"># SAS 10TB</span><br>Vendor:               HGST<br>Product:              HUH721010AL5200<br>Revision:             A21D<br>User Capacity:        10,000,831,348,736 bytes [10.0 TB]<br>Logical block size:   512 bytes<br>Physical block size:  4096 bytes<br>Lowest aligned LBA:   0<br>Logical block provisioning <span class="hljs-built_in">type</span> unreported, LBPME=0, LBPRZ=0<br>Rotation Rate:        7200 rpm<br>Device <span class="hljs-built_in">type</span>:          disk<br>Transport protocol:   SAS<br><br><span class="hljs-comment">#Dell SAS 10TB</span><br>Vendor:               HGST<br>Product:              HUH721010AL5200<br>Revision:             LS14<br>Compliance:           SPC-4<br>User Capacity:        9,796,820,402,176 bytes [9.79 TB]<br>Logical block size:   512 bytes<br>Physical block size:  4096 bytes<br>Formatted with <span class="hljs-built_in">type</span> 2 protection<br>LU is fully provisioned<br>Rotation Rate:        7200 rpm<br>Form Factor:          3.5 inches<br>Device <span class="hljs-built_in">type</span>:          disk<br>Transport protocol:   SAS (SPL-3)<br></code></pre></td></tr></table></figure>

<h4 id="reset-bus-host-target"><a href="#reset-bus-host-target" class="headerlink" title="reset bus, host, target"></a><a target="_blank" rel="noopener" href="http://fibrevillage.com/storage/593-sg-reset-command-examples">reset bus, host, target</a></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># reset bus</span><br>$ sg_reset -v -b /dev/sdf<br>[root@kvm-manager-a23-2 ~]<span class="hljs-comment"># sg_reset -v -b /dev/sdf</span><br>sg_reset: starting bus reset<br>sg_reset: completed bus (or host) reset<br><br><span class="hljs-comment">###</span><br>[Mon Jun 17 12:19:41 2019] mpt3sas_cm0: attempting host reset! scmd(ffff96107b4a6a00)<br>[Mon Jun 17 12:19:41 2019] sd 0:0:3:0: CDB: Test Unit Ready<br>[Mon Jun 17 12:19:41 2019] mpt3sas_cm0: sending diag reset !!<br>[Mon Jun 17 12:19:42 2019] mpt3sas_cm0: diag reset: SUCCESS<br>[Mon Jun 17 12:19:42 2019] mpt3sas_cm0: IOC Number : 0<br>[Mon Jun 17 12:19:42 2019] mpt3sas_cm0: CurrentHostPageSize is 0: Setting default host page size to 4k<br>[Mon Jun 17 12:19:42 2019] mpt3sas_cm0: LSISAS3008: FWVersion(15.00.03.00), ChipRevision(0x02), BiosVersion(08.31.00.00)<br>[Mon Jun 17 12:19:42 2019] mpt3sas_cm0: Protocol=(Initiator), Capabilities=(Raid,TLR,EEDP,Snapshot Buffer,Diag Trace Buffer,Task Set Full,NCQ)<br>[Mon Jun 17 12:19:42 2019] mpt3sas_cm0: sending port <span class="hljs-built_in">enable</span> !!<br>[Mon Jun 17 12:19:49 2019] mpt3sas_cm0: port <span class="hljs-built_in">enable</span>: SUCCESS<br>[Mon Jun 17 12:19:49 2019] mpt3sas_cm0: search <span class="hljs-keyword">for</span> end-devices: start<br>[Mon Jun 17 12:19:49 2019] scsi target0:0:0: handle(0x000a), sas_address(0x5000c5003015b562), port: 255<br>[Mon Jun 17 12:19:49 2019] scsi target0:0:0: enclosure logical id(0x500304801d72dd7f), slot(0)<br>[Mon Jun 17 12:19:49 2019] scsi target0:0:1: handle(0x000b), sas_address(0x5000c5003015b786), port: 255<br>[Mon Jun 17 12:19:49 2019] scsi target0:0:1: enclosure logical id(0x500304801d72dd7f), slot(1)<br>[Mon Jun 17 12:19:49 2019] scsi target0:0:2: handle(0x000c), sas_address(0x5000c5003015b57a), port: 255<br>[Mon Jun 17 12:19:49 2019] scsi target0:0:2: enclosure logical id(0x500304801d72dd7f), slot(2)<br>[Mon Jun 17 12:19:49 2019] scsi target0:0:3: handle(0x000d), sas_address(0x5000c5003015b56a), port: 255<br>[Mon Jun 17 12:19:49 2019] scsi target0:0:3: enclosure logical id(0x500304801d72dd7f), slot(3)<br>[Mon Jun 17 12:19:49 2019] scsi target0:0:4: handle(0x000e), sas_address(0x5000c500301b8b06), port: 255<br>[Mon Jun 17 12:19:49 2019] scsi target0:0:4: enclosure logical id(0x500304801d72dd7f), slot(4)<br>[Mon Jun 17 12:19:49 2019] scsi target0:0:5: handle(0x000f), sas_address(0x5000c5003015b566), port: 255<br>[Mon Jun 17 12:19:49 2019] scsi target0:0:5: enclosure logical id(0x500304801d72dd7f), slot(5)<br>[Mon Jun 17 12:19:49 2019] scsi target0:0:6: handle(0x0010), sas_address(0x5000c5003015b582), port: 255<br>[Mon Jun 17 12:19:49 2019] scsi target0:0:6: enclosure logical id(0x500304801d72dd7f), slot(6)<br>[Mon Jun 17 12:19:49 2019] scsi target0:0:7: handle(0x0011), sas_address(0x5000c5003015b56e), port: 255<br>[Mon Jun 17 12:19:49 2019] scsi target0:0:7: enclosure logical id(0x500304801d72dd7f), slot(7)<br>[Mon Jun 17 12:19:49 2019] scsi target0:0:8: handle(0x0012), sas_address(0x5000c5003015b5b6), port: 255<br>[Mon Jun 17 12:19:49 2019] scsi target0:0:8: enclosure logical id(0x500304801d72dd7f), slot(8)<br>[Mon Jun 17 12:19:49 2019] scsi target0:0:9: handle(0x0013), sas_address(0x5000c500301b8b7e), port: 255<br>[Mon Jun 17 12:19:49 2019] scsi target0:0:9: enclosure logical id(0x500304801d72dd7f), slot(9)<br>[Mon Jun 17 12:19:49 2019] scsi target0:0:10: handle(0x0014), sas_address(0x500304801d72ddfd), port: 255<br>[Mon Jun 17 12:19:49 2019] scsi target0:0:10: enclosure logical id(0x500304801d72dd7f), slot(24)<br>[Mon Jun 17 12:19:49 2019] mpt3sas_cm0: 	<span class="hljs-built_in">break</span> from _scsih_search_responding_sas_devices: ioc_status(0x0022), loginfo(0x310f0400)<br>[Mon Jun 17 12:19:49 2019] mpt3sas_cm0: search <span class="hljs-keyword">for</span> end-devices: complete<br>[Mon Jun 17 12:19:49 2019] mpt3sas_cm0: search <span class="hljs-keyword">for</span> end-devices: start<br>[Mon Jun 17 12:19:49 2019] mpt3sas_cm0: search <span class="hljs-keyword">for</span> PCIe end-devices: complete<br>[Mon Jun 17 12:19:49 2019] mpt3sas_cm0: search <span class="hljs-keyword">for</span> raid volumes: start<br>[Mon Jun 17 12:19:49 2019] mpt3sas_cm0: search <span class="hljs-keyword">for</span> responding raid volumes: complete<br>[Mon Jun 17 12:19:50 2019] mpt3sas_cm0: search <span class="hljs-keyword">for</span> expanders: start<br>[Mon Jun 17 12:19:50 2019] 	expander present: handle(0x0009), sas_addr(0x500304801d72ddff), port:255<br>[Mon Jun 17 12:19:50 2019] mpt3sas_cm0: 	<span class="hljs-built_in">break</span> from _scsih_search_responding_expanders: ioc_status(0x0022), loginfo(0x310f0400)<br>[Mon Jun 17 12:19:50 2019] mpt3sas_cm0: search <span class="hljs-keyword">for</span> expanders: complete<br>[Mon Jun 17 12:19:50 2019] mpt3sas_cm0: host reset: SUCCESS scmd(ffff96107b4a6a00)<br>[Mon Jun 17 12:20:00 2019]  sdf: sdf1 sdf9<br>[Mon Jun 17 12:20:00 2019] mpt3sas_cm0: removing unresponding devices: start<br>[Mon Jun 17 12:20:00 2019] mpt3sas_cm0: removing unresponding devices: sas end-devices<br>[Mon Jun 17 12:20:00 2019] mpt3sas_cm0: removing unresponding devices: pcie end-devices<br>[Mon Jun 17 12:20:00 2019] mpt3sas_cm0: removing unresponding devices: volumes<br>[Mon Jun 17 12:20:00 2019] mpt3sas_cm0: removing unresponding devices: expanders<br>[Mon Jun 17 12:20:00 2019] mpt3sas_cm0: removing unresponding devices: complete<br>[Mon Jun 17 12:20:00 2019] mpt3sas_cm0: scan devices: start<br>[Mon Jun 17 12:20:00 2019] mpt3sas_cm0: 	scan devices: expanders start<br>[Mon Jun 17 12:20:00 2019] mpt3sas_cm0: 	<span class="hljs-built_in">break</span> from expander scan: ioc_status(0x0022), loginfo(0x310f0400)<br>[Mon Jun 17 12:20:00 2019] mpt3sas_cm0: 	scan devices: expanders complete<br>[Mon Jun 17 12:20:00 2019] mpt3sas_cm0: 	scan devices: phys disk start<br>[Mon Jun 17 12:20:00 2019] mpt3sas_cm0: 	<span class="hljs-built_in">break</span> from phys disk scan: ioc_status(0x0022), loginfo(0x00000000)<br>[Mon Jun 17 12:20:00 2019] mpt3sas_cm0: 	scan devices: phys disk complete<br>[Mon Jun 17 12:20:00 2019] mpt3sas_cm0: 	scan devices: volumes start<br>[Mon Jun 17 12:20:00 2019] mpt3sas_cm0: 	<span class="hljs-built_in">break</span> from volume scan: ioc_status(0x0022), loginfo(0x00000000)<br>[Mon Jun 17 12:20:00 2019] mpt3sas_cm0: 	scan devices: volumes complete<br>[Mon Jun 17 12:20:00 2019] mpt3sas_cm0: 	scan devices: sas end devices start<br>[Mon Jun 17 12:20:00 2019] mpt3sas_cm0: 	<span class="hljs-built_in">break</span> from sas end device scan: ioc_status(0x0022), loginfo(0x310f0400)<br>[Mon Jun 17 12:20:00 2019] mpt3sas_cm0: 	scan devices: sas end devices complete<br>[Mon Jun 17 12:20:00 2019] mpt3sas_cm0: 	scan devices: pcie end devices start<br>[Mon Jun 17 12:20:00 2019] mpt3sas_cm0: log_info(0x3003011d): originator(IOP), code(0x03), sub_code(0x011d)<br>[Mon Jun 17 12:20:00 2019] mpt3sas_cm0: log_info(0x3003011d): originator(IOP), code(0x03), sub_code(0x011d)<br>[Mon Jun 17 12:20:00 2019] mpt3sas_cm0: 	<span class="hljs-built_in">break</span> from pcie end device scan: ioc_status(0x0021), loginfo(0x3003011d)<br>[Mon Jun 17 12:20:00 2019] mpt3sas_cm0: 	pcie devices: pcie end devices complete<br>[Mon Jun 17 12:20:00 2019] mpt3sas_cm0: scan devices: complete<br><br><span class="hljs-comment"># reset host</span><br>$ sg_reset -v -H /dev/sdf<br>sg_reset: starting host reset<br>sg_reset: completed host reset<br><br>[Mon Jun 17 12:22:10 2019] mpt3sas_cm0: attempting host reset! scmd(ffff9620717edc00)<br>[Mon Jun 17 12:22:10 2019] sd 0:0:3:0: CDB: Test Unit Ready<br>[Mon Jun 17 12:22:10 2019] mpt3sas_cm0: sending diag reset !!<br>[Mon Jun 17 12:22:11 2019] mpt3sas_cm0: diag reset: SUCCESS<br>[Mon Jun 17 12:22:11 2019] mpt3sas_cm0: IOC Number : 0<br>[Mon Jun 17 12:22:11 2019] mpt3sas_cm0: CurrentHostPageSize is 0: Setting default host page size to 4k<br>[Mon Jun 17 12:22:11 2019] mpt3sas_cm0: LSISAS3008: FWVersion(15.00.03.00), ChipRevision(0x02), BiosVersion(08.31.00.00)<br>[Mon Jun 17 12:22:11 2019] mpt3sas_cm0: Protocol=(Initiator), Capabilities=(Raid,TLR,EEDP,Snapshot Buffer,Diag Trace Buffer,Task Set Full,NCQ)<br>[Mon Jun 17 12:22:11 2019] mpt3sas_cm0: sending port <span class="hljs-built_in">enable</span> !!<br>[Mon Jun 17 12:22:18 2019] mpt3sas_cm0: port <span class="hljs-built_in">enable</span>: SUCCESS<br>[Mon Jun 17 12:22:18 2019] mpt3sas_cm0: search <span class="hljs-keyword">for</span> end-devices: start<br>[Mon Jun 17 12:22:18 2019] scsi target0:0:0: handle(0x000a), sas_address(0x5000c5003015b562), port: 255<br>[Mon Jun 17 12:22:18 2019] scsi target0:0:0: enclosure logical id(0x500304801d72dd7f), slot(0)<br>[Mon Jun 17 12:22:18 2019] scsi target0:0:1: handle(0x000b), sas_address(0x5000c5003015b786), port: 255<br>[Mon Jun 17 12:22:18 2019] scsi target0:0:1: enclosure logical id(0x500304801d72dd7f), slot(1)<br>[Mon Jun 17 12:22:18 2019] scsi target0:0:2: handle(0x000c), sas_address(0x5000c5003015b57a), port: 255<br>[Mon Jun 17 12:22:18 2019] scsi target0:0:2: enclosure logical id(0x500304801d72dd7f), slot(2)<br>[Mon Jun 17 12:22:18 2019] scsi target0:0:3: handle(0x000d), sas_address(0x5000c5003015b56a), port: 255<br>[Mon Jun 17 12:22:18 2019] scsi target0:0:3: enclosure logical id(0x500304801d72dd7f), slot(3)<br>[Mon Jun 17 12:22:18 2019] scsi target0:0:4: handle(0x000e), sas_address(0x5000c500301b8b06), port: 255<br>[Mon Jun 17 12:22:18 2019] scsi target0:0:4: enclosure logical id(0x500304801d72dd7f), slot(4)<br>[Mon Jun 17 12:22:18 2019] scsi target0:0:5: handle(0x000f), sas_address(0x5000c5003015b566), port: 255<br>[Mon Jun 17 12:22:18 2019] scsi target0:0:5: enclosure logical id(0x500304801d72dd7f), slot(5)<br>[Mon Jun 17 12:22:18 2019] scsi target0:0:6: handle(0x0010), sas_address(0x5000c5003015b582), port: 255<br>[Mon Jun 17 12:22:18 2019] scsi target0:0:6: enclosure logical id(0x500304801d72dd7f), slot(6)<br>[Mon Jun 17 12:22:18 2019] scsi target0:0:7: handle(0x0011), sas_address(0x5000c5003015b56e), port: 255<br>[Mon Jun 17 12:22:18 2019] scsi target0:0:7: enclosure logical id(0x500304801d72dd7f), slot(7)<br>[Mon Jun 17 12:22:18 2019] scsi target0:0:8: handle(0x0012), sas_address(0x5000c5003015b5b6), port: 255<br>[Mon Jun 17 12:22:18 2019] scsi target0:0:8: enclosure logical id(0x500304801d72dd7f), slot(8)<br>[Mon Jun 17 12:22:18 2019] scsi target0:0:9: handle(0x0013), sas_address(0x5000c500301b8b7e), port: 255<br>[Mon Jun 17 12:22:18 2019] scsi target0:0:9: enclosure logical id(0x500304801d72dd7f), slot(9)<br>[Mon Jun 17 12:22:18 2019] scsi target0:0:10: handle(0x0014), sas_address(0x500304801d72ddfd), port: 255<br>[Mon Jun 17 12:22:18 2019] scsi target0:0:10: enclosure logical id(0x500304801d72dd7f), slot(24)<br>[Mon Jun 17 12:22:18 2019] mpt3sas_cm0: 	<span class="hljs-built_in">break</span> from _scsih_search_responding_sas_devices: ioc_status(0x0022), loginfo(0x310f0400)<br>[Mon Jun 17 12:22:18 2019] mpt3sas_cm0: search <span class="hljs-keyword">for</span> end-devices: complete<br>[Mon Jun 17 12:22:18 2019] mpt3sas_cm0: search <span class="hljs-keyword">for</span> end-devices: start<br>[Mon Jun 17 12:22:18 2019] mpt3sas_cm0: search <span class="hljs-keyword">for</span> PCIe end-devices: complete<br>[Mon Jun 17 12:22:18 2019] mpt3sas_cm0: search <span class="hljs-keyword">for</span> raid volumes: start<br>[Mon Jun 17 12:22:18 2019] mpt3sas_cm0: search <span class="hljs-keyword">for</span> responding raid volumes: complete<br>[Mon Jun 17 12:22:18 2019] mpt3sas_cm0: search <span class="hljs-keyword">for</span> expanders: start<br>[Mon Jun 17 12:22:18 2019] 	expander present: handle(0x0009), sas_addr(0x500304801d72ddff), port:255<br>[Mon Jun 17 12:22:18 2019] mpt3sas_cm0: 	<span class="hljs-built_in">break</span> from _scsih_search_responding_expanders: ioc_status(0x0022), loginfo(0x310f0400)<br>[Mon Jun 17 12:22:18 2019] mpt3sas_cm0: search <span class="hljs-keyword">for</span> expanders: complete<br>[Mon Jun 17 12:22:18 2019] mpt3sas_cm0: host reset: SUCCESS scmd(ffff9620717edc00)<br>[Mon Jun 17 12:22:28 2019]  sdf: sdf1 sdf9<br>[Mon Jun 17 12:22:28 2019] mpt3sas_cm0: removing unresponding devices: start<br>[Mon Jun 17 12:22:28 2019] mpt3sas_cm0: removing unresponding devices: sas end-devices<br>[Mon Jun 17 12:22:28 2019] mpt3sas_cm0: removing unresponding devices: pcie end-devices<br>[Mon Jun 17 12:22:28 2019] mpt3sas_cm0: removing unresponding devices: volumes<br>[Mon Jun 17 12:22:28 2019] mpt3sas_cm0: removing unresponding devices: expanders<br>[Mon Jun 17 12:22:28 2019] mpt3sas_cm0: removing unresponding devices: complete<br>[Mon Jun 17 12:22:28 2019] mpt3sas_cm0: scan devices: start<br>[Mon Jun 17 12:22:28 2019] mpt3sas_cm0: 	scan devices: expanders start<br>[Mon Jun 17 12:22:28 2019] mpt3sas_cm0: 	<span class="hljs-built_in">break</span> from expander scan: ioc_status(0x0022), loginfo(0x310f0400)<br>[Mon Jun 17 12:22:28 2019] mpt3sas_cm0: 	scan devices: expanders complete<br>[Mon Jun 17 12:22:28 2019] mpt3sas_cm0: 	scan devices: phys disk start<br>[Mon Jun 17 12:22:28 2019] mpt3sas_cm0: 	<span class="hljs-built_in">break</span> from phys disk scan: ioc_status(0x0022), loginfo(0x00000000)<br>[Mon Jun 17 12:22:28 2019] mpt3sas_cm0: 	scan devices: phys disk complete<br>[Mon Jun 17 12:22:28 2019] mpt3sas_cm0: 	scan devices: volumes start<br>[Mon Jun 17 12:22:28 2019] mpt3sas_cm0: 	<span class="hljs-built_in">break</span> from volume scan: ioc_status(0x0022), loginfo(0x00000000)<br>[Mon Jun 17 12:22:28 2019] mpt3sas_cm0: 	scan devices: volumes complete<br>[Mon Jun 17 12:22:28 2019] mpt3sas_cm0: 	scan devices: sas end devices start<br>[Mon Jun 17 12:22:28 2019] mpt3sas_cm0: 	<span class="hljs-built_in">break</span> from sas end device scan: ioc_status(0x0022), loginfo(0x310f0400)<br>[Mon Jun 17 12:22:28 2019] mpt3sas_cm0: 	scan devices: sas end devices complete<br>[Mon Jun 17 12:22:28 2019] mpt3sas_cm0: 	scan devices: pcie end devices start<br>[Mon Jun 17 12:22:28 2019] mpt3sas_cm0: log_info(0x3003011d): originator(IOP), code(0x03), sub_code(0x011d)<br>[Mon Jun 17 12:22:28 2019] mpt3sas_cm0: log_info(0x3003011d): originator(IOP), code(0x03), sub_code(0x011d)<br>[Mon Jun 17 12:22:28 2019] mpt3sas_cm0: 	<span class="hljs-built_in">break</span> from pcie end device scan: ioc_status(0x0021), loginfo(0x3003011d)<br>[Mon Jun 17 12:22:28 2019] mpt3sas_cm0: 	pcie devices: pcie end devices complete<br>[Mon Jun 17 12:22:28 2019] mpt3sas_cm0: scan devices: complete<br><br><span class="hljs-comment"># reset target, I guess there is the same with -d, looks like I &#x27;m right</span><br>$ sg_reset -v -t /dev/sdf<br>sg_reset: starting target reset<br>sg_reset: completed target (or bus or host) reset<br><br>[Mon Jun 17 12:23:27 2019] scsi target0:0:3: attempting target reset! scmd(ffff961e69a2f2c0)<br>[Mon Jun 17 12:23:27 2019] sd 0:0:3:0: CDB: Test Unit Ready<br>[Mon Jun 17 12:23:27 2019] scsi target0:0:3: _scsih_tm_display_info: handle(0x000d), sas_address(0x5000c5003015b56a), phy(15)<br>[Mon Jun 17 12:23:27 2019] scsi target0:0:3: enclosurelogical id(0x500304801d72dd7f), slot(3)<br>[Mon Jun 17 12:23:27 2019] scsi target0:0:3: enclosure level(0x0000), connector name(     )<br>[Mon Jun 17 12:23:27 2019] scsi target0:0:3: target reset: SUCCESS scmd(ffff961e69a2f2c0)<br>[Mon Jun 17 12:23:27 2019]  sdf: sdf1 sdf9<br><br>$ sg_reset -v -d /dev/sdf<br>sg_reset: starting device reset<br>sg_reset: completed device (or target or bus or host) reset<br><br>[Mon Jun 17 12:24:35 2019] sd 0:0:3:0: attempting device reset! scmd(ffff9620717edf80)<br>[Mon Jun 17 12:24:35 2019] sd 0:0:3:0: CDB: Test Unit Ready<br>[Mon Jun 17 12:24:35 2019] scsi target0:0:3: _scsih_tm_display_info: handle(0x000d), sas_address(0x5000c5003015b56a), phy(15)<br>[Mon Jun 17 12:24:35 2019] scsi target0:0:3: enclosurelogical id(0x500304801d72dd7f), slot(3)<br>[Mon Jun 17 12:24:35 2019] scsi target0:0:3: enclosure level(0x0000), connector name(     )<br>[Mon Jun 17 12:24:35 2019] sd 0:0:3:0: device reset: SUCCESS scmd(ffff9620717edf80)<br>[Mon Jun 17 12:24:35 2019]  sdf: sdf1 sdf9<br></code></pre></td></tr></table></figure>

<h3 id="mpt2sas-driver-layer"><a href="#mpt2sas-driver-layer" class="headerlink" title="mpt2sas driver layer"></a>mpt2sas driver layer</h3><p>Because HBA connect with JBOD will cause some of counts<br>I will record all counts at boot time. compare these counts with future<br>If you found some number increase that means there are some errors in sas driver layer</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">lsscsi -g &gt; /dev/shm/lsscsi.log<br><span class="hljs-built_in">cd</span> /sys/class/sas_phy;<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> $(ls); <span class="hljs-keyword">do</span><br>value=$(cat <span class="hljs-variable">$i</span>/running_disparity_error_count)<br>value2=$(cat <span class="hljs-variable">$i</span>/phy_reset_problem_count)<br>value3=$(cat <span class="hljs-variable">$i</span>/loss_of_dword_sync_count)<br>value4=$(cat <span class="hljs-variable">$i</span>/invalid_dword_count)<br><span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$value</span> -gt 0 ]] || [[ <span class="hljs-variable">$value2</span> -gt 0 ]] || [[ <span class="hljs-variable">$value3</span> -gt 0 ]] || [[ <span class="hljs-variable">$value4</span> -gt 0 ]]<br><span class="hljs-keyword">then</span><br>  devtype=$(cat /dev/shm/lsscsi.log | grep -i <span class="hljs-variable">$i</span> | awk <span class="hljs-string">&#x27;&#123;print $1,$NF&#125;&#x27;</span>)<br>  <span class="hljs-built_in">echo</span> -n <span class="hljs-variable">$i</span><span class="hljs-string">&quot;-- &quot;</span><br>  <span class="hljs-built_in">echo</span> -n running_disparity_error_count<span class="hljs-string">&quot;:&quot;</span><span class="hljs-variable">$value</span><span class="hljs-string">&quot; &quot;</span><span class="hljs-variable">$devtype</span><span class="hljs-string">&quot; &quot;</span><br>  <span class="hljs-built_in">echo</span> -n phy_reset_problem_count<span class="hljs-string">&quot;:&quot;</span><span class="hljs-variable">$value2</span><span class="hljs-string">&quot; &quot;</span><span class="hljs-variable">$devtype</span><span class="hljs-string">&quot; &quot;</span><br>  <span class="hljs-built_in">echo</span> -n loss_of_dword_sync_count<span class="hljs-string">&quot;:&quot;</span><span class="hljs-variable">$value3</span><span class="hljs-string">&quot; &quot;</span><span class="hljs-variable">$devtype</span><span class="hljs-string">&quot; &quot;</span><br>  <span class="hljs-built_in">echo</span> invalid_dword_count<span class="hljs-string">&quot;:&quot;</span><span class="hljs-variable">$value4</span><span class="hljs-string">&quot; &quot;</span><span class="hljs-variable">$devtype</span><br><span class="hljs-keyword">fi</span><br><span class="hljs-keyword">done</span><br><br>phy-0:0:13-- running_disparity_error_count:1  phy_reset_problem_count:0  loss_of_dword_sync_count:1  invalid_dword_count:1<br>phy-0:0:15-- running_disparity_error_count:0  phy_reset_problem_count:0  loss_of_dword_sync_count:1  invalid_dword_count:5<br>phy-0:0:17-- running_disparity_error_count:0  phy_reset_problem_count:0  loss_of_dword_sync_count:1  invalid_dword_count:5<br>phy-0:0:19-- running_disparity_error_count:1  phy_reset_problem_count:0  loss_of_dword_sync_count:1  invalid_dword_count:1<br>phy-0:0:21-- running_disparity_error_count:0  phy_reset_problem_count:0  loss_of_dword_sync_count:1  invalid_dword_count:6<br>phy-0:0:23-- running_disparity_error_count:1  phy_reset_problem_count:0  loss_of_dword_sync_count:1  invalid_dword_count:5<br>phy-0:0:25-- running_disparity_error_count:0  phy_reset_problem_count:0  loss_of_dword_sync_count:1  invalid_dword_count:6<br>phy-0:0:27-- running_disparity_error_count:0  phy_reset_problem_count:0  loss_of_dword_sync_count:1  invalid_dword_count:5<br>phy-12:2:3-- running_disparity_error_count:0  phy_reset_problem_count:1  loss_of_dword_sync_count:0  invalid_dword_count:0<br>phy-14:1:22-- running_disparity_error_count:2  phy_reset_problem_count:4  loss_of_dword_sync_count:4  invalid_dword_count:30<br></code></pre></td></tr></table></figure>


<p>Counters that are defined in SAS 1.1 Standard:</p>
<ul>
<li><p>Invalid DWORDs<br>A ‘dword’ that is not a data word or a primitive (i.e., in the character context, a dword that contains an invalid character, a control character not in the first character position, a control character other than K28.3 or K28.5 in the first character position or one or more characters with a ‘running disparity’ error). This could mark the beginning of a loss of dword synchronization. Synchronization is lost after the fourth non-nullified invalid dword (if followed by a valid dword).</p>
</li>
<li><p>Phy reset problem<br>Number of times a PHY reset problem occurs. When a PHY or link is reset, it will run through its reset sequence (OOB, Speed Negotiation, Multiplexing, and Identification).</p>
</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://www.seagate.com/staticfiles/support/disc/manuals/Interface%20manuals/100293071c.pdf">for more scsi info</a></p>
<ul>
<li><p>Running disparity error count<br>A binary value indicating the cumulative encoded signal imbalance between the one and zero signal state of all characters since dword synchronization has been achieved.<br>Cumulative encoded signal imbalance between the one and zero signal state. Any dwords with one or more Running Disparity Errors will be considered as invalid dwords.</p>
</li>
<li><p>Loss of DWORD synchroization count<br>If occur loss_of_dword_sync, the sas protocol will retrans the bad data ? if occur multiple times at the short time(half an hour), the HBA will reset the link (from driver ? HBA itself ? )</p>
</li>
</ul>
<p>These errors mean that there is a problem in the link between the drive and the upstream port, if you have a cable in there the cable may be bad, if not it means one of the port is bad. Ofcourse even if you have a cable it can still mean one of the ports is bad.<br>After dword synchronization has been achieved, this machine monitors invalid dwords that are received. When an invalid dword is detected, it requires two valid dwords to nullify its effect. When four invalid dwords are detected without nullification, dword synchronization is considered lost.</p>
<p>The way to diagnose it is to use a different disk in the same slot and see if the error goes away or not, if it went away the disk is bad. If the error stayed the original disk is fine but the port on the server/chassis is bad and the server/chassis needs to be replaced.<br>The issue with loss of dword synchronization is that it means additional retries for some sent IOs and it will increase the latency of IOs by way of waiting more for data transmission due to these retransmits.</p>
<p>Errors are collected from PHYs on:<br>    SAS expanders.<br>    SAS disks.<br>    SAS I/O protocol ASICs.</p>
<p>SATA has its phy error count, just not same with T10, it ‘s T13<br><a target="_blank" rel="noopener" href="https://kb.netapp.com/app/answers/answer_view/a_id/1072439/~/how-to-troubleshoot-a-sas-e-series-storage-system-using-the-sasphyerrorlogs.csv">Note: SATA drives do not report any errors. As these are SATA devices, they do not have the same reporting functionality as their SAS counterparts.</a></p>
<h4 id="mpt2sas-debug-code"><a href="#mpt2sas-debug-code" class="headerlink" title="mpt2sas debug code"></a>mpt2sas debug code</h4><p>Example: this enables firmware events and reply with additional info<br>#insmod mpt2sas.ko logging_level=0x218<br>Example: this enables handshake and initialization logging<br>#insmod mpt2sas.ko logging_level=0x420<br>Example: this enables application using IOCTLS logging<br>#insmod mpt2sas.ko logging_level=0x8000<br>Example: this enables manufacture configuration logging<br>#insmod mpt2sas.ko logging_level=0x800<br>Example: this enables host reset and task management logging<br>#insmod mpt2sas.ko logging_level=0x2100<br>Example: this enables task set full logging<br>#insmod mpt2sas.ko logging_level=0x80000</p>
<p>NOTE: Many of the driver debug prints are using KERN_DEBUG and KERN_INFO logging level. Red Hat and SuSE tend to set the default logging level set to a higher level, perhaps KERN_WARNING. When set to KERN_WARNING you will be missing most the debug info. To turn on the additional logs, you will need to see the set klogd to KERN_DEBUG. In both SuSE and Red Hat offer configuration of klogd from the file /etc/sysconfig/syslog. Please refer to the klogd manual page for more info.</p>
<h5 id="mpt2sas-fwfault-debug"><a href="#mpt2sas-fwfault-debug" class="headerlink" title="mpt2sas_fwfault_debug"></a><a target="_blank" rel="noopener" href="https://git.congatec.com/arm/qmx6_kernel/commit/fa7f31673583a6e0876f8bb420735cdd8a3ffa57">mpt2sas_fwfault_debug</a></h5><p>Added command line option and shost sysfs attribute called mpt2sas_fwfault_debug. When enduser writes a “1” to this parameter, this will enable support in the driver for debugging firmware timeout related issues.</p>
<p>This handling was added in three areas<br>(a) scsi error handling callback called task_abort<br>(b) IOCTL interface<br>(c) other timeouts that result in diag resets, such as manufacturing config pages.<br>When this support is enabled, the driver will provide dump_stack to console, halt controller firmware, and panic driver. The end user probably would want to setup serial console redirection so the dump stack can be seen.</p>
<p>Here are the three methods for enable this support:</p>
<p>(a) # insmod mpt2sas.ko mpt2sas_fwfault_debug=1<br>(b) # echo 1 &gt; /sys/module/mpt2sas/parameters/mpt2sas_fwfault_debug<br>(c) # echo 1 &gt; /sys/class/scsi_host/host#/fwfault_debug  (where # is the host number)</p>
<p>At this time, there is some issues in HBA, you could compare with these time stamps.<br>The hardware(HBA) throw out a lot of error log to kernel<br>It ‘s not the kernel behavior, it ‘s the error log from HBA</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">Feb 14 10:53:28 host1.example kernel: : mpt2sas0:</span> <span class="hljs-string">fault_state(0x5841)!</span><br><span class="hljs-attr">Feb 14 10:53:28 host1.example kernel: : mpt2sas0:</span> <span class="hljs-string">sending</span> <span class="hljs-string">diag</span> <span class="hljs-string">reset</span> <span class="hljs-string">!!</span><br><span class="hljs-string">...</span><br><span class="hljs-attr">Feb 14 11:14:27 host1.example kernel: : mpt2sas0:</span> <span class="hljs-string">fault_state(0x5841)!</span><br><span class="hljs-attr">Feb 14 11:14:27 host1.example kernel: : mpt2sas0:</span> <span class="hljs-string">sending</span> <span class="hljs-string">diag</span> <span class="hljs-string">reset</span> <span class="hljs-string">!</span><br><span class="hljs-string">...</span><br><span class="hljs-attr">Feb 14 11:25:30 host1.example kernel: : mpt2sas0:</span> <span class="hljs-string">fault_state(0x5841)!</span><br><span class="hljs-attr">Feb 14 11:25:30 host1.example kernel: : mpt2sas0:</span> <span class="hljs-string">sending</span> <span class="hljs-string">diag</span> <span class="hljs-string">reset</span> <span class="hljs-string">!!</span><br><span class="hljs-attr">Feb 14 11:25:30 host1.example kernel: : mpt2sas0:</span> <span class="hljs-string">fault_state(0x5841)!</span><br><span class="hljs-attr">Feb 14 11:25:30 host1.example kernel: : mpt2sas0:</span> <span class="hljs-string">sending</span> <span class="hljs-string">diag</span> <span class="hljs-string">reset</span> <span class="hljs-string">!!</span><br><span class="hljs-attr">Feb 14 11:25:31 host1.example kernel: : mpt2sas0: diag reset:</span> <span class="hljs-string">SUCCESS</span><br><span class="hljs-attr">Feb 14 11:25:31 host1.example kernel: : mpt2sas0: diag reset:</span> <span class="hljs-string">SUCCESS</span><br><span class="hljs-attr">Feb 14 11:25:38 host1.example kernel: : mpt2sas0: LSISAS2008:</span> <span class="hljs-string">FWVersion(08.00.09.00),</span> <span class="hljs-string">ChipRevision(0x03),</span> <span class="hljs-string">BiosVersion(07.15.00.00)</span><br><span class="hljs-attr">Feb 14 11:25:38 host1.example kernel: : mpt2sas0:</span> <span class="hljs-string">Protocol=(Initiator,Target),</span> <span class="hljs-string">Capabilities=(Raid,TLR,EEDP,Snapshot</span> <span class="hljs-string">Buffer,Diag</span> <span class="hljs-string">Trace</span> <span class="hljs-string">Buffer,Task</span> <span class="hljs-string">Set</span> <span class="hljs-string">Full,NCQ)</span><br><span class="hljs-attr">Feb 14 11:25:38 host1.example kernel: : mpt2sas0:</span> <span class="hljs-string">sending</span> <span class="hljs-string">port</span> <span class="hljs-string">enable</span> <span class="hljs-string">!!</span><br><span class="hljs-attr">Feb 14 11:25:38 host1.example kernel: : mpt2sas0: port enable:</span> <span class="hljs-string">SUCCESS</span><br><span class="hljs-attr">Feb 14 11:25:38 host1.example kernel: : mpt2sas0:</span> <span class="hljs-string">_scsih_search_responding_sas_devices</span><br><span class="hljs-attr">Feb 14 11:25:38 host1.example kernel: : mpt2sas0: LSISAS2008:</span> <span class="hljs-string">FWVersion(08.00.09.00),</span> <span class="hljs-string">ChipRevision(0x03),</span> <span class="hljs-string">BiosVersion(07.15.00.00)</span><br><span class="hljs-attr">Feb 14 11:25:38 host1.example kernel: : mpt2sas0:</span> <span class="hljs-string">Protocol=(Initiator,Target),</span> <span class="hljs-string">Capabilities=(Raid,TLR,EEDP,Snapshot</span> <span class="hljs-string">Buffer,Diag</span> <span class="hljs-string">Trace</span> <span class="hljs-string">Buffer,Task</span> <span class="hljs-string">Set</span> <span class="hljs-string">Full,NCQ)</span><br><span class="hljs-attr">Feb 14 11:25:38 host1.example kernel: : mpt2sas0:</span> <span class="hljs-string">sending</span> <span class="hljs-string">port</span> <span class="hljs-string">enable</span> <span class="hljs-string">!!</span><br><span class="hljs-attr">Feb 14 11:25:38 host1.example kernel: : mpt2sas0: port enable:</span> <span class="hljs-string">SUCCESS</span><br><span class="hljs-attr">Feb 14 11:25:38 host1.example kernel: : mpt2sas0:</span> <span class="hljs-string">_scsih_search_responding_sas_devices</span><br><span class="hljs-attr">Feb 14 11:25:38 host1.example kernel: : mpt2sas0:</span> <span class="hljs-string">_scsih_search_responding_raid_devices</span><br><span class="hljs-attr">Feb 14 11:25:38 host1.example kernel: : mpt2sas0:</span> <span class="hljs-string">_scsih_search_responding_raid_devices</span><br><span class="hljs-attr">Feb 14 11:25:38 host1.example kernel: : mpt2sas0:</span> <span class="hljs-string">_scsih_search_responding_expanders</span><br><span class="hljs-attr">Feb 14 11:25:38 host1.example kernel: : mpt2sas0: _base_fault_reset_work: hard reset:</span> <span class="hljs-string">success</span><br><span class="hljs-attr">Feb 14 11:25:38 host1.example kernel: : mpt2sas0:</span> <span class="hljs-string">_scsih_search_responding_expanders</span><br><span class="hljs-attr">Feb 14 11:25:38 host1.example kernel: : mpt2sas0: _base_fault_reset_work: hard reset:</span> <span class="hljs-string">success</span><br><span class="hljs-string">...</span><br><span class="hljs-attr">Feb 14 13:46:48 host1.example kernel: : mpt2sas0:</span> <span class="hljs-string">fault_state(0x5841)!</span><br><span class="hljs-attr">Feb 14 13:46:48 host1.example kernel: : mpt2sas0:</span> <span class="hljs-string">sending</span> <span class="hljs-string">diag</span> <span class="hljs-string">reset</span> <span class="hljs-string">!!</span><br><span class="hljs-string">```</span> <br><br><span class="hljs-comment">### SATA log</span><br><span class="hljs-string">```bash</span><br><span class="hljs-comment"># smartctl man page</span><br><span class="hljs-string">error</span>  <span class="hljs-bullet">-</span>  [<span class="hljs-string">ATA</span>]  <span class="hljs-string">prints</span>  <span class="hljs-string">the</span> <span class="hljs-string">Summary</span> <span class="hljs-string">SMART</span> <span class="hljs-string">error</span> <span class="hljs-string">log.</span> <span class="hljs-string">SMART</span> <span class="hljs-string">disks</span> <span class="hljs-string">maintain</span> <span class="hljs-string">a</span> <span class="hljs-string">log</span> <span class="hljs-string">of</span> <span class="hljs-string">the</span> <span class="hljs-string">most</span> <span class="hljs-string">recent</span> <span class="hljs-string">five</span> <span class="hljs-string">non-trivial</span> <span class="hljs-string">errors.</span> <span class="hljs-string">For</span> <span class="hljs-string">each</span> <span class="hljs-string">of</span> <span class="hljs-string">these</span> <span class="hljs-string">errors,</span> <span class="hljs-string">the</span> <span class="hljs-string">disk</span> <span class="hljs-string">power-on</span> <span class="hljs-string">lifetime</span> <span class="hljs-string">at</span> <span class="hljs-string">which</span> <span class="hljs-string">the</span> <span class="hljs-string">error</span> <span class="hljs-string">occurred</span> <span class="hljs-string">is</span> <span class="hljs-string">recorded,</span> <span class="hljs-string">as</span> <span class="hljs-string">is</span> <span class="hljs-string">the</span> <span class="hljs-string">device</span> <span class="hljs-string">status</span>  <span class="hljs-string">(idle,</span> <span class="hljs-string">standby,</span>  <span class="hljs-string">etc)</span>  <span class="hljs-string">at</span>  <span class="hljs-string">the</span> <span class="hljs-string">time</span> <span class="hljs-string">of</span> <span class="hljs-string">the</span> <span class="hljs-string">error.</span>  <span class="hljs-string">For</span> <span class="hljs-string">some</span> <span class="hljs-string">common</span> <span class="hljs-string">types</span> <span class="hljs-string">of</span> <span class="hljs-string">errors,</span> <span class="hljs-string">the</span> <span class="hljs-string">Error</span> <span class="hljs-string">Register</span> <span class="hljs-string">(ER)</span> <span class="hljs-string">and</span> <span class="hljs-string">Status</span> <span class="hljs-string">Register</span> <span class="hljs-string">(SR)</span> <span class="hljs-attr">values are decoded and printed as text. The meanings of these are:</span><br>   <span class="hljs-attr">ABRT:</span>  <span class="hljs-string">Command</span> <span class="hljs-string">ABoRTed</span><br>   <span class="hljs-attr">AMNF:</span>  <span class="hljs-string">Address</span> <span class="hljs-string">Mark</span> <span class="hljs-string">Not</span> <span class="hljs-string">Found</span><br>   <span class="hljs-attr">CCTO:</span>  <span class="hljs-string">Command</span> <span class="hljs-string">Completion</span> <span class="hljs-string">Timed</span> <span class="hljs-string">Out</span><br>   <span class="hljs-attr">EOM:</span>   <span class="hljs-string">End</span> <span class="hljs-string">Of</span> <span class="hljs-string">Media</span><br>   <span class="hljs-attr">ICRC:</span>  <span class="hljs-string">Interface</span> <span class="hljs-string">Cyclic</span> <span class="hljs-string">Redundancy</span> <span class="hljs-string">Code</span> <span class="hljs-string">(CRC)</span> <span class="hljs-string">error</span><br>   <span class="hljs-attr">IDNF:</span>  <span class="hljs-string">IDentity</span> <span class="hljs-string">Not</span> <span class="hljs-string">Found</span><br>   <span class="hljs-attr">ILI:</span>   <span class="hljs-string">(packet</span> <span class="hljs-string">command-set</span> <span class="hljs-string">specific)</span><br>   <span class="hljs-attr">MC:</span>    <span class="hljs-string">Media</span> <span class="hljs-string">Changed</span><br>   <span class="hljs-attr">MCR:</span>   <span class="hljs-string">Media</span> <span class="hljs-string">Change</span> <span class="hljs-string">Request</span><br>   <span class="hljs-attr">NM:</span>    <span class="hljs-literal">No</span> <span class="hljs-string">Media</span><br>   <span class="hljs-attr">obs:</span>   <span class="hljs-string">obsolete</span><br>   <span class="hljs-attr">TK0NF:</span> <span class="hljs-string">TracK</span> <span class="hljs-number">0</span> <span class="hljs-string">Not</span> <span class="hljs-string">Found</span><br>   <span class="hljs-attr">UNC:</span>   <span class="hljs-string">UNCorrectable</span> <span class="hljs-string">Error</span> <span class="hljs-string">in</span> <span class="hljs-string">Data</span><br>   <span class="hljs-attr">WP:</span>    <span class="hljs-string">Media</span> <span class="hljs-string">is</span> <span class="hljs-string">Write</span> <span class="hljs-string">Protected</span><br><br><span class="hljs-string">$</span> <span class="hljs-string">smartctl</span> <span class="hljs-string">-l</span> <span class="hljs-string">statphy</span> <span class="hljs-string">/dev/sdb&quot;</span><br><span class="hljs-string">smartctl</span> <span class="hljs-number">6.6</span> <span class="hljs-number">2017-11-05 </span><span class="hljs-string">r4594</span> [<span class="hljs-string">x86_64-linux-4.18.0-80.11.2.el8_0.x86_64</span>] <span class="hljs-string">(local</span> <span class="hljs-string">build)</span><br><span class="hljs-string">Copyright</span> <span class="hljs-string">(C)</span> <span class="hljs-number">2002-17</span><span class="hljs-string">,</span> <span class="hljs-string">Bruce</span> <span class="hljs-string">Allen,</span> <span class="hljs-string">Christian</span> <span class="hljs-string">Franke,</span> <span class="hljs-string">www.smartmontools.org</span><br><br><span class="hljs-string">=======&gt;</span> <span class="hljs-attr">INVALID ARGUMENT TO -l:</span> <span class="hljs-string">statphy</span><br><span class="hljs-string">=======&gt;</span> <span class="hljs-attr">VALID ARGUMENTS ARE:</span> <span class="hljs-string">error,</span> <span class="hljs-string">selftest,</span> <span class="hljs-string">selective,</span> <span class="hljs-string">directory[,g|s],</span> <span class="hljs-string">xerror[,N][,error],</span> <span class="hljs-string">xselftest[,N][,selftest],</span> <span class="hljs-string">background,</span> <span class="hljs-string">sasphy[,reset],</span> <span class="hljs-string">sataphy[,reset],</span> <span class="hljs-string">scttemp[sts,hist],</span> <span class="hljs-string">scttempint,N[,p],</span> <span class="hljs-string">scterc[,N,M],</span> <span class="hljs-string">devstat[,N],</span> <span class="hljs-string">defects[,N],</span> <span class="hljs-string">ssd,</span> <span class="hljs-string">gplog,N[,RANGE],</span> <span class="hljs-string">smartlog,N[,RANGE],</span> <span class="hljs-string">nvmelog,N,SIZE</span> <span class="hljs-string">&lt;=======</span><br><br><span class="hljs-string">Use</span> <span class="hljs-string">smartctl</span> <span class="hljs-string">-h</span> <span class="hljs-string">to</span> <span class="hljs-string">get</span> <span class="hljs-string">a</span> <span class="hljs-string">usage</span> <span class="hljs-string">summary</span><br><br><span class="hljs-string">$</span> <span class="hljs-string">smartctl</span> <span class="hljs-string">-l</span> <span class="hljs-string">sataphy</span> <span class="hljs-string">/dev/sdb</span><br><span class="hljs-string">smartctl</span> <span class="hljs-number">6.6</span> <span class="hljs-number">2017-11-05 </span><span class="hljs-string">r4594</span> [<span class="hljs-string">x86_64-linux-4.18.0-80.11.2.el8_0.x86_64</span>] <span class="hljs-string">(local</span> <span class="hljs-string">build)</span><br><span class="hljs-string">Copyright</span> <span class="hljs-string">(C)</span> <span class="hljs-number">2002-17</span><span class="hljs-string">,</span> <span class="hljs-string">Bruce</span> <span class="hljs-string">Allen,</span> <span class="hljs-string">Christian</span> <span class="hljs-string">Franke,</span> <span class="hljs-string">www.smartmontools.org</span><br><br><span class="hljs-string">SATA</span> <span class="hljs-string">Phy</span> <span class="hljs-string">Event</span> <span class="hljs-string">Counters</span> <span class="hljs-string">(GP</span> <span class="hljs-string">Log</span> <span class="hljs-number">0x11</span><span class="hljs-string">)</span><br><span class="hljs-string">ID</span>      <span class="hljs-string">Size</span>     <span class="hljs-string">Value</span>  <span class="hljs-string">Description</span><br><span class="hljs-number">0x0001</span>  <span class="hljs-number">2</span>            <span class="hljs-number">0</span>  <span class="hljs-string">Command</span> <span class="hljs-string">failed</span> <span class="hljs-string">due</span> <span class="hljs-string">to</span> <span class="hljs-string">ICRC</span> <span class="hljs-string">error</span><br><span class="hljs-number">0x0002</span>  <span class="hljs-number">2</span>            <span class="hljs-number">0</span>  <span class="hljs-string">R_ERR</span> <span class="hljs-string">response</span> <span class="hljs-string">for</span> <span class="hljs-string">data</span> <span class="hljs-string">FIS</span><br><span class="hljs-number">0x0003</span>  <span class="hljs-number">2</span>            <span class="hljs-number">0</span>  <span class="hljs-string">R_ERR</span> <span class="hljs-string">response</span> <span class="hljs-string">for</span> <span class="hljs-string">device-to-host</span> <span class="hljs-string">data</span> <span class="hljs-string">FIS</span><br><span class="hljs-number">0x0004</span>  <span class="hljs-number">2</span>            <span class="hljs-number">0</span>  <span class="hljs-string">R_ERR</span> <span class="hljs-string">response</span> <span class="hljs-string">for</span> <span class="hljs-string">host-to-device</span> <span class="hljs-string">data</span> <span class="hljs-string">FIS</span><br><span class="hljs-number">0x0005</span>  <span class="hljs-number">2</span>            <span class="hljs-number">0</span>  <span class="hljs-string">R_ERR</span> <span class="hljs-string">response</span> <span class="hljs-string">for</span> <span class="hljs-string">non-data</span> <span class="hljs-string">FIS</span><br><span class="hljs-number">0x0006</span>  <span class="hljs-number">2</span>            <span class="hljs-number">0</span>  <span class="hljs-string">R_ERR</span> <span class="hljs-string">response</span> <span class="hljs-string">for</span> <span class="hljs-string">device-to-host</span> <span class="hljs-string">non-data</span> <span class="hljs-string">FIS</span><br><span class="hljs-number">0x0007</span>  <span class="hljs-number">2</span>            <span class="hljs-number">0</span>  <span class="hljs-string">R_ERR</span> <span class="hljs-string">response</span> <span class="hljs-string">for</span> <span class="hljs-string">host-to-device</span> <span class="hljs-string">non-data</span> <span class="hljs-string">FIS</span><br><span class="hljs-number">0x0008</span>  <span class="hljs-number">2</span>            <span class="hljs-number">0</span>  <span class="hljs-string">Device-to-host</span> <span class="hljs-string">non-data</span> <span class="hljs-string">FIS</span> <span class="hljs-string">retries</span><br><span class="hljs-number">0x0009</span>  <span class="hljs-number">2</span>            <span class="hljs-number">0</span>  <span class="hljs-string">Transition</span> <span class="hljs-string">from</span> <span class="hljs-string">drive</span> <span class="hljs-string">PhyRdy</span> <span class="hljs-string">to</span> <span class="hljs-string">drive</span> <span class="hljs-string">PhyNRdy</span><br><span class="hljs-number">0x000a</span>  <span class="hljs-number">2</span>            <span class="hljs-number">1</span>  <span class="hljs-string">Device-to-host</span> <span class="hljs-string">register</span> <span class="hljs-string">FISes</span> <span class="hljs-string">sent</span> <span class="hljs-string">due</span> <span class="hljs-string">to</span> <span class="hljs-string">a</span> <span class="hljs-string">COMRESET</span><br><span class="hljs-number">0x000b</span>  <span class="hljs-number">2</span>            <span class="hljs-number">0</span>  <span class="hljs-string">CRC</span> <span class="hljs-string">errors</span> <span class="hljs-string">within</span> <span class="hljs-string">host-to-device</span> <span class="hljs-string">FIS</span><br><span class="hljs-number">0x000d</span>  <span class="hljs-number">2</span>            <span class="hljs-number">0</span>  <span class="hljs-string">Non-CRC</span> <span class="hljs-string">errors</span> <span class="hljs-string">within</span> <span class="hljs-string">host-to-device</span> <span class="hljs-string">FIS</span><br><br><span class="hljs-comment">#except phy error, the smart attr will show some error too</span><br><span class="hljs-string">SMART</span> <span class="hljs-number">5</span> <span class="hljs-bullet">-</span> <span class="hljs-string">Reallocated_Sector_Count.</span><br><span class="hljs-string">SMART</span> <span class="hljs-number">187</span> <span class="hljs-bullet">-</span> <span class="hljs-string">Reported_Uncorrectable_Errors.</span><br><span class="hljs-string">SMART</span> <span class="hljs-number">188</span> <span class="hljs-bullet">-</span> <span class="hljs-string">Command_Timeout.</span><br><span class="hljs-string">SMART</span> <span class="hljs-number">197</span> <span class="hljs-bullet">-</span> <span class="hljs-string">Current_Pending_Sector_Count.</span><br><span class="hljs-string">SMART</span> <span class="hljs-number">198</span> <span class="hljs-bullet">-</span> <span class="hljs-string">Offline_Uncorrectable</span><br><br><span class="hljs-string">$</span> <span class="hljs-string">smartclt</span> <span class="hljs-string">-l</span> <span class="hljs-string">defects</span> <span class="hljs-string">-x</span> <span class="hljs-string">/dev/sdx</span><br><span class="hljs-string">===</span> <span class="hljs-string">START</span> <span class="hljs-string">OF</span> <span class="hljs-string">INFORMATION</span> <span class="hljs-string">SECTION</span> <span class="hljs-string">===</span><br><span class="hljs-attr">Model Family:</span>     <span class="hljs-string">HGST</span> <span class="hljs-string">Ultrastar</span> <span class="hljs-string">He10</span><br><span class="hljs-attr">Device Model:</span>     <span class="hljs-string">HGST</span> <span class="hljs-string">HUH721010ALE600</span><br><span class="hljs-attr">Serial Number:</span>    <span class="hljs-string">XXXXXXXXXX</span><br><span class="hljs-attr">LU WWN Device Id:</span> <span class="hljs-number">5</span> <span class="hljs-string">000cca</span> <span class="hljs-string">xxxxxxxx</span><br><span class="hljs-attr">Add. Product Id:</span>  <span class="hljs-string">XXXXXX</span><br><span class="hljs-attr">Firmware Version:</span> <span class="hljs-string">LHDELT14</span><br><span class="hljs-attr">User Capacity:</span>    <span class="hljs-number">10</span><span class="hljs-string">,000,831,348,736</span> <span class="hljs-string">bytes</span> [<span class="hljs-number">10.0</span> <span class="hljs-string">TB</span>]<br><span class="hljs-attr">Sector Sizes:</span>     <span class="hljs-number">512</span> <span class="hljs-string">bytes</span> <span class="hljs-string">logical,</span> <span class="hljs-number">4096 </span><span class="hljs-string">bytes</span> <span class="hljs-string">physical</span><br><span class="hljs-attr">Rotation Rate:</span>    <span class="hljs-number">7200 </span><span class="hljs-string">rpm</span><br><span class="hljs-attr">Form Factor:</span>      <span class="hljs-number">3.5</span> <span class="hljs-string">inches</span><br><span class="hljs-attr">Device is:</span>        <span class="hljs-string">In</span> <span class="hljs-string">smartctl</span> <span class="hljs-string">database</span> [<span class="hljs-attr">for details use:</span> <span class="hljs-string">-P</span> <span class="hljs-string">show</span>]<br><span class="hljs-attr">ATA Version is:</span>   <span class="hljs-string">ACS-2,</span> <span class="hljs-string">ATA8-ACS</span> <span class="hljs-string">T13/1699-D</span> <span class="hljs-string">revision</span> <span class="hljs-number">4</span><br><span class="hljs-attr">SATA Version is:</span>  <span class="hljs-string">SATA</span> <span class="hljs-number">3.2</span><span class="hljs-string">,</span> <span class="hljs-number">6.0</span> <span class="hljs-string">Gb/s</span> <span class="hljs-string">(current:</span> <span class="hljs-number">6.0</span> <span class="hljs-string">Gb/s)</span><br><span class="hljs-attr">Local Time is:</span>    <span class="hljs-string">Tue</span> <span class="hljs-string">Dec</span> <span class="hljs-number">10</span> <span class="hljs-number">11</span><span class="hljs-string">:18:58</span> <span class="hljs-number">2019 </span><span class="hljs-string">EST</span><br><span class="hljs-attr">SMART support is:</span> <span class="hljs-string">Available</span> <span class="hljs-bullet">-</span> <span class="hljs-string">device</span> <span class="hljs-string">has</span> <span class="hljs-string">SMART</span> <span class="hljs-string">capability.</span><br><span class="hljs-attr">SMART support is:</span> <span class="hljs-string">Enabled</span><br><span class="hljs-attr">AAM feature is:</span>   <span class="hljs-string">Unavailable</span><br><span class="hljs-attr">APM feature is:</span>   <span class="hljs-string">Disabled</span><br><span class="hljs-attr">Rd look-ahead is:</span> <span class="hljs-string">Enabled</span><br><span class="hljs-attr">Write cache is:</span>   <span class="hljs-string">Disabled</span><br><span class="hljs-attr">DSN feature is:</span>   <span class="hljs-string">Unavailable</span><br><span class="hljs-attr">ATA Security is:</span>  <span class="hljs-string">Disabled,</span> <span class="hljs-string">NOT</span> <span class="hljs-string">FROZEN</span> [<span class="hljs-string">SEC1</span>]<br><span class="hljs-attr">Wt Cache Reorder:</span> <span class="hljs-string">Enabled</span><br><br><span class="hljs-string">===</span> <span class="hljs-string">START</span> <span class="hljs-string">OF</span> <span class="hljs-string">READ</span> <span class="hljs-string">SMART</span> <span class="hljs-string">DATA</span> <span class="hljs-string">SECTION</span> <span class="hljs-string">===</span><br><span class="hljs-attr">SMART overall-health self-assessment test result:</span> <span class="hljs-string">PASSED</span><br><br><span class="hljs-attr">General SMART Values:</span><br><span class="hljs-attr">Offline data collection status:</span>  <span class="hljs-string">(0x82)</span> <span class="hljs-string">Offline</span> <span class="hljs-string">data</span> <span class="hljs-string">collection</span> <span class="hljs-string">activity</span><br>                                        <span class="hljs-string">was</span> <span class="hljs-string">completed</span> <span class="hljs-string">without</span> <span class="hljs-string">error.</span><br>                                        <span class="hljs-attr">Auto Offline Data Collection:</span> <span class="hljs-string">Enabled.</span><br><span class="hljs-attr">Self-test execution status:</span>      <span class="hljs-string">(</span>  <span class="hljs-number">40</span><span class="hljs-string">)</span> <span class="hljs-string">The</span> <span class="hljs-string">self-test</span> <span class="hljs-string">routine</span> <span class="hljs-string">was</span> <span class="hljs-string">interrupted</span><br>                                        <span class="hljs-string">by</span> <span class="hljs-string">the</span> <span class="hljs-string">host</span> <span class="hljs-string">with</span> <span class="hljs-string">a</span> <span class="hljs-string">hard</span> <span class="hljs-string">or</span> <span class="hljs-string">soft</span> <span class="hljs-string">reset.</span><br><span class="hljs-string">Total</span> <span class="hljs-string">time</span> <span class="hljs-string">to</span> <span class="hljs-string">complete</span> <span class="hljs-string">Offline</span><br><span class="hljs-attr">data collection:</span>                <span class="hljs-string">(</span>   <span class="hljs-number">90</span><span class="hljs-string">)</span> <span class="hljs-string">seconds.</span><br><span class="hljs-string">Offline</span> <span class="hljs-string">data</span> <span class="hljs-string">collection</span><br><span class="hljs-attr">capabilities:</span>                    <span class="hljs-string">(0x5b)</span> <span class="hljs-string">SMART</span> <span class="hljs-string">execute</span> <span class="hljs-string">Offline</span> <span class="hljs-string">immediate.</span><br>                                        <span class="hljs-string">Auto</span> <span class="hljs-string">Offline</span> <span class="hljs-string">data</span> <span class="hljs-string">collection</span> <span class="hljs-string">on/off</span> <span class="hljs-string">support.</span><br>                                        <span class="hljs-string">Suspend</span> <span class="hljs-string">Offline</span> <span class="hljs-string">collection</span> <span class="hljs-string">upon</span> <span class="hljs-string">new</span><br>                                        <span class="hljs-string">command.</span><br>                                        <span class="hljs-string">Offline</span> <span class="hljs-string">surface</span> <span class="hljs-string">scan</span> <span class="hljs-string">supported.</span><br>                                        <span class="hljs-string">Self-test</span> <span class="hljs-string">supported.</span><br>                                        <span class="hljs-literal">No</span> <span class="hljs-string">Conveyance</span> <span class="hljs-string">Self-test</span> <span class="hljs-string">supported.</span><br>                                        <span class="hljs-string">Selective</span> <span class="hljs-string">Self-test</span> <span class="hljs-string">supported.</span><br><span class="hljs-attr">SMART capabilities:</span>            <span class="hljs-string">(0x0003)</span> <span class="hljs-string">Saves</span> <span class="hljs-string">SMART</span> <span class="hljs-string">data</span> <span class="hljs-string">before</span> <span class="hljs-string">entering</span><br>                                        <span class="hljs-string">power-saving</span> <span class="hljs-string">mode.</span><br>                                        <span class="hljs-string">Supports</span> <span class="hljs-string">SMART</span> <span class="hljs-string">auto</span> <span class="hljs-string">save</span> <span class="hljs-string">timer.</span><br><span class="hljs-attr">Error logging capability:</span>        <span class="hljs-string">(0x01)</span> <span class="hljs-string">Error</span> <span class="hljs-string">logging</span> <span class="hljs-string">supported.</span><br>                                        <span class="hljs-string">General</span> <span class="hljs-string">Purpose</span> <span class="hljs-string">Logging</span> <span class="hljs-string">supported.</span><br><span class="hljs-string">Short</span> <span class="hljs-string">self-test</span> <span class="hljs-string">routine</span><br><span class="hljs-attr">recommended polling time:</span>        <span class="hljs-string">(</span>   <span class="hljs-number">2</span><span class="hljs-string">)</span> <span class="hljs-string">minutes.</span><br><span class="hljs-string">Extended</span> <span class="hljs-string">self-test</span> <span class="hljs-string">routine</span><br><span class="hljs-attr">recommended polling time:</span>        <span class="hljs-string">(1063)</span> <span class="hljs-string">minutes.</span><br><span class="hljs-attr">SCT capabilities:</span>              <span class="hljs-string">(0x003d)</span> <span class="hljs-string">SCT</span> <span class="hljs-string">Status</span> <span class="hljs-string">supported.</span><br>                                        <span class="hljs-string">SCT</span> <span class="hljs-string">Error</span> <span class="hljs-string">Recovery</span> <span class="hljs-string">Control</span> <span class="hljs-string">supported.</span><br>                                        <span class="hljs-string">SCT</span> <span class="hljs-string">Feature</span> <span class="hljs-string">Control</span> <span class="hljs-string">supported.</span><br>                                        <span class="hljs-string">SCT</span> <span class="hljs-string">Data</span> <span class="hljs-string">Table</span> <span class="hljs-string">supported.</span><br><br><span class="hljs-attr">SMART Attributes Data Structure revision number:</span> <span class="hljs-number">16</span><br><span class="hljs-attr">Vendor Specific SMART Attributes with Thresholds:</span><br><span class="hljs-string">ID#</span> <span class="hljs-string">ATTRIBUTE_NAME</span>          <span class="hljs-string">FLAGS</span>    <span class="hljs-string">VALUE</span> <span class="hljs-string">WORST</span> <span class="hljs-string">THRESH</span> <span class="hljs-string">FAIL</span> <span class="hljs-string">RAW_VALUE</span><br>  <span class="hljs-number">1</span> <span class="hljs-string">Raw_Read_Error_Rate</span>     <span class="hljs-string">PO-R--</span>   <span class="hljs-number">100</span>   <span class="hljs-number">100</span>   <span class="hljs-number">016</span>    <span class="hljs-bullet">-</span>    <span class="hljs-number">0</span><br>  <span class="hljs-number">2</span> <span class="hljs-string">Throughput_Performance</span>  <span class="hljs-string">--S---</span>   <span class="hljs-number">134</span>   <span class="hljs-number">134</span>   <span class="hljs-number">000</span>    <span class="hljs-bullet">-</span>    <span class="hljs-number">96</span><br>  <span class="hljs-number">3</span> <span class="hljs-string">Spin_Up_Time</span>            <span class="hljs-string">POS---</span>   <span class="hljs-number">191</span>   <span class="hljs-number">191</span>   <span class="hljs-number">024</span>    <span class="hljs-bullet">-</span>    <span class="hljs-number">344</span> <span class="hljs-string">(Average</span> <span class="hljs-number">344</span><span class="hljs-string">)</span><br>  <span class="hljs-number">4</span> <span class="hljs-string">Start_Stop_Count</span>        <span class="hljs-string">-O--C-</span>   <span class="hljs-number">100</span>   <span class="hljs-number">100</span>   <span class="hljs-number">000</span>    <span class="hljs-bullet">-</span>    <span class="hljs-number">33</span><br>  <span class="hljs-number">5</span> <span class="hljs-string">Reallocated_Sector_Ct</span>   <span class="hljs-string">PO--CK</span>   <span class="hljs-number">100</span>   <span class="hljs-number">100</span>   <span class="hljs-number">005</span>    <span class="hljs-bullet">-</span>    <span class="hljs-number">0</span><br>  <span class="hljs-number">7</span> <span class="hljs-string">Seek_Error_Rate</span>         <span class="hljs-string">-O-R--</span>   <span class="hljs-number">100</span>   <span class="hljs-number">100</span>   <span class="hljs-number">000</span>    <span class="hljs-bullet">-</span>    <span class="hljs-number">0</span><br>  <span class="hljs-number">8</span> <span class="hljs-string">Seek_Time_Performance</span>   <span class="hljs-string">--S---</span>   <span class="hljs-number">128</span>   <span class="hljs-number">128</span>   <span class="hljs-number">000</span>    <span class="hljs-bullet">-</span>    <span class="hljs-number">18</span><br>  <span class="hljs-number">9</span> <span class="hljs-string">Power_On_Hours</span>          <span class="hljs-string">-O--C-</span>   <span class="hljs-number">099</span>   <span class="hljs-number">099</span>   <span class="hljs-number">000</span>    <span class="hljs-bullet">-</span>    <span class="hljs-number">7599</span><br> <span class="hljs-number">10</span> <span class="hljs-string">Spin_Retry_Count</span>        <span class="hljs-string">-O--C-</span>   <span class="hljs-number">100</span>   <span class="hljs-number">100</span>   <span class="hljs-number">000</span>    <span class="hljs-bullet">-</span>    <span class="hljs-number">0</span><br> <span class="hljs-number">12</span> <span class="hljs-string">Power_Cycle_Count</span>       <span class="hljs-string">-O--CK</span>   <span class="hljs-number">100</span>   <span class="hljs-number">100</span>   <span class="hljs-number">000</span>    <span class="hljs-bullet">-</span>    <span class="hljs-number">33</span><br> <span class="hljs-number">22</span> <span class="hljs-string">Helium_Level</span>            <span class="hljs-string">PO---K</span>   <span class="hljs-number">100</span>   <span class="hljs-number">100</span>   <span class="hljs-number">025</span>    <span class="hljs-bullet">-</span>    <span class="hljs-number">100</span><br><span class="hljs-number">192</span> <span class="hljs-string">Power-Off_Retract_Count</span> <span class="hljs-string">-O--CK</span>   <span class="hljs-number">100</span>   <span class="hljs-number">100</span>   <span class="hljs-number">000</span>    <span class="hljs-bullet">-</span>    <span class="hljs-number">547</span><br><span class="hljs-number">193</span> <span class="hljs-string">Load_Cycle_Count</span>        <span class="hljs-string">-O--C-</span>   <span class="hljs-number">100</span>   <span class="hljs-number">100</span>   <span class="hljs-number">000</span>    <span class="hljs-bullet">-</span>    <span class="hljs-number">547</span><br><span class="hljs-number">194</span> <span class="hljs-string">Temperature_Celsius</span>     <span class="hljs-string">-O----</span>   <span class="hljs-number">206</span>   <span class="hljs-number">206</span>   <span class="hljs-number">000</span>    <span class="hljs-bullet">-</span>    <span class="hljs-number">29</span> <span class="hljs-string">(Min/Max</span> <span class="hljs-number">24</span><span class="hljs-string">/32)</span><br><span class="hljs-number">196</span> <span class="hljs-string">Reallocated_Event_Count</span> <span class="hljs-string">-O--CK</span>   <span class="hljs-number">100</span>   <span class="hljs-number">100</span>   <span class="hljs-number">000</span>    <span class="hljs-bullet">-</span>    <span class="hljs-number">0</span><br><span class="hljs-number">197</span> <span class="hljs-string">Current_Pending_Sector</span>  <span class="hljs-string">-O---K</span>   <span class="hljs-number">100</span>   <span class="hljs-number">100</span>   <span class="hljs-number">000</span>    <span class="hljs-bullet">-</span>    <span class="hljs-number">0</span><br><span class="hljs-number">198</span> <span class="hljs-string">Offline_Uncorrectable</span>   <span class="hljs-string">---R--</span>   <span class="hljs-number">100</span>   <span class="hljs-number">100</span>   <span class="hljs-number">000</span>    <span class="hljs-bullet">-</span>    <span class="hljs-number">0</span><br><span class="hljs-number">199</span> <span class="hljs-string">UDMA_CRC_Error_Count</span>    <span class="hljs-string">-O-R--</span>   <span class="hljs-number">200</span>   <span class="hljs-number">200</span>   <span class="hljs-number">000</span>    <span class="hljs-bullet">-</span>    <span class="hljs-number">0</span><br><span class="hljs-number">223</span> <span class="hljs-string">Load_Retry_Count</span>        <span class="hljs-string">-O-R--</span>   <span class="hljs-number">100</span>   <span class="hljs-number">100</span>   <span class="hljs-number">000</span>    <span class="hljs-bullet">-</span>    <span class="hljs-number">0</span><br><span class="hljs-number">241</span> <span class="hljs-string">Total_LBAs_Written</span>      <span class="hljs-string">-O--C-</span>   <span class="hljs-number">100</span>   <span class="hljs-number">100</span>   <span class="hljs-number">000</span>    <span class="hljs-bullet">-</span>    <span class="hljs-number">50732585533</span><br><span class="hljs-number">242</span> <span class="hljs-string">Total_LBAs_Read</span>         <span class="hljs-string">-O--C-</span>   <span class="hljs-number">100</span>   <span class="hljs-number">100</span>   <span class="hljs-number">000</span>    <span class="hljs-bullet">-</span>    <span class="hljs-number">26707853436</span><br>                            <span class="hljs-string">||||||_</span> <span class="hljs-string">K</span> <span class="hljs-string">auto-keep</span><br>                            <span class="hljs-string">|||||__</span> <span class="hljs-string">C</span> <span class="hljs-string">event</span> <span class="hljs-string">count</span><br>                            <span class="hljs-string">||||___</span> <span class="hljs-string">R</span> <span class="hljs-string">error</span> <span class="hljs-string">rate</span><br>                            <span class="hljs-string">|||____</span> <span class="hljs-string">S</span> <span class="hljs-string">speed/performance</span><br>                            <span class="hljs-string">||_____</span> <span class="hljs-string">O</span> <span class="hljs-string">updated</span> <span class="hljs-string">online</span><br>                            <span class="hljs-string">|______</span> <span class="hljs-string">P</span> <span class="hljs-string">prefailure</span> <span class="hljs-string">warning</span><br><br><span class="hljs-string">General</span> <span class="hljs-string">Purpose</span> <span class="hljs-string">Log</span> <span class="hljs-string">Directory</span> <span class="hljs-string">Version</span> <span class="hljs-number">1</span><br><span class="hljs-string">SMART</span>           <span class="hljs-string">Log</span> <span class="hljs-string">Directory</span> <span class="hljs-string">Version</span> <span class="hljs-number">1</span> [<span class="hljs-string">multi-sector</span> <span class="hljs-string">log</span> <span class="hljs-string">support</span>]<br><span class="hljs-string">Address</span>    <span class="hljs-string">Access</span>  <span class="hljs-string">R/W</span>   <span class="hljs-string">Size</span>  <span class="hljs-string">Description</span><br><span class="hljs-number">0x00</span>       <span class="hljs-string">GPL,SL</span>  <span class="hljs-string">R/O</span>      <span class="hljs-number">1</span>  <span class="hljs-string">Log</span> <span class="hljs-string">Directory</span><br><span class="hljs-number">0x01</span>           <span class="hljs-string">SL</span>  <span class="hljs-string">R/O</span>      <span class="hljs-number">1</span>  <span class="hljs-string">Summary</span> <span class="hljs-string">SMART</span> <span class="hljs-string">error</span> <span class="hljs-string">log</span><br><span class="hljs-number">0x02</span>           <span class="hljs-string">SL</span>  <span class="hljs-string">R/O</span>      <span class="hljs-number">1</span>  <span class="hljs-string">Comprehensive</span> <span class="hljs-string">SMART</span> <span class="hljs-string">error</span> <span class="hljs-string">log</span><br><span class="hljs-number">0x03</span>       <span class="hljs-string">GPL</span>     <span class="hljs-string">R/O</span>      <span class="hljs-number">1</span>  <span class="hljs-string">Ext.</span> <span class="hljs-string">Comprehensive</span> <span class="hljs-string">SMART</span> <span class="hljs-string">error</span> <span class="hljs-string">log</span><br><span class="hljs-number">0x04</span>       <span class="hljs-string">GPL</span>     <span class="hljs-string">R/O</span>    <span class="hljs-number">256</span>  <span class="hljs-string">Device</span> <span class="hljs-string">Statistics</span> <span class="hljs-string">log</span><br><span class="hljs-number">0x04</span>       <span class="hljs-string">SL</span>      <span class="hljs-string">R/O</span>    <span class="hljs-number">255</span>  <span class="hljs-string">Device</span> <span class="hljs-string">Statistics</span> <span class="hljs-string">log</span><br><span class="hljs-number">0x06</span>           <span class="hljs-string">SL</span>  <span class="hljs-string">R/O</span>      <span class="hljs-number">1</span>  <span class="hljs-string">SMART</span> <span class="hljs-string">self-test</span> <span class="hljs-string">log</span><br><span class="hljs-number">0x07</span>       <span class="hljs-string">GPL</span>     <span class="hljs-string">R/O</span>      <span class="hljs-number">1</span>  <span class="hljs-string">Extended</span> <span class="hljs-string">self-test</span> <span class="hljs-string">log</span><br><span class="hljs-number">0x08</span>       <span class="hljs-string">GPL</span>     <span class="hljs-string">R/O</span>      <span class="hljs-number">2</span>  <span class="hljs-string">Power</span> <span class="hljs-string">Conditions</span> <span class="hljs-string">log</span><br><span class="hljs-number">0x09</span>           <span class="hljs-string">SL</span>  <span class="hljs-string">R/W</span>      <span class="hljs-number">1</span>  <span class="hljs-string">Selective</span> <span class="hljs-string">self-test</span> <span class="hljs-string">log</span><br><span class="hljs-number">0x0c</span>       <span class="hljs-string">GPL</span>     <span class="hljs-string">R/O</span>   <span class="hljs-number">5501  </span><span class="hljs-string">Pending</span> <span class="hljs-string">Defects</span> <span class="hljs-string">log</span><br><span class="hljs-number">0x10</span>       <span class="hljs-string">GPL</span>     <span class="hljs-string">R/O</span>      <span class="hljs-number">1</span>  <span class="hljs-string">NCQ</span> <span class="hljs-string">Command</span> <span class="hljs-string">Error</span> <span class="hljs-string">log</span><br><span class="hljs-number">0x11</span>       <span class="hljs-string">GPL</span>     <span class="hljs-string">R/O</span>      <span class="hljs-number">1</span>  <span class="hljs-string">SATA</span> <span class="hljs-string">Phy</span> <span class="hljs-string">Event</span> <span class="hljs-string">Counters</span> <span class="hljs-string">log</span><br><span class="hljs-number">0x12</span>       <span class="hljs-string">GPL</span>     <span class="hljs-string">R/O</span>      <span class="hljs-number">1</span>  <span class="hljs-string">SATA</span> <span class="hljs-string">NCQ</span> <span class="hljs-string">Non-Data</span> <span class="hljs-string">log</span><br><span class="hljs-number">0x13</span>       <span class="hljs-string">GPL</span>     <span class="hljs-string">R/O</span>      <span class="hljs-number">1</span>  <span class="hljs-string">SATA</span> <span class="hljs-string">NCQ</span> <span class="hljs-string">Send</span> <span class="hljs-string">and</span> <span class="hljs-string">Receive</span> <span class="hljs-string">log</span><br><span class="hljs-number">0x21</span>       <span class="hljs-string">GPL</span>     <span class="hljs-string">R/O</span>      <span class="hljs-number">1</span>  <span class="hljs-string">Write</span> <span class="hljs-string">stream</span> <span class="hljs-string">error</span> <span class="hljs-string">log</span><br><span class="hljs-number">0x22</span>       <span class="hljs-string">GPL</span>     <span class="hljs-string">R/O</span>      <span class="hljs-number">1</span>  <span class="hljs-string">Read</span> <span class="hljs-string">stream</span> <span class="hljs-string">error</span> <span class="hljs-string">log</span><br><span class="hljs-number">0x24</span>       <span class="hljs-string">GPL</span>     <span class="hljs-string">R/O</span>    <span class="hljs-number">256</span>  <span class="hljs-string">Current</span> <span class="hljs-string">Device</span> <span class="hljs-string">Internal</span> <span class="hljs-string">Status</span> <span class="hljs-string">Data</span> <span class="hljs-string">log</span><br><span class="hljs-number">0x25</span>       <span class="hljs-string">GPL</span>     <span class="hljs-string">R/O</span>    <span class="hljs-number">256</span>  <span class="hljs-string">Saved</span> <span class="hljs-string">Device</span> <span class="hljs-string">Internal</span> <span class="hljs-string">Status</span> <span class="hljs-string">Data</span> <span class="hljs-string">log</span><br><span class="hljs-number">0x30</span>       <span class="hljs-string">GPL,SL</span>  <span class="hljs-string">R/O</span>      <span class="hljs-number">9</span>  <span class="hljs-string">IDENTIFY</span> <span class="hljs-string">DEVICE</span> <span class="hljs-string">data</span> <span class="hljs-string">log</span><br><span class="hljs-number">0x80</span><span class="hljs-number">-0x9f</span>  <span class="hljs-string">GPL,SL</span>  <span class="hljs-string">R/W</span>     <span class="hljs-number">16</span>  <span class="hljs-string">Host</span> <span class="hljs-string">vendor</span> <span class="hljs-string">specific</span> <span class="hljs-string">log</span><br><span class="hljs-number">0xdf</span>       <span class="hljs-string">GPL,SL</span>  <span class="hljs-string">VS</span>       <span class="hljs-number">1</span>  <span class="hljs-string">Device</span> <span class="hljs-string">vendor</span> <span class="hljs-string">specific</span> <span class="hljs-string">log</span><br><span class="hljs-number">0xe0</span>       <span class="hljs-string">GPL,SL</span>  <span class="hljs-string">R/W</span>      <span class="hljs-number">1</span>  <span class="hljs-string">SCT</span> <span class="hljs-string">Command/Status</span><br><span class="hljs-number">0xe1</span>       <span class="hljs-string">GPL,SL</span>  <span class="hljs-string">R/W</span>      <span class="hljs-number">1</span>  <span class="hljs-string">SCT</span> <span class="hljs-string">Data</span> <span class="hljs-string">Transfer</span><br><br><span class="hljs-attr">SMART Extended Comprehensive Error Log Version:</span> <span class="hljs-number">1</span> <span class="hljs-string">(1</span> <span class="hljs-string">sectors)</span><br><span class="hljs-literal">No</span> <span class="hljs-string">Errors</span> <span class="hljs-string">Logged</span><br><br><span class="hljs-attr">SMART Extended Self-test Log Version:</span> <span class="hljs-number">1</span> <span class="hljs-string">(1</span> <span class="hljs-string">sectors)</span><br><span class="hljs-string">Num</span>  <span class="hljs-string">Test_Description</span>    <span class="hljs-string">Status</span>                  <span class="hljs-string">Remaining</span>  <span class="hljs-string">LifeTime(hours)</span>  <span class="hljs-string">LBA_of_first_error</span><br><span class="hljs-comment"># 1  Short offline       Interrupted (host reset)      80%      7288         -</span><br><span class="hljs-comment"># 2  Short offline       Interrupted (host reset)      80%      5140         -</span><br><span class="hljs-comment"># 3  Short offline       Interrupted (host reset)      80%      3438         -</span><br><span class="hljs-comment"># 4  Short offline       Interrupted (host reset)      80%      3241         -</span><br><span class="hljs-comment"># 5  Short offline       Interrupted (host reset)      80%      3196         -</span><br><span class="hljs-comment"># 6  Short offline       Interrupted (host reset)      80%      3194         -</span><br><span class="hljs-comment"># 7  Short offline       Interrupted (host reset)      80%      3102         -</span><br><span class="hljs-comment"># 8  Short offline       Interrupted (host reset)      80%      3098         -</span><br><span class="hljs-comment"># 9  Short offline       Interrupted (host reset)      80%      3080         -</span><br><span class="hljs-comment">#10  Short offline       Interrupted (host reset)      80%      3080         -</span><br><span class="hljs-comment">#11  Short offline       Interrupted (host reset)      80%      3080         -</span><br><span class="hljs-comment">#12  Short offline       Interrupted (host reset)      80%      3080         -</span><br><span class="hljs-comment">#13  Short offline       Interrupted (host reset)      80%      3079         -</span><br><span class="hljs-comment">#14  Short offline       Interrupted (host reset)      80%      2574         -</span><br><span class="hljs-comment">#15  Short offline       Interrupted (host reset)      80%      1013         -</span><br><span class="hljs-comment">#16  Short offline       Interrupted (host reset)      70%      1011         -</span><br><span class="hljs-comment">#17  Short offline       Interrupted (host reset)      70%       938         -</span><br><span class="hljs-comment">#18  Short offline       Interrupted (host reset)      70%       814         -</span><br><span class="hljs-comment">#19  Short offline       Interrupted (host reset)      70%       281         -</span><br><br><span class="hljs-string">SMART</span> <span class="hljs-string">Selective</span> <span class="hljs-string">self-test</span> <span class="hljs-string">log</span> <span class="hljs-string">data</span> <span class="hljs-string">structure</span> <span class="hljs-string">revision</span> <span class="hljs-string">number</span> <span class="hljs-number">1</span><br> <span class="hljs-string">SPAN</span>  <span class="hljs-string">MIN_LBA</span>  <span class="hljs-string">MAX_LBA</span>  <span class="hljs-string">CURRENT_TEST_STATUS</span><br>    <span class="hljs-number">1</span>        <span class="hljs-number">0</span>        <span class="hljs-number">0</span>  <span class="hljs-string">Not_testing</span><br>    <span class="hljs-number">2</span>        <span class="hljs-number">0</span>        <span class="hljs-number">0</span>  <span class="hljs-string">Not_testing</span><br>    <span class="hljs-number">3</span>        <span class="hljs-number">0</span>        <span class="hljs-number">0</span>  <span class="hljs-string">Not_testing</span><br>    <span class="hljs-number">4</span>        <span class="hljs-number">0</span>        <span class="hljs-number">0</span>  <span class="hljs-string">Not_testing</span><br>    <span class="hljs-number">5</span>        <span class="hljs-number">0</span>        <span class="hljs-number">0</span>  <span class="hljs-string">Not_testing</span><br><span class="hljs-string">Selective</span> <span class="hljs-string">self-test</span> <span class="hljs-string">flags</span> <span class="hljs-string">(0x0):</span><br>  <span class="hljs-string">After</span> <span class="hljs-string">scanning</span> <span class="hljs-string">selected</span> <span class="hljs-string">spans,</span> <span class="hljs-string">do</span> <span class="hljs-string">NOT</span> <span class="hljs-string">read-scan</span> <span class="hljs-string">remainder</span> <span class="hljs-string">of</span> <span class="hljs-string">disk.</span><br><span class="hljs-string">If</span> <span class="hljs-string">Selective</span> <span class="hljs-string">self-test</span> <span class="hljs-string">is</span> <span class="hljs-string">pending</span> <span class="hljs-string">on</span> <span class="hljs-string">power-up,</span> <span class="hljs-string">resume</span> <span class="hljs-string">after</span> <span class="hljs-number">0</span> <span class="hljs-string">minute</span> <span class="hljs-string">delay.</span><br><br><span class="hljs-attr">SCT Status Version:</span>                  <span class="hljs-number">3</span><br><span class="hljs-string">SCT</span> <span class="hljs-string">Version</span> <span class="hljs-string">(vendor</span> <span class="hljs-string">specific):</span>       <span class="hljs-number">256</span> <span class="hljs-string">(0x0100)</span><br><span class="hljs-attr">SCT Support Level:</span>                   <span class="hljs-number">0</span><br><span class="hljs-attr">Device State:</span>                        <span class="hljs-string">Active</span> <span class="hljs-string">(0)</span><br><span class="hljs-attr">Current Temperature:</span>                    <span class="hljs-number">29</span> <span class="hljs-string">Celsius</span><br><span class="hljs-attr">Power Cycle Min/Max Temperature:</span>     <span class="hljs-number">28</span><span class="hljs-string">/30</span> <span class="hljs-string">Celsius</span><br><span class="hljs-attr">Lifetime    Min/Max Temperature:</span>     <span class="hljs-number">24</span><span class="hljs-string">/32</span> <span class="hljs-string">Celsius</span><br><span class="hljs-attr">Under/Over Temperature Limit Count:</span>   <span class="hljs-number">0</span><span class="hljs-string">/0</span><br><br><span class="hljs-attr">SCT Temperature History Version:</span>     <span class="hljs-number">2</span><br><span class="hljs-attr">Temperature Sampling Period:</span>         <span class="hljs-number">1</span> <span class="hljs-string">minute</span><br><span class="hljs-attr">Temperature Logging Interval:</span>        <span class="hljs-number">1</span> <span class="hljs-string">minute</span><br><span class="hljs-attr">Min/Max recommended Temperature:</span>      <span class="hljs-number">0</span><span class="hljs-string">/60</span> <span class="hljs-string">Celsius</span><br><span class="hljs-attr">Min/Max Temperature Limit:</span>           <span class="hljs-number">-40</span><span class="hljs-string">/70</span> <span class="hljs-string">Celsius</span><br><span class="hljs-string">Temperature</span> <span class="hljs-string">History</span> <span class="hljs-string">Size</span> <span class="hljs-string">(Index):</span>    <span class="hljs-number">128</span> <span class="hljs-string">(92)</span><br><span class="hljs-string">Index</span>    <span class="hljs-string">Estimated</span> <span class="hljs-string">Time</span>   <span class="hljs-string">Temperature</span> <span class="hljs-string">Celsius</span><br>  <span class="hljs-number">93</span>    <span class="hljs-number">2019-12-10 </span><span class="hljs-number">09</span><span class="hljs-string">:11</span>    <span class="hljs-number">29</span>  <span class="hljs-string">**********</span><br> <span class="hljs-string">...</span>    <span class="hljs-string">..(126</span> <span class="hljs-string">skipped).</span>    <span class="hljs-string">..</span>  <span class="hljs-string">**********</span><br>  <span class="hljs-number">92</span>    <span class="hljs-number">2019-12-10 </span><span class="hljs-number">11</span><span class="hljs-string">:18</span>    <span class="hljs-number">29</span>  <span class="hljs-string">**********</span><br><br><span class="hljs-attr">SCT Error Recovery Control:</span><br>           <span class="hljs-attr">Read:</span>     <span class="hljs-number">80</span> <span class="hljs-string">(8.0</span> <span class="hljs-string">seconds)</span><br>          <span class="hljs-attr">Write:</span>     <span class="hljs-number">80</span> <span class="hljs-string">(8.0</span> <span class="hljs-string">seconds)</span><br><br><span class="hljs-string">Device</span> <span class="hljs-string">Statistics</span> <span class="hljs-string">(GP/SMART</span> <span class="hljs-string">Log</span> <span class="hljs-number">0x04</span><span class="hljs-string">)</span> <span class="hljs-string">not</span> <span class="hljs-string">supported</span><br><br><span class="hljs-string">Pending</span> <span class="hljs-string">Defects</span> <span class="hljs-string">log</span> <span class="hljs-string">(GP</span> <span class="hljs-string">Log</span> <span class="hljs-number">0x0c</span><span class="hljs-string">)</span><br><span class="hljs-literal">No</span> <span class="hljs-string">Defects</span> <span class="hljs-string">Logged</span><br><br><span class="hljs-string">SATA</span> <span class="hljs-string">Phy</span> <span class="hljs-string">Event</span> <span class="hljs-string">Counters</span> <span class="hljs-string">(GP</span> <span class="hljs-string">Log</span> <span class="hljs-number">0x11</span><span class="hljs-string">)</span><br><span class="hljs-string">ID</span>      <span class="hljs-string">Size</span>     <span class="hljs-string">Value</span>  <span class="hljs-string">Description</span><br><span class="hljs-number">0x0001</span>  <span class="hljs-number">2</span>            <span class="hljs-number">0</span>  <span class="hljs-string">Command</span> <span class="hljs-string">failed</span> <span class="hljs-string">due</span> <span class="hljs-string">to</span> <span class="hljs-string">ICRC</span> <span class="hljs-string">error</span><br><span class="hljs-number">0x0002</span>  <span class="hljs-number">2</span>            <span class="hljs-number">0</span>  <span class="hljs-string">R_ERR</span> <span class="hljs-string">response</span> <span class="hljs-string">for</span> <span class="hljs-string">data</span> <span class="hljs-string">FIS</span><br><span class="hljs-number">0x0003</span>  <span class="hljs-number">2</span>            <span class="hljs-number">0</span>  <span class="hljs-string">R_ERR</span> <span class="hljs-string">response</span> <span class="hljs-string">for</span> <span class="hljs-string">device-to-host</span> <span class="hljs-string">data</span> <span class="hljs-string">FIS</span><br><span class="hljs-number">0x0004</span>  <span class="hljs-number">2</span>            <span class="hljs-number">0</span>  <span class="hljs-string">R_ERR</span> <span class="hljs-string">response</span> <span class="hljs-string">for</span> <span class="hljs-string">host-to-device</span> <span class="hljs-string">data</span> <span class="hljs-string">FIS</span><br><span class="hljs-number">0x0005</span>  <span class="hljs-number">2</span>            <span class="hljs-number">0</span>  <span class="hljs-string">R_ERR</span> <span class="hljs-string">response</span> <span class="hljs-string">for</span> <span class="hljs-string">non-data</span> <span class="hljs-string">FIS</span><br><span class="hljs-number">0x0006</span>  <span class="hljs-number">2</span>            <span class="hljs-number">0</span>  <span class="hljs-string">R_ERR</span> <span class="hljs-string">response</span> <span class="hljs-string">for</span> <span class="hljs-string">device-to-host</span> <span class="hljs-string">non-data</span> <span class="hljs-string">FIS</span><br><span class="hljs-number">0x0007</span>  <span class="hljs-number">2</span>            <span class="hljs-number">0</span>  <span class="hljs-string">R_ERR</span> <span class="hljs-string">response</span> <span class="hljs-string">for</span> <span class="hljs-string">host-to-device</span> <span class="hljs-string">non-data</span> <span class="hljs-string">FIS</span><br><span class="hljs-number">0x0008</span>  <span class="hljs-number">2</span>            <span class="hljs-number">0</span>  <span class="hljs-string">Device-to-host</span> <span class="hljs-string">non-data</span> <span class="hljs-string">FIS</span> <span class="hljs-string">retries</span><br><span class="hljs-number">0x0009</span>  <span class="hljs-number">2</span>            <span class="hljs-number">0</span>  <span class="hljs-string">Transition</span> <span class="hljs-string">from</span> <span class="hljs-string">drive</span> <span class="hljs-string">PhyRdy</span> <span class="hljs-string">to</span> <span class="hljs-string">drive</span> <span class="hljs-string">PhyNRdy</span><br><span class="hljs-number">0x000a</span>  <span class="hljs-number">2</span>            <span class="hljs-number">1</span>  <span class="hljs-string">Device-to-host</span> <span class="hljs-string">register</span> <span class="hljs-string">FISes</span> <span class="hljs-string">sent</span> <span class="hljs-string">due</span> <span class="hljs-string">to</span> <span class="hljs-string">a</span> <span class="hljs-string">COMRESET</span><br><span class="hljs-number">0x000b</span>  <span class="hljs-number">2</span>            <span class="hljs-number">0</span>  <span class="hljs-string">CRC</span> <span class="hljs-string">errors</span> <span class="hljs-string">within</span> <span class="hljs-string">host-to-device</span> <span class="hljs-string">FIS</span><br><span class="hljs-number">0x000d</span>  <span class="hljs-number">2</span>            <span class="hljs-number">0</span>  <span class="hljs-string">Non-CRC</span> <span class="hljs-string">errors</span> <span class="hljs-string">within</span> <span class="hljs-string">host-to-device</span> <span class="hljs-string">FIS</span><br></code></pre></td></tr></table></figure>

<h3 id="How-to-calculate-scsi-logging-level"><a href="#How-to-calculate-scsi-logging-level" class="headerlink" title="How to calculate scsi logging_level"></a>How to calculate scsi logging_level</h3><p><a target="_blank" rel="noopener" href="https://en.opensuse.org/SDB:SCSI_debugging_hints">A useful setting of the logging level without being buried in logging details is ERROR=3, SCAN=3, MLQUEUE=2, MLCOMPLETE=2, which evaluates to echo 9411 &gt; /proc/sys/dev/scsi/logging_level</a></p>
<p>means 111(7) is the maximum value</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">scsi_logging_level -g<br>Current scsi logging level:<br>/proc/sys/dev/scsi/logging_level = <span class="hljs-number">9411</span> (<span class="hljs-number">10</span>,<span class="hljs-number">010</span>,<span class="hljs-number">011</span>,<span class="hljs-number">000</span>,<span class="hljs-number">011</span>)<br>SCSI_LOG_ERROR=<span class="hljs-number">3</span><br>SCSI_LOG_TIMEOUT=<span class="hljs-number">0</span><br>SCSI_LOG_SCAN=<span class="hljs-number">3</span><br>SCSI_LOG_MLQUEUE=<span class="hljs-number">2</span><br>SCSI_LOG_MLCOMPLETE=<span class="hljs-number">2</span><br>SCSI_LOG_LLQUEUE=<span class="hljs-number">0</span><br>SCSI_LOG_LLCOMPLETE=<span class="hljs-number">0</span><br>SCSI_LOG_HLQUEUE=<span class="hljs-number">0</span><br>SCSI_LOG_HLCOMPLETE=<span class="hljs-number">0</span><br>SCSI_LOG_IOCTL=<span class="hljs-number">0</span><br><br>$ scsi_logging_level -s --error <span class="hljs-number">3</span> --timeout <span class="hljs-number">3</span> --scan=<span class="hljs-number">3</span> --mlqueue=<span class="hljs-number">2</span> --mlcomplete=<span class="hljs-number">3</span> --all <span class="hljs-number">0</span><br>New scsi logging level:<br>/proc/sys/dev/scsi/logging_level = <span class="hljs-number">13531</span>(<span class="hljs-number">011</span>,<span class="hljs-number">010</span>,<span class="hljs-number">011</span>,<span class="hljs-number">011</span>,<span class="hljs-number">011</span>)<br>SCSI_LOG_ERROR=<span class="hljs-number">3</span><br>SCSI_LOG_TIMEOUT=<span class="hljs-number">3</span><br>SCSI_LOG_SCAN=<span class="hljs-number">3</span><br>SCSI_LOG_MLQUEUE=<span class="hljs-number">2</span><br>SCSI_LOG_MLCOMPLETE=<span class="hljs-number">3</span><br>SCSI_LOG_LLQUEUE=<span class="hljs-number">0</span><br>SCSI_LOG_LLCOMPLETE=<span class="hljs-number">0</span><br>SCSI_LOG_HLQUEUE=<span class="hljs-number">0</span><br>SCSI_LOG_HLCOMPLETE=<span class="hljs-number">0</span><br>SCSI_LOG_IOCTL=<span class="hljs-number">0</span><br>https:<span class="hljs-comment">//www.ibm.com/support/knowledgecenter/en/linuxonibm/com.ibm.linux.z.lgdd/lgdd_r_scsilog_cmd.html</span><br><br>scsi debug<br>scsi_logging_level syntax<br>Read syntax diagramSkip visual syntax diagram<br>                       .- ---------------------------.<br>                       V                             |<br>&gt;&gt;-scsi_logging_level----+-------------------------+-+--+- -s -+-&gt;&lt;<br>                         +- -a-- &lt;level&gt;-----------+    +- -g -+<br>                         +- -E-- &lt;level&gt;-----------+    <span class="hljs-string">&#x27;- -c -&#x27;</span><br>                         +- -T-- &lt;level&gt;-----------+<br>                         +- -S-- &lt;level&gt;-----------+<br>                         +- -M-- &lt;level&gt;-----------+<br>                         +- --mlqueue-- &lt;level&gt;----+<br>                         +- --mlcomplete-- &lt;level&gt;-+<br>                         +- -L-- &lt;level&gt;-----------+<br>                         +- --llqueue-- &lt;level&gt;----+<br>                         +- --llcomplete-- &lt;level&gt;-+<br>                         +- -H-- &lt;level&gt;-----------+<br>                         +- --hlqueue-- &lt;level&gt;----+<br>                         +- --hlcomplete-- &lt;level&gt;-+<br>                         <span class="hljs-string">&#x27;- -I-- &lt;level&gt;-----------&#x27;</span><br><br></code></pre></td></tr></table></figure>

<p>Error Type</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">drivers/scsi/scsi_logging.h<br></code></pre></td></tr></table></figure>
<p>ERROR<br>Used by any command which has to be retried/recovered via the SCSI error handling mechanism</p>
<p>TIMEOUT<br>Used by drivers/scsi/sg.c</p>
<p>SCAN<br>Used during device scan, ie whenever a new device HBA is initialized</p>
<p>MLQUEUE<br>Mid-layer queue; requests are being pulled from the block-layer queue and submitted to the HBA</p>
<p>MLCOMPLETE<br>Mid-layer queue; requests are being completed by the HBA and results are being pushed back to the block-layer</p>
<p>LLQUEUE<br>Low-layer queue; Not used<br>LLCOMPLETE<br>Low-layer queue; Not used</p>
<p>HLQUEUE<br>High-layer queue; command preparation in drivers/scsi/sd.c</p>
<p>HLCOMPLETE<br>High-layer queue; command completion in drivers/scsi/sd.c</p>
<p>IOCTL<br>SCSI IOCTL logging<br>The detailed error level description</p>
<p>ERROR<br>Error logging when a command is recovered via the SCSI error handling mechanism. The following levels are uses:<br>Error handler thread statistics<br>Error handler command statistics<br>Error handler command logging<br>Not used<br>Error handler command details<br>and higher: not used</p>
<p>SCAN<br>Logging during HBA / target scanning. The following levels are used:<br>Logging of unusual devices where LUN 0 has a pqual of 3<br>Logging of devices with pqual 3<br>Logging of SCSI commands sent during scanning<br>and higher: not used.</p>
<p>MLQUEUE<br>The MLQUEUE area is used when a command is being pulled from the block-layer queue and send to the HBA. It has the following levels:<br>nothing (match completion)<br>log opcode + command of all commands<br>same as 2 plus dump cmd address<br>same as 3 plus dump extra junk<br>and higher: not used</p>
<p>MLCOMPLETE<br>Logging of command completion from the HBA, before the completion is being called for the block-layer request. It has the following levels:<br>log disposition, result, opcode + command, and conditionally sense data for failures or non SUCCESS dispositions.<br>same as 1 but for all command completions.<br>same as 2 plus dump cmd address<br>same as 3 plus dump extra junk<br>and higher: not used</p>
<h3 id="smp-utils"><a href="#smp-utils" class="headerlink" title="smp_utils"></a>smp_utils</h3><p>not make sure</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">$ smp_rep_phy_sata <span class="hljs-attribute">--phy</span>=2 /dev/sdb<br>$ smp_phy_control <span class="hljs-attribute">--phy</span>=2 <span class="hljs-attribute">--op</span>=tspss  /dev/sdb<br></code></pre></td></tr></table></figure>
<h3 id="T10-PI-practice"><a href="#T10-PI-practice" class="headerlink" title="T10 PI practice"></a><a target="_blank" rel="noopener" href="https://www.snia.org/sites/default/files/SDCEMEA/2020/3%20-%20Mikhail%20Malygin%20Yadro%20-%20Using%20Linux%20block%20integrity.pdf">T10 PI practice</a></h3><p>mpt3sas driver set module parameter “prot_mask=0x7F” to enable DIX support</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sg_vpd --page=ei --long /dev/sda |grep SPT <span class="hljs-comment"># Does the device support DIF</span><br>$ sg_format --format --size 520  /dev/sdX <span class="hljs-comment"># HUS724030ALS640 support</span><br><span class="hljs-comment">#type 3</span><br>$ sg_format -v --long --format --size=512 --fmtpinfo=3 --pfu=0 /dev/sdX <span class="hljs-comment">#  HUH721010AL5200 support ,4K or 512B could work</span><br>$ sg_format --format --fmtpinfo=3 --pfu=1 /dev/sdX <span class="hljs-comment"># HUH721010AL5200 not support</span><br><br><span class="hljs-comment">#type 1</span><br>$ sg_format --format --size 4096 --fmtpinfo=2 -vvv /dev/sdX <span class="hljs-comment"># HUH721010AL5200 support</span><br>open /dev/sdl with flags=0x802<br>    inquiry cdb: 12 00 00 00 24 00<br>    SEAGATE   ST800FM0043       0007   peripheral_type: disk [0x0]<br>      PROTECT=1<br>      &lt;&lt; supports protection information&gt;&gt;<br>    inquiry cdb: 12 01 00 00 24 00<br>    inquiry: pass-through requested 36 bytes (data-in) but got 21 bytes<br>    inquiry cdb: 12 01 80 01 00 00<br>    inquiry: pass-through requested 256 bytes (data-in) but got 24 bytes<br>      Unit serial number: Z3G01AQM0000Z3G01AQM<br>    inquiry cdb: 12 01 83 01 00 00<br>    inquiry: pass-through requested 256 bytes (data-in) but got 76 bytes<br>      LU name: 5000c5003015b5b7<br>    mode sense(10) cdb: 5a 00 01 00 00 00 00 00 <span class="hljs-built_in">fc</span> 00<br>      duration=1 ms<br>    mode sense(10): pass-through requested 252 bytes (data-in) but got 28 bytes<br>    mode sense(10): response:<br>00 1a 00 10 00 00 00 08  0b a4 d9 d6 00 00 10 00<br>81 0a c0 01 5a 00 00 00  0b 00 ff ff<br>Mode Sense (block descriptor) data, prior to changes:<br>  Number of blocks=195353046 [0xba4d9d6]<br>  Block size=4096 [0x1000]<br><br>A FORMAT UNIT will commence <span class="hljs-keyword">in</span> 15 seconds<br>    ALL data on /dev/sdl will be DESTROYED<br>        Press control-C to abort<br><br>A FORMAT UNIT will commence <span class="hljs-keyword">in</span> 10 seconds<br>    ALL data on /dev/sdl will be DESTROYED<br>        Press control-C to abort<br><br>A FORMAT UNIT will commence <span class="hljs-keyword">in</span> 5 seconds<br>    ALL data on /dev/sdl will be DESTROYED<br>        Press control-C to abort<br>    Format unit cdb: 04 98 00 00 00 00<br>    Format unit parameter list:<br>00 02 00 00<br>    Format unit timeout: 20 seconds<br>      duration=22 ms<br><br>Format unit has started<br>    <span class="hljs-built_in">test</span> unit ready cdb: 00 00 00 00 00 00<br>FORMAT UNIT Complete<br><br>still no integrity on block level:<br>/sys/block/sda/integrity/device_is_integrity_capable -&gt; 0<br>/sys/block/sda/integrity/tag_size -&gt; 0<br><br>$ cat /sys/block/sdl/integrity/device_is_integrity_capable  /sys/block/sdl/integrity/tag_size<br>0<br>0<br><br><span class="hljs-comment"># Protection: prot_en=1, p_type=0, p_i_exponent=0 [type 1 protection]</span><br>$ sg_readcap -v --long /dev/sdl<br>    <span class="hljs-built_in">read</span> capacity(16) cdb: 9e 10 00 00 00 00 00 00 00 00 00 00 00 20 00 00<br>Read Capacity results:<br>   Protection: prot_en=1, p_type=0, p_i_exponent=0 [<span class="hljs-built_in">type</span> 1 protection]<br>   Logical block provisioning: lbpme=1, lbprz=1<br>   Last LBA=195353045 (0xba4d9d5), Number of logical blocks=195353046<br>   Logical block length=4096 bytes<br>   Logical blocks per physical block exponent=0<br>   Lowest aligned LBA=0<br>Hence:<br>   Device size: 800166076416 bytes, 763097.8 MiB, 800.17 GB<br><br>$ cat /etc/modprobe.d/mpt3sas.conf<br>options mpt3sas prot_mask=63<br><br>$ reboot <span class="hljs-comment"># for reload prot_mask parameter</span><br>$ sg_wr_mode -v -p 0a -c 00,00,00,00,00,80,00,00,00,00,00,00 -m 00,00,00,00,00,80,00,00,00,00,00,00 /dev/sdl<br><br><span class="hljs-comment"># in my test env, it is not work, I think the HBA/Expander firmware do not support it, driver and firmware must be support it</span><br>$ cat /sys/block/sdl/integrity/device_is_integrity_capable <br>1<br>$ cat /sys/block/sdl/integrity/tag_size <br>2<br>$ cat /sys/block/sdl/integrity/format <br>T10-DIF-TYPE1-CRC<br></code></pre></td></tr></table></figure>


<h5 id="About-dell-PERC-9"><a href="#About-dell-PERC-9" class="headerlink" title="About dell PERC 9"></a>About dell PERC 9</h5><p>In Dell document, T10 protection information is an end-to-end data integrity feature of the PERC 9 series.<br>Only dell certified PI disks are supported<br>Note: pi is not supported on SAS disks with 512-byte native and 512-byte emulated block size and SATA disks</p>
<p>Enabling T10 Pi<br>ctrl + R to access the BIOS configuration utility<br>     the virtual disk management<br>         selected controller<br>            Use the arrow keys to highlight the PERC 9 series of cards or disk group<br>                Note: The H330 PERC card does not support T10 PI feature<br>                   press F2, list of available actionsis displayed<br>                     Click Enable data protection</p>
<h4 id="nvme-pi"><a href="#nvme-pi" class="headerlink" title="nvme pi"></a>nvme pi</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ nvme id-ns -H /dev/nvme0n1<br>NVME Identify Namespace 1:<br>nsze    : 0x2baa5cd0<br>ncap    : 0x2baa5cd0<br>nuse    : 0x2baa5cd0<br>nsfeat  : 0<br>  [2:2] : 0	Deallocated or Unwritten Logical Block error Not Supported<br>  [1:1] : 0	Namespace uses AWUN, AWUPF, and ACWU<br>  [0:0] : 0	Thin Provisioning Not Supported<br><br>nlbaf   : 6<br>flbas   : 0<br>  [4:4] : 0	Metadata Transferred <span class="hljs-keyword">in</span> Separate Contiguous Buffer<br>  [3:0] : 0	Current LBA Format Selected<br><br>mc      : 0x1<br>  [1:1] : 0	Metadata Pointer Not Supported<br>  [0:0] : 0x1	Metadata as Part of Extended Data LBA Supported<br><br>dpc     : 0x11<br>  [4:4] : 0x1	Protection Information Transferred as Last 8 Bytes of Metadata Supported<br>  [3:3] : 0	Protection Information Transferred as First 8 Bytes of Metadata Not Supported<br>  [2:2] : 0	Protection Information Type 3 Not Supported<br>  [1:1] : 0	Protection Information Type 2 Not Supported<br>  [0:0] : 0x1	Protection Information Type 1 Supported<br><br>dps     : 0<br>  [3:3] : 0	Protection Information is Transferred as Last 8 Bytes of Metadata<br>  [2:0] : 0	Protection Information Disabled<br><br>nmic    : 0<br>  [0:0] : 0	Namespace Multipath Not Capable<br><br>rescap  : 0<br>  [6:6] : 0	Exclusive Access - All Registrants Not Supported<br>  [5:5] : 0	Write Exclusive - All Registrants Not Supported<br>  [4:4] : 0	Exclusive Access - Registrants Only Not Supported<br>  [3:3] : 0	Write Exclusive - Registrants Only Not Supported<br>  [2:2] : 0	Exclusive Access Not Supported<br>  [1:1] : 0	Write Exclusive Not Supported<br>  [0:0] : 0	Persist Through Power Loss Not Supported<br><br>fpi     : 0<br>  [7:7] : 0	Format Progress Indicator Not Supported<br><br>dlfeat  : 0<br>  [4:4] : 0	Guard Field of Deallocated Logical Blocks is <span class="hljs-built_in">set</span> to 0xFFFF<br>  [3:3] : 0	Deallocate Bit <span class="hljs-keyword">in</span> the Write Zeroes Command is Not Supported<br>  [2:0] : 0	Bytes Read From a Deallocated Logical Block and its Metadata are Not Reported<br><br>nawun   : 0<br>nawupf  : 0<br>nacwu   : 0<br>nabsn   : 0<br>nabo    : 0<br>nabspf  : 0<br>noiob   : 0<br>nvmcap  : 0<br>nsattr	: 0<br>nvmsetid: 0<br>anagrpid: 0<br>endgid  : 0<br>nguid   : 00000000000000000000000000000000<br>eui64   : 5cd2e4e419330100<br>LBA Format  0 : Metadata Size: 0   bytes - Data Size: 512 bytes - Relative Performance: 0x2 Good (<span class="hljs-keyword">in</span> use)<br>LBA Format  1 : Metadata Size: 8   bytes - Data Size: 512 bytes - Relative Performance: 0x2 Good<br>LBA Format  2 : Metadata Size: 16  bytes - Data Size: 512 bytes - Relative Performance: 0x2 Good<br>LBA Format  3 : Metadata Size: 0   bytes - Data Size: 4096 bytes - Relative Performance: 0 Best<br>LBA Format  4 : Metadata Size: 8   bytes - Data Size: 4096 bytes - Relative Performance: 0 Best<br>LBA Format  5 : Metadata Size: 64  bytes - Data Size: 4096 bytes - Relative Performance: 0 Best<br>LBA Format  6 : Metadata Size: 128 bytes - Data Size: 4096 bytes - Relative Performance: 0 Best<br><br><span class="hljs-comment">### you can see</span><br>dps     : 0<br>  [3:3] : 0     Protection Information is Transferred as Last 8 Bytes of Metadata<br>  [2:0] : 0     Protection Information Disabled<br></code></pre></td></tr></table></figure>

<h3 id="SAS-smart"><a href="#SAS-smart" class="headerlink" title="SAS smart"></a><a target="_blank" rel="noopener" href="https://superuser.com/questions/618736/how-do-i-interpret-smart-data-for-sas-disks">SAS smart</a></h3><p>Delayed errors are errors that slow down other requests. ECC corrected errors aren’t much of a worry on SCSI/SAS drives, we have drives deployed with hundreds of millions of them and they still run fine. Correction algorithm invocations is a bit more serious, those may require rereading/rewriting the disk, and retrying the ECC calculation.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">Error counter <span class="hljs-built_in">log</span>:<br>           Errors Corrected by           Total   Correction     Gigabytes    Total<br>               ECC          rereads/    errors   algorithm      processed    uncorrected<br>           fast | delayed   rewrites  corrected  invocations   [10^9 bytes]  errors<br><span class="hljs-built_in">read</span>:          0        0         0         0          6          0.565           0<br>write:         0      400         0       400         51       1034.246           0<br>verify:        0        0         0         0         37          0.000           0<br></code></pre></td></tr></table></figure>


<h3 id="sdparm"><a href="#sdparm" class="headerlink" title="sdparm"></a>sdparm</h3><h4 id="command"><a href="#command" class="headerlink" title="command"></a>command</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Flush the SAS dev buff</span><br><span class="hljs-comment"># sync: send a SYNCHRONIZE CACHE SCSI command to the device.</span><br>$ sdparm --<span class="hljs-built_in">command</span>=sync /dev/sdxx<br><br><span class="hljs-comment">#spindown the device</span><br>$ sdparm --<span class="hljs-built_in">command</span>=stop /dev/sdxx<br><br><span class="hljs-comment">#spinup the device</span><br>$ sdparm --<span class="hljs-built_in">command</span>=start /dev/sdxx<br><br><span class="hljs-comment">#sense: reports sense data (from a REQUEST SENSE SCSI command); can include power condition information, a progress indication for a time consuming command (e.g. format) or a report an informational exception (when MRIE=6)</span><br>$ sdparm --<span class="hljs-built_in">command</span>=sense /dev/sdx<br>    /dev/sdb: SEAGATE   ST10000NM0256     TT55<br>Additional sense: Warning - enclosure degraded<br><br><span class="hljs-comment">#capacity: sends a READ CAPACITY and if successful reports the number of blocks, block length and capacity expressed in MibiBytes (1048576 bytes). Valid for disks and CD/DVD drives with the appropriate media loaded.</span><br>$ sdparm --<span class="hljs-built_in">command</span>=capacity /dev/sdb<br>    /dev/sdb: SEAGATE   ST10000NM0256     TT55<br>blocks: 19134414848<br>block_length: 512<br>capacity_mib: 9342976.0<br><br>    eject: stops the medium (<span class="hljs-keyword">if</span> it is spinning) and ejects it from the drive. Note that this may be prevented by software <span class="hljs-keyword">in</span> <span class="hljs-built_in">which</span> <span class="hljs-keyword">case</span> use the <span class="hljs-string">&#x27;unlock&#x27;</span> <span class="hljs-built_in">command</span> first.<br><br>    load: loads the medium and <span class="hljs-keyword">then</span> spins it up<br><br>    profile: lists the profiles (e.g. DVD+R and DVD-RAM) supported by a CD/DVD/HD_DVD/BD drive. If media is present <span class="hljs-keyword">in</span> the drive <span class="hljs-keyword">then</span> its corresponding profile has an asterisk (<span class="hljs-string">&quot;*&quot;</span>) to its right <span class="hljs-keyword">in</span> the list.<br><br>    ready: reports whether the medium is ready <span class="hljs-keyword">for</span> IO. Ready usually means that it is present and spun up. If the device is not ready <span class="hljs-keyword">then</span> the <span class="hljs-built_in">exit</span> status will be 2 (see <span class="hljs-built_in">exit</span> status section below).<br><br>    speed: takes and argument (e.g. --<span class="hljs-built_in">command</span>=speed=1350 or -C sp=1350 ) <span class="hljs-built_in">which</span> is <span class="hljs-keyword">in</span> kilobytes per second (1000 bytes per second units). Attempts to <span class="hljs-built_in">set</span> CD/DVD/BD media to given <span class="hljs-built_in">read</span> speed. If argument is zero <span class="hljs-keyword">then</span> <span class="hljs-built_in">set</span> drive back to its optimum setting. <span class="hljs-string">&quot;Times one&quot;</span> speeds are 177 kB/s <span class="hljs-keyword">for</span> CD, 1350  kB/s <span class="hljs-keyword">for</span> DVD and 4500 kB/s <span class="hljs-keyword">for</span> HD-DVD and BD.<br><br>    unlock: instructs the device to allow medium removal (i.e. an eject). Beware, the OS may have had a good reason <span class="hljs-keyword">for</span> preventing removal of the medium (e.g. it contains a mounted file system). Use at your own risk.<br></code></pre></td></tr></table></figure>

<h4 id="enumerate"><a href="#enumerate" class="headerlink" title="enumerate"></a>enumerate</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sdparm --enumerate /dev/sdb<br>&lt;scsi_device&gt; as well as most options are ignored when <span class="hljs-string">&#x27;--enumerate&#x27;</span> is given<br>Mode pages:<br>  addp 0x0e,0x02  DT device primary port (ADC)<br>  adlu 0x0e,0x03  logical unit (ADC)<br>  adtd 0x0e,0x01  Targer device (ADC)<br>  adts 0x0e,0x04  Targer device serial number (ADC)<br>  apo  0x1a,0xf1  SAT ATA Power condition<br>  atag 0x0a,0x02  Application tag (SBC)<br>  bc   0x1c,0x01  Background control (SBC)<br>  ca   0x08       Caching (SBC)<br>  cms  0x2a       CD/DVD (MM) capabilities and mechanical status (MMC)<br>  co   0x0a       Control<br>  coe  0x0a,0x01  Control extension<br>  cdp  0x0a,0xf0  Control data protection (SSC)<br>  dac  0x0f       Data compression (SSC)<br>  dc   0x10       Device configuration (SSC)<br>  dca  0x1f       Device capabilities (SMC)<br>  dce  0x10,0x01  Device configuration extension (SSC)<br>  dr   0x02       Disconnect-reconnect (SPC + transports)<br>  eaa  0x1d       Element address assignment (SMC)<br>  edc  0x1f,0x41  Extended device capabilities (SMC)<br>  esm  0x14       Enclosure services management (SES)<br>  fo   0x03       Format (SBC)<br>  ie   0x1c       Informational exceptions control<br>  lbp  0x1c,0x02  Logical block provisioning (SBC)<br>  mco  0x1d       Medium configuration (SSC)<br>  mpa  0x11       Medium partition (SSC)<br>  mrw  0x03       Mount rainier reWritable (MMC)<br>  pat  0x0a,0xf1  SAT pATA control<br>  pl   0x18       Protocol specific logical unit<br>  po   0x1a       Power condition<br>  ps   0x1a,0x01  Power consumption<br>  poo  0x0d       Power condition - old version<br>  pp   0x19       Protocol specific port<br>  rbc  0x06       RBC device parameters (RBC)<br>  rd   0x04       Rigid disk (SBC)<br>  rw   0x01       Read write error recovery<br>  tgp  0x1e       Transport geometry parameters (SMC)<br>  tp   0x1d       Timeout and protect (MMC)<br>  ve   0x07       Verify error recovery (SBC)<br>  wp   0x05       Write parameters (MMC)<br>  xo   0x10       XOR control (SBC)a<br><br>$ sdparm --get WCE /dev/sdb<br>    /dev/sdb: SEAGATE   ST10000NM0256     TT55<br>WCE         0  [cha: y, def:  0, sav:  0]<br><br>$ sdparm --enumerate --page=0x8 --long --long /dev/sda<br>&lt;scsi_device&gt; as well as most options are ignored when <span class="hljs-string">&#x27;--enumerate&#x27;</span> is given<br>Caching (SBC) [ca: 0x8] [SBC-3] mode page:<br>  IC         [0x02:7:1 ]  Initiator control<br>	0: disk uses own adaptive caching algorithm<br>	1: disk caching algorithm controlled by NCS or CCS<br>  ABPF       [0x02:6:1 ]  Abort pre-fetch<br>  CAP        [0x02:5:1 ]  Caching analysis permitted<br>  DISC       [0x02:4:1 ]  Discontinuity<br>	0: pre-fetch truncated or wrapped at time discontinuity<br>	1: pre-fetch continues across time discontinuity<br>  SIZE       [0x02:3:1 ]  Size <span class="hljs-built_in">enable</span><br>	0: number of cache segments (NCS) controls cache segmentation<br>	1: the cache segment size (CCS) controls cache segmentation<br>  WCE        [0x02:2:1 ]  Write cache <span class="hljs-built_in">enable</span><br>  MF         [0x02:1:1 ]  Multiplication factor<br>	0: MIPF and MAPF specify blocks<br>	1: multiply MIPF and MAPF by blocks <span class="hljs-keyword">in</span> <span class="hljs-built_in">read</span> <span class="hljs-built_in">command</span><br>  RCD        [0x02:0:1 ]  Read cache <span class="hljs-built_in">disable</span><br>  DRRP       [0x03:7:4 ]  Demand <span class="hljs-built_in">read</span> retention priority<br>	0: treat requested and other data equally<br>	1: replace requested data before other data<br>	15: replace other data before requested data<br>  WRP        [0x03:3:4 ]  Write retention priority<br>	0: treat requested and other data equally<br>	1: replace requested data before other data<br>	15: replace other data before requested data<br>  DPTL       [0x04:7:16]  Disable pre-fetch transfer length<br>  MIPF       [0x06:7:16]  Minimum pre-fetch<br>  MAPF       [0x08:7:16]  Maximum pre-fetch<br>  MAPFC      [0x0a:7:16]  Maximum pre-fetch ceiling<br>  FSW        [0x0c:7:1 ]  Force sequential write<br>  LBCSS      [0x0c:6:1 ]  Logical block cache segment size<br>	0: CSS unit is bytes; 1: CSS unit is blocks<br>  DRA        [0x0c:5:1 ]  Disable <span class="hljs-built_in">read</span> ahead<br>  SYNC_PROG  [0x0c:2:2 ]  Synchronous cache progress indication<br>	0: no pollable sense data during sync<br>	1: allow pollable sense data, allow all commands during sync<br>	2: allow pollable sense data, allow some commands during sync<br>  NV_DIS     [0x0c:0:1 ]  Non-volatile cache <span class="hljs-built_in">disable</span><br>  NCS        [0x0d:7:8 ]  Number of cache segments<br>  CSS        [0x0e:7:16]  Cache segment size<br><br>DRA (Disable READ-Ahead) bit<br>0 When the DRA bit equals zero, the target may <span class="hljs-built_in">continue</span> to <span class="hljs-built_in">read</span> logical blocks into the buffer beyond the addressed<br>logical block(s). means <span class="hljs-built_in">enable</span> read-ahead<br><br>RCD <br><br>FSW (FORCE SEQUENTIAL WRITE) bit<br>0 When the FSW bit equals zero, the target is allowed to reorder the sequence of writing addressed logical blocks <span class="hljs-keyword">in</span><br>order to achieve a faster <span class="hljs-built_in">command</span> completion.<br><br>RCD (READ Cache Disable) bit<br>0 SCSI READ commands may access the cache or the media.<br><br>WCE (Write Cache Enable) bit<br>1 SCSI WRITE commands may <span class="hljs-built_in">return</span> status and completion message bytes as soon as all data has been received<br>from the host<br><br>ABPF (ABORT PREFETCH) bit<br>0 When <span class="hljs-built_in">set</span> to zero, with the DRA bit equal to zero, the termination of any active PREFETCH is dependent upon<br>Caching Page bytes 4 through 11 and is operation and/or vendor-specific.<br><br>DFUA (Disable Force Unit Access) bit<br>1 When the Disable Force Unit Access (DFUA) bit is <span class="hljs-built_in">set</span> to 1, the drive ignores the FUA bit <span class="hljs-keyword">in</span> READ and WRITE com-<br>mands. This can result <span class="hljs-keyword">in</span> better drive performance <span class="hljs-keyword">in</span> some circumstances.<br>0 When the DFUA is <span class="hljs-built_in">set</span> to 0, the drive obeys the FUA setting <span class="hljs-keyword">in</span> READ and WRITE commands<br><br>DPO (DISABLE PAGE OUT) bit<br>If DPO = 1, the cache replacement algorithm should not replace existing cache data with the current data (<span class="hljs-keyword">if</span> possible). If a<br>cache segment must be overwritten, it should be made the LRU.<br>FUA (FORCE UNIT ACCESS) bit<br>READ: If FUA = 1, the requested data must be <span class="hljs-built_in">read</span> from the media. If cache data <span class="hljs-built_in">which</span> overlaps the request has not yet been written to the media, it should be written before the <span class="hljs-built_in">read</span> is allowed to occur.<br>WRITE: If FUA = 1, all data must be written to the media before the SCSI operation returns the status and completion message bytes( write through )<br><br>$ sdparm -g WCE -H  /dev/sdb<br>0x00 0x01 0x00 0x00 <br><br><span class="hljs-comment"># set it to default</span><br>$ sdparm --page=ca --defaults --save /dev/sdd<br><br><span class="hljs-comment"># the same</span><br>$ sdparm --<span class="hljs-built_in">set</span>=WCE --clear=RCD --save /dev/sdd<br>$ sdparm -s WCE=1,RCD=0 -S /dev/sdd<br><br><span class="hljs-comment"># set page value, not make sure</span><br>$ sdparm --page=0 --hex /dev/sdd<br>$ sdparm --page=0 --<span class="hljs-built_in">set</span>=2:7:1=1 --save /dev/sdd<br></code></pre></td></tr></table></figure>

<h3 id="sdparm-with-hdparm"><a href="#sdparm-with-hdparm" class="headerlink" title="sdparm with hdparm"></a><a href="sg.danny.cz/sg/sdparm.html">sdparm with hdparm</a></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># disable read-ahead</span><br>$ sdparm --<span class="hljs-built_in">set</span> DRA=1 /dev/sdx<br>$ hdparm -A0 /dev/sdx<br><br><span class="hljs-comment"># enable read-ahead</span><br>$ sdparm --<span class="hljs-built_in">set</span> DRA=0 /dev/sdx<br>$ hdparm -A1 /dev/sdx<br><br><span class="hljs-comment">#fetch the current device power state</span><br>$ sdparm --comand=ready or --<span class="hljs-built_in">command</span>=sense /dev/sdx<br>$ hdparm -C /dev/sdx<br><br><span class="hljs-comment">#sync</span><br>$ sdparm --commnad=sync /dev/sdx<br>$ hdparm -f /dev/sdx<br><br><span class="hljs-comment"># INQUIRY response plus the &quot;device identification&quot; VPD page</span><br>$ sdparm --inquiry /dev/sdx<br>$ hdparm -I /dev/sdx<br><br><span class="hljs-comment"># save</span><br>$ sdparm --save /dev/sdx<br>$ hdparm -K1 /dev/sdx<br></code></pre></td></tr></table></figure>

<h3 id="SAS-2-Support-multiple-STP-affiliations"><a href="#SAS-2-Support-multiple-STP-affiliations" class="headerlink" title="SAS-2 Support multiple STP affiliations"></a><a target="_blank" rel="noopener" href="https://www.t10.org/ftp/t10/document.06/06-188r3.pdf">SAS-2 Support multiple STP affiliations</a></h3><p>The LSI SAS Expander has implemented this feature.<br>If the two server connectting with the single IO expander, the SATA device could read and write in two server and the same time.<br>And the SATA device could be brain split too.</p>
<h3 id="disable-background-scans"><a href="#disable-background-scans" class="headerlink" title="disable background scans"></a><a target="_blank" rel="noopener" href="https://www.reddit.com/r/DataHoarder/comments/e677p1/psa_if_you_have_sas_drives_check_the_background/">disable background scans</a></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># disable</span><br>$ sdparm /dev/sdj -p bc -s EN_BMS=0<br>Background scan results <span class="hljs-built_in">log</span><br>  Status: no scans active<br><br>$ sdparm /dev/sdj -p bc<br>    /dev/sdj: HGST      HUH721010AL5200   LS14<br>Background control (SBC) mode page:<br>  S_L_FULL      0  [cha: y, def:  0, sav:  0]<br>  LOWIR         0  [cha: y, def:  0, sav:  0]<br>  EN_BMS        0  [cha: y, def:  1, sav:  1]<br>  EN_PS         0  [cha: y, def:  0, sav:  0]<br>  BMS_I         168  [cha: y, def:168, sav:168]<br>  BPS_TL        0  [cha: y, def:  0, sav:  0]<br>  MIN_IDLE      250  [cha: y, def:250, sav:250]<br>  MAX_SUSP      0  [cha: y, def:  0, sav:  0]<br><br>$ smartctl -x /dev/sdj<br><br>Background scan results <span class="hljs-built_in">log</span><br>  Status: waiting until BMS interval timer expires<br>    Accumulated power on time, hours:minutes 13155:51 [789351 minutes]<br>    Number of background scans performed: 73,  scan progress: 0.00%<br>    Number of background medium scans performed: 73<br><br>$ sdparm --clear=EN_BMS --save /dev/sdj<br>change_mode_page: failed setting page: Background control (SBC)<br><br>$ sdparm /dev/sdj -p bc -s EN_BMS=1<br>Background scan results <span class="hljs-built_in">log</span><br>  Status: waiting until BMS interval timer expires<br>    Accumulated power on time, hours:minutes 13165:02 [789902 minutes]<br>    Number of background scans performed: 73,  scan progress: 0.00%<br>    Number of background medium scans performed: 73<br><br><span class="hljs-comment">#number of hours between media scans - here, run a scan every 24 hours</span><br>$ sdparm /dev/sdb -p bc -s BMS_I=24<br><br><span class="hljs-comment"># how many milliseconds the drive must be idle before a scan can begin</span><br><span class="hljs-comment"># here, the drive must be idle for two second at time of scan start, </span><br><span class="hljs-comment">#     or else the scan will wait until the drive is idle for 2000ms.</span><br><span class="hljs-comment"># the same applies if scan is interrupted for user activity - scan resumes when</span><br><span class="hljs-comment">#     this period of time has elapsed with no activity.</span><br>$ sdparm /dev/sdb -p bc -s MIN_IDLE=2000<br><br><span class="hljs-comment"># how many milliseconds the drive is permitted to take to return to regular service</span><br><span class="hljs-comment">#     if a command is received during a background media scan - here, the drive must</span><br><span class="hljs-comment">#     stop the BMS within 500ms of receiving a read/write command from the host</span><br>$ sdparm /dev/sdb -p bc -s MAX_SUSP=500<br><br><span class="hljs-comment"># perform a background media scan (pre-scan) at the next disk power-on regardless of the timer</span><br><span class="hljs-comment"># this option is reset to 0 after disk power-up - it is only applied to the next disk power-up</span><br>$ sdparm /dev/sdb -p bc -s EN_PS=1<br><br><span class="hljs-comment"># how long the background pre-scan is permitted to take after disk power on, in hours.</span><br><span class="hljs-comment"># if this many hours elapses and the pre-scan isn&#x27;t finished, the pre-scan is aborted.</span><br><span class="hljs-comment"># here, cancel scan if not done in 6 hours</span><br>$ sdparm /dev/sdb -p bc -s BPS_TL=6<br><br><span class="hljs-comment"># if this is set to 1, only log events in the scan log that might require user intervention,</span><br><span class="hljs-comment">#     such as unrecoverable sectors. if 0, log any sectors the scan detects, even those that</span><br><span class="hljs-comment">#     the drive is able to fix on its own</span><br>$ sdparm /dev/sdb -p bc -s LOWIR=1<br><br><span class="hljs-comment"># if set to 1, STOP running scans when the drive&#x27;s internal log fills up</span><br>$ sdparm /dev/sdb -p bc -s S_L_FULL=0<br></code></pre></td></tr></table></figure>

<p>Since the background scan functions are only done during idle periods, BMS causes a negligible impact to system performance. The firstBMS scan for a newly manufactured drive is performed as quickly as possible to verify the media and protect data by setting the “Start timeafter idle” to 5ms, all subsequent scans begin after 500ms of idle time. Other features that normally use idle time to function will functionnormally because BMS functions for bursts of 800ms and then suspends activity for 100ms to allow other background functions to operate</p>
<p>BMS interrupts immediately to service host commands from the interface bus while performing reads. BMS will complete any BMS-initiatederror recovery prior to returning to service host-initiated commands. Overhead associated with a return to host-servicing activity from BMSonly impacts the first command that interrupted BMS, this results in a typical delay of about 1 ms</p>
<p>Media Pre-Scan is a feature that allows the drive to repair media errors that would otherwise have been found by the host system duringcritical data accesses early in the drive’s life. The default setting for Media Pre-Scan is enabled on standard products. Media Pre-Scanchecks each write command to determine if the destination LBAs have been scanned by BMS. If the LBAs have been verified, the driveproceeds with the normal write command. If the LBAs have not been verified by BMS, Pre-Scan will convert the write to a write verify tocertify that the data was properly written to the disk</p>
<h3 id="Power-status"><a href="#Power-status" class="headerlink" title="Power status"></a>Power status</h3><p>Idle_A</p>
<ul>
<li>Disables most of the servo system, reduces processor and channel power consumption</li>
<li>Disks rotating at full speed (7200 RPM)</li>
</ul>
<p>Idle_B</p>
<ul>
<li>Disables most of the servo system, reduces processor and channel power consumption</li>
<li>Heads are unloaded to drive ramp.</li>
<li>Disks rotating at full speed (7200 RPM)</li>
</ul>
<p>Idle_C/Standby_Y (SAS Only)</p>
<ul>
<li>Disables most of the servo system, reduces processor and channel power consumption</li>
<li>Heads are unloaded to drive ramp.</li>
<li>Drive speed reduced to a lower RPM (reduced RPM)</li>
</ul>
<p>Standby_Z</p>
<ul>
<li>Heads are unloaded to drive ramp.</li>
<li>Drive motor is spun down.</li>
<li>Drive still responds to non-media access host commands</li>
</ul>
<p>0 is disable, 1 is enable the function</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sdparm -p po /dev/sdj<br>    /dev/sdj: HGST      HUH721010AL5200   LS14<br>Power condition mode page:<br>  PM_BG         0  [cha: n, def:  0, sav:  0]<br>  STANDBY_Y     0  [cha: n, def:  0, sav:  0]<br>  IDLE_C        0  [cha: y, def:  0, sav:  0]<br>  IDLE_B        1  [cha: y, def:  1, sav:  1]<br>  IDLE          1  [cha: y, def:  1, sav:  1]<br>  STANDBY       0  [cha: y, def:  0, sav:  0]<br>  ICT           20  [cha: n, def: 20, sav: 20]<br>  SCT           0  [cha: y, def:  0, sav:  0]<br>  IBCT          6000  [cha: n, def:6000, sav:6000]<br>  ICCT          9000  [cha: n, def:9000, sav:9000]<br>  SYCT          0  [cha: n, def:  0, sav:  0]<br>  CCF_IDLE      1  [cha: y, def:  1, sav:  1]<br>  CCF_STAND     2  [cha: y, def:  2, sav:  2]<br>  CCF_STOPP     2  [cha: y, def:  2, sav:  2]<br><br><br>$ sdparm --flexible -6 -p po -l /dev/sdj<br>    /dev/sdj: HGST      HUH721010AL5200   LS14<br>    Direct access device specific parameters: WP=0  DPOFUA=1<br>Power condition [po] mode page:<br>  PM_BG         0  [cha: n, def:  0, sav:  0]  Power management, background <span class="hljs-built_in">functions</span>, precedence<br>  STANDBY_Y     0  [cha: n, def:  0, sav:  0]  Standby_y timer <span class="hljs-built_in">enable</span><br>  IDLE_C        0  [cha: y, def:  0, sav:  0]  Idle_c timer <span class="hljs-built_in">enable</span><br>  IDLE_B        1  [cha: y, def:  1, sav:  1]  Idle_b timer <span class="hljs-built_in">enable</span><br>  IDLE          1  [cha: y, def:  1, sav:  1]  Idle_a timer <span class="hljs-built_in">enable</span><br>  STANDBY       0  [cha: y, def:  0, sav:  0]  Standby_z timer <span class="hljs-built_in">enable</span><br>  ICT           20  [cha: n, def: 20, sav: 20]  Idle_a condition timer (100 ms)<br>  SCT           0  [cha: y, def:  0, sav:  0]  Standby_z condition timer (100 ms)<br>  IBCT          6000  [cha: n, def:6000, sav:6000]  Idle_b condition timer (100 ms)<br>  ICCT          9000  [cha: n, def:9000, sav:9000]  Idle_c condition timer (100 ms)<br>  SYCT          0  [cha: n, def:  0, sav:  0]  Standby_y condition timer (100 ms)<br>  CCF_IDLE      1  [cha: y, def:  1, sav:  1]  check condition on transition from idle<br>  CCF_STAND     2  [cha: y, def:  2, sav:  2]  check condition on transition from standby<br>  CCF_STOPP     2  [cha: y, def:  2, sav:  2]  check condition on transition from stopped<br></code></pre></td></tr></table></figure>

<h4 id="Disable-SATA-power-save"><a href="#Disable-SATA-power-save" class="headerlink" title="Disable SATA power save"></a><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/Hdparm">Disable SATA power save</a></h4><p>-B Set the Advanced Power Management feature. Possible values are between 1 and 255, low values mean more aggressive power management and higher values mean better performance. Values from 1 to 127 permit spin-down, whereas values from 128 to 254 do not. A value of 255 completely disables the feature.</p>
<p>-S Set the standby (spindown) timeout for the drive. The timeout specifies how long to wait in idle (with no disk activity) before turning off the motor to save power. The value of 0 disables spindown, the values from 1 to 240 specify multiples of 5 seconds and values from 241 to 251 specify multiples of 30 minutes.</p>
<p>-M Set the Automatic Acoustic Management feature. Most modern hard disk drives have the ability to speed down the head movements to reduce their noise output. The possible value depends on the disk, some disks may not support this feature.</p>
<p>-J Get/set  the  Western  Digital (WD) Green Drive’s “idle3” timeout value.  This timeout controls how often the drive parks its heads and enters a low power consumption state.  The factory default is eight (8) seconds, which is a very  poor  choice  for use  with  Linux.   Leaving it at the default will result in hundreds of thousands of head load/unload cycles in a very short period of time.  The drive mechanism is only rated for 300,000 to 1,000,000 cycles, so leaving it at the default could result in premature failure, not to mention the performance impact of the drive often having to wake-up before doing routine I/O.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs bash">$  hdparm -I /dev/sda | grep level<br>	Advanced power management level: 128<br>$  hdparm -B 255 /dev/sda<br><br>/dev/sda:<br> setting Advanced Power Management level to disabled<br> APM_level	= off<br><br>$ hdparm -I /dev/sdl | grep level<br>	Advanced power management level: disabled<br><br>$ hdparm -S 245 /dev/sdl<br><br>/dev/sdl:<br> setting standby to 245 (2 hours + 30 minutes)<br><br>$ hdparm -S 0 /dev/sdl<br><br>/dev/sdl:<br> setting standby to 0 (off)<br><br><span class="hljs-comment"># Get/set  the  Western  Digital (WD) Green Drive&#x27;s &quot;idle3&quot; timeout value</span><br>$ hdparm -J /dev/sda<br><br>/dev/sda:<br>wdidle3_vsc_enable_disable: Input/output error<br><br>$ hdparm -J 30 --please-destroy-my-drive /dev/sda<br><br>$ hdparm -M /dev/sda<br><br>/dev/sda:<br> acoustic      = not supported<br></code></pre></td></tr></table></figure>

<h3 id="upgrade-LSI-firmware"><a href="#upgrade-LSI-firmware" class="headerlink" title="upgrade LSI firmware"></a>upgrade LSI firmware</h3><p>HBA reset no impact the zfs service</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sas2flash.efi -o -e 7<br>$ sas2flash.efi -f 2308T207.ROM -c 1<br>$ sas2flash.efi -b mptsas2.rom -c 1<br>$ sas2flash.efi -b x64sas2.rom -c 1<br>$ sas2flash.efi -o -sasaddhi XXXXXXX -c 1<br><br>$ sas3flash -c 3 -f 2308T207.ROM -b mpt3x64.rom -b x64sas3.rom -noreset<br><br>[Mon Apr 27 19:49:53 2020] mpt2sas_cm0: sending diag reset !!<br>[Mon Apr 27 19:49:54 2020] mpt2sas_cm0: diag reset: SUCCESS<br>[Mon Apr 27 19:49:54 2020] mpt2sas_cm0: CurrentHostPageSize is 0: Setting default host page size to 4k<br>[Mon Apr 27 19:49:54 2020] mpt2sas_cm0: LSISAS2308: FWVersion(19.00.00.00), ChipRevision(0x05), BiosVersion(07.37.00.00)<br>[Mon Apr 27 19:49:54 2020] mpt2sas_cm0: Protocol=(Initiator,Target), Capabilities=(TLR,EEDP,Snapshot Buffer,Diag Trace Buffer,Task Set Full,NCQ)<br>[Mon Apr 27 19:49:54 2020] mpt2sas_cm0: sending port <span class="hljs-built_in">enable</span> !!<br>[Mon Apr 27 19:50:01 2020] mpt2sas_cm0: port <span class="hljs-built_in">enable</span>: SUCCESS<br>[Mon Apr 27 19:50:01 2020] mpt2sas_cm0: search <span class="hljs-keyword">for</span> end-devices: start<br>[Mon Apr 27 19:50:01 2020] scsi target0:0:0: handle(0x000a), sas_addr(0x5000c5008375be35)<br>[Mon Apr 27 19:50:01 2020] scsi target0:0:0: enclosure logical id(0x5003048000d412bf), slot(0)<br>[Mon Apr 27 19:50:01 2020] scsi target0:0:1: handle(0x000b), sas_addr(0x5000c50083753969)<br>[Mon Apr 27 19:50:01 2020] scsi target0:0:1: enclosure logical id(0x5003048000d412bf), slot(1)<br>[Mon Apr 27 19:50:01 2020] scsi target0:0:2: handle(0x000c), sas_addr(0x5000c50083758d41)<br>[Mon Apr 27 19:50:01 2020] scsi target0:0:2: enclosure logical id(0x5003048000d412bf), slot(2)<br>[Mon Apr 27 19:50:01 2020] scsi target0:0:3: handle(0x000d), sas_addr(0x5000c500837593a1)<br>......<br></code></pre></td></tr></table></figure>

<h3 id="Some-of-HDD-utils-100-in-the-zpool"><a href="#Some-of-HDD-utils-100-in-the-zpool" class="headerlink" title="Some of HDD utils 100% in the zpool"></a>Some of HDD utils 100% in the zpool</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">avg-cpu:  %user   %nice %system %iowait  %steal   %idle<br>           0.00    0.00   10.43   65.92    0.00   23.65<br><br>Device:         rrqm/s   wrqm/s     r/s     w/s    rMB/s    wMB/s avgrq-sz avgqu-sz   await r_await w_await  svctm  %util<br>sda              0.00     0.00  444.00  305.00     0.22     0.63     2.32     1.81    2.41    3.82    0.35   1.09  81.40<br>sdb              0.00     0.00  397.00  340.00     0.20     0.64     2.34     1.69    2.33    4.08    0.30   1.07  79.10<br>sdc              0.00     0.00  440.00  327.00     0.22     0.63     2.27     1.18    1.52    2.44    0.29   0.86  66.20<br>sdd              0.00     0.00  444.00  283.00     0.22     0.63     2.40     1.67    2.28    3.41    0.51   1.16  84.30<br>sde              0.00     0.00  401.00  352.00     0.20     0.65     2.30     1.84    2.42    4.29    0.30   1.04  78.60<br>sdf              0.00     0.00  442.00  296.00     0.22     0.63     2.36     1.61    2.17    3.31    0.48   1.11  82.10<br>sdg              0.00     0.00  394.00   66.00     0.19     0.65     3.77     3.90    7.97    4.74   27.24   2.17 100.00<br>sdh              0.00     0.00  442.00  349.00     0.22     0.63     2.19     1.57    1.95    3.23    0.33   0.95  75.00<br>sdi              0.00     0.00  395.00  347.00     0.19     0.65     2.32     1.31    1.73    2.97    0.32   0.96  70.90<br>sdj              0.00     0.00  446.00  302.00     0.22     0.63     2.33     1.36    1.82    2.77    0.42   1.01  75.70<br>sdk              0.00     0.00  440.00  296.00     0.21     0.63     2.35     2.48    3.52    5.64    0.38   1.16  85.50<br>sdl              0.00     0.00  398.00  328.00     0.20     0.65     2.39     1.35    1.88    3.14    0.34   1.03  74.60<br>sdm              0.00     0.00  448.00  339.00     0.22     0.64     2.24     1.02    1.34    2.13    0.29   0.83  65.00<br></code></pre></td></tr></table></figure>


<h3 id="SAS-Link-layer-2-has-the-flow-control"><a href="#SAS-Link-layer-2-has-the-flow-control" class="headerlink" title="SAS Link layer 2 has the flow control"></a>SAS Link layer 2 has the flow control</h3><p>Inside an SSP connection</p>
<ul>
<li>Phys exchange SSP frames<ul>
<li>SSP frame = SOF primitive, data dwords, EOF primitive</li>
<li>Each frame results in an ACK or NAK primitive</li>
</ul>
</li>
<li>Credit-based flow control<ul>
<li>Permission to send a frame must be granted with RRDY primitives</li>
</ul>
</li>
<li>Full duplex<ul>
<li>SSP frames can be sent in both directions simultaneously</li>
<li>Independent credit for each direction</li>
</ul>
</li>
<li>ACK, NAK, and RRDY primitives may be interjected among frame dwords<br>  – (so can ALIGNs and NOTIFYs)</li>
</ul>
<p>My question:<br>If some of performance differents in SAS switch port, the flow control will cause the performance different in your SAS device ?<br>Some high loading in your vibration HDD devices, Does the vibration cause the region of resonate in your JBOD ? the region will impact the device performance ?<br>If the sas switch has the performance issue cause these sas port performance not balancing ?</p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Ginger</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="http://yoursite.com/2018/07/08/scsi_dev/">http://yoursite.com/2018/07/08/scsi_dev/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/scsi/">scsi</a></div><div class="post_share"><div class="social-share" data-image="/img/photo_by_spacex.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2018/07/12/storage_benchmark/"><img class="prev-cover" src="/img/photo_by_spacex.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">storage benchmark</div></div></a></div><div class="next-post pull-right"><a href="/2018/07/02/mem/"><img class="next-cover" src="/img/photo_by_spacex.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">memory</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2018/09/27/hba/" title="SAS HBA"><img class="cover" src="/img/photo_by_spacex.jpg"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-09-27</div><div class="title">SAS HBA</div></div></a></div><div><a href="/2019/11/26/smartctl/" title="smartctl"><img class="cover" src="/img/photo_by_spacex.jpg"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-11-26</div><div class="title">smartctl</div></div></a></div><div><a href="/2016/06/16/spec/" title="spec"><img class="cover" src="/img/photo_by_spacex.jpg"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2016-06-16</div><div class="title">spec</div></div></a></div><div><a href="/2016/08/10/block_device/" title="The block device"><img class="cover" src="/img/photo_by_spacex.jpg"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2016-08-10</div><div class="title">The block device</div></div></a></div><div><a href="/2016/12/04/openzfs-tips/" title="openzfs tips"><img class="cover" src="/img/photo_by_spacex.jpg"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2016-12-04</div><div class="title">openzfs tips</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></article></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2015 - 2020 By Ginger</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><div class="js-pjax"><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk({
      clientID: '0b9d5b98d0a972b33cf7',
      clientSecret: '769efc11b32f6c0d03bcbf3ee800dfc4e2690459',
      repo: 'homerl.github.io',
      owner: 'homerl',
      admin: ['homerl'],
      id: '0f443d4cede8ed3b746069ccf60666ec',
      language: 'en',
      perPage: 10,
      distractionFreeMode: false,
      pagerDirection: 'last',
      createIssueManually: false,
      updateCountCallback: commentCount
    })
    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    $.getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js', initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></div></body></html>