<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Test hardware and filesystem data consistency | b946c5a0bf547c89</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Because there are some Enterprise hardware firmware issue cause some function not work&#x2F;data loss.make sure the supercapacitor is work in Enterprise SSDIn Some case, if the device partition is not alig">
<meta property="og:type" content="article">
<meta property="og:title" content="Test hardware and filesystem data consistency">
<meta property="og:url" content="http://yoursite.com/2019/04/28/consistency-test/index.html">
<meta property="og:site_name" content="b946c5a0bf547c89">
<meta property="og:description" content="Because there are some Enterprise hardware firmware issue cause some function not work&#x2F;data loss.make sure the supercapacitor is work in Enterprise SSDIn Some case, if the device partition is not alig">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2019-04-28T09:43:07.000Z">
<meta property="article:modified_time" content="2020-09-27T14:59:09.926Z">
<meta property="article:author" content="Ginger">
<meta property="article:tag" content="postgresql">
<meta property="article:tag" content="test">
<meta property="article:tag" content="benchmark">
<meta property="article:tag" content="fio">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="b946c5a0bf547c89" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">b946c5a0bf547c89</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-consistency-test" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/04/28/consistency-test/" class="article-date">
  <time datetime="2019-04-28T09:43:07.000Z" itemprop="datePublished">2019-04-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/benchmark/">benchmark</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Test hardware and filesystem data consistency
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Because there are some Enterprise hardware firmware issue cause some function not work/data loss.<br><a target="_blank" rel="noopener" href="https://engineering.nordeus.com/power-failure-testing-with-ssds/">make sure the supercapacitor is work in Enterprise SSD</a><br>In Some case, if the device partition is not aligned, the logic 512 Byte across the two physical block(512B), it will cause atomic transaction failed (enable the dev write buffer,the buffer no battery or supercapacitor)</p>
<h3 id="About-filesystem-settting"><a href="#About-filesystem-settting" class="headerlink" title="About filesystem settting"></a>About filesystem settting</h3><p>Disable barrier and set data is writeback </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ext4&#x2F;xfs -o barrier&#x3D;0,data&#x3D;writeback</span><br><span class="line">zfs disable sync write</span><br></pre></td></tr></table></figure>

<a id="more"></a>

<h3 id="PostgreSQL-Installation"><a href="#PostgreSQL-Installation" class="headerlink" title="PostgreSQL Installation"></a><a target="_blank" rel="noopener" href="https://tecadmin.net/install-postgresql-11-on-centos/">PostgreSQL Installation</a></h3><p>Here is my first time to use postgresql, good luck</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ mkfs.ext4 /dev/sdXX1</span><br><span class="line">$ rpm -Uvh https://yum.postgresql.org/11/redhat/rhel-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm</span><br><span class="line">$ yum install postgresql11-server</span><br><span class="line">$ mount /dev/sdXX1 /var/lib/pgsql -o barrier=0,data=writeback</span><br><span class="line">$ chown -R postgres.postgres /var/lib/pgsql</span><br><span class="line">$ /usr/pgsql-11/bin/postgresql-11-setup initdb</span><br><span class="line"><span class="comment"># data is in /var/lib/pgsql/11/data</span></span><br><span class="line">$ systemctl <span class="built_in">enable</span> postgresql-11</span><br><span class="line">$ systemctl start postgresql-11</span><br></pre></td></tr></table></figure>

<h4 id="Disable-PostgreSQL-WAL-Write-Ahead-Log"><a href="#Disable-PostgreSQL-WAL-Write-Ahead-Log" class="headerlink" title="Disable PostgreSQL WAL(Write-Ahead Log)"></a>Disable PostgreSQL WAL(Write-Ahead Log)</h4><p><a target="_blank" rel="noopener" href="https://blog.nukomeet.com/faster-inserts-how-to-increase-postgresql-write-performance-24d76bd56f75">The WAL guarantees that the table data is persisted in the event of an unclean shutdown. In other words, unlogged tables are automatically cleared if the server crashes.</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">CREATE UNLOGGED TABLE user_clicks (</span><br><span class="line">  id uuid PRIMARY KEY,</span><br><span class="line">  time timestamptz,</span><br><span class="line">  user_id int</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CREATE UNLOGGED TABLE name (</span><br><span class="line">…</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">ALTER TABLE user_clicks SET LOGGED </span><br><span class="line">ALTER TABLE user_clicks SET UNLOGGED </span><br><span class="line"></span><br><span class="line"><span class="comment"># List all unlogged tables within the current database.</span></span><br><span class="line">SELECT relname FROM pg_class WHERE relpersistence = <span class="string">&#x27;u&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="pgbench"><a href="#pgbench" class="headerlink" title="pgbench"></a>pgbench</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">$ sudo -u postgres psql -U postgres -c <span class="string">&quot;CREATE DATABASE pgbench1;&quot;</span></span><br><span class="line">$ mkdir /var/lib/pgsql/11/index</span><br><span class="line">$ chown postgres.postgres /var/lib/pgsql/11/index</span><br><span class="line">$ sudo -u postgres psql -U postgres -c <span class="string">&quot;CREATE TABLESPACE index LOCATION &#x27;/var/lib/pgsql/11/index&#x27;;&quot;</span></span><br><span class="line"><span class="comment"># init table in pgbench1</span></span><br><span class="line">$ sudo -u postgres /usr/pgsql-11/bin/pgbench -U postgres -i pgbench1</span><br><span class="line"></span><br><span class="line"><span class="comment"># go to postgresql terminal</span></span><br><span class="line">$ sudo -u postgres psql </span><br><span class="line"></span><br><span class="line">postgres <span class="comment"># postgres=# \l</span></span><br><span class="line"><span class="comment"># list databases;</span></span><br><span class="line">                             List of databases</span><br><span class="line">   Name    |  Owner   | Encoding  | Collate | Ctype |   Access privileges</span><br><span class="line">-----------+----------+-----------+---------+-------+-----------------------</span><br><span class="line"> pgbench1  | postgres | SQL_ASCII | C       | C     |</span><br><span class="line"></span><br><span class="line">postgres=<span class="comment"># \c pgbench1</span></span><br><span class="line">You are now connected to database <span class="string">&quot;pgbench1&quot;</span> as user <span class="string">&quot;postgres&quot;</span>.</span><br><span class="line"></span><br><span class="line">pgbench1=<span class="comment"># \dt;</span></span><br><span class="line">              List of relations</span><br><span class="line"> Schema |       Name       | Type  |  Owner</span><br><span class="line">--------+------------------+-------+----------</span><br><span class="line"> public | pgbench_accounts | table | postgres</span><br><span class="line"> public | pgbench_branches | table | postgres</span><br><span class="line"> public | pgbench_history  | table | postgres</span><br><span class="line"> public | pgbench_tellers  | table | postgres</span><br><span class="line">(4 rows)</span><br><span class="line"></span><br><span class="line"><span class="comment">## it &#x27;s the pgbench create table</span></span><br><span class="line">$ sudo -u postgres /usr/pgsql-11/bin/pgbench -U postgres -i pgbench1 --index-tablespace=index</span><br><span class="line">$ sudo -u postgres psql -U postgres -d pgbench1 -c <span class="string">&quot;CREATE INDEX ON pgbench_accounts(abalance,aid) TABLESPACE index;&quot;</span></span><br><span class="line">$ sudo -u postgres psql -U postgres -d pgbench1 -c <span class="string">&quot;CREATE INDEX ON pgbench_history(mtime) TABLESPACE index;&quot;</span></span><br><span class="line">$ sudo -u postgres psql -U postgres -d pgbench1 -c <span class="string">&quot;CREATE INDEX ON pgbench_history(aid,delta) TABLESPACE index;&quot;</span></span><br><span class="line">CREATE INDEX</span><br><span class="line"></span><br><span class="line"><span class="comment">## Disable test table WAL log</span></span><br><span class="line">$ sudo -u postgres psql -U postgres -d pgbench1 -c <span class="string">&quot;ALTER TABLE pgbench_accounts SET UNLOGGED&quot;</span></span><br><span class="line">ALTER TABLE</span><br><span class="line">$ sudo -u postgres psql -U postgres -d pgbench1 -c <span class="string">&quot;ALTER TABLE pgbench_branches SET UNLOGGED&quot;</span></span><br><span class="line">ALTER TABLE</span><br><span class="line">$ sudo -u postgres psql -U postgres -d pgbench1 -c <span class="string">&quot;ALTER TABLE pgbench_history SET UNLOGGED&quot;</span></span><br><span class="line">ALTER TABLE</span><br><span class="line">$ sudo -u postgres psql -U postgres -d pgbench1 -c <span class="string">&quot;ALTER TABLE pgbench_tellers SET UNLOGGED&quot;</span></span><br><span class="line">ALTER TABLE</span><br><span class="line"></span><br><span class="line"><span class="comment">## bengin to test</span></span><br><span class="line">$ sudo -u postgres /usr/pgsql-11/bin/pgbench -c 64 -j 64 -T 1200 -P 8 -M extended --random-seed=rand pgbench1</span><br><span class="line">...</span><br><span class="line">progress: 1160.0 s, 50.0 tps, lat 1184.948 ms stddev 1421.433</span><br><span class="line">progress: 1168.0 s, 50.1 tps, lat 1205.856 ms stddev 1672.771</span><br><span class="line">progress: 1176.0 s, 49.0 tps, lat 1359.426 ms stddev 1864.131</span><br><span class="line">progress: 1184.0 s, 47.5 tps, lat 1365.739 ms stddev 1912.132</span><br><span class="line">progress: 1192.0 s, 49.5 tps, lat 1341.149 ms stddev 1631.751</span><br><span class="line">progress: 1200.0 s, 48.9 tps, lat 1308.528 ms stddev 1643.086</span><br><span class="line">transaction <span class="built_in">type</span>: &lt;<span class="built_in">builtin</span>: TPC-B (sort of)&gt;</span><br><span class="line">scaling factor: 1</span><br><span class="line">query mode: extended</span><br><span class="line">number of clients: 64</span><br><span class="line">number of threads: 64</span><br><span class="line">duration: 1200 s</span><br><span class="line">number of transactions actually processed: 2750119</span><br><span class="line">latency average = 27.940 ms</span><br><span class="line">latency stddev = 181.635 ms</span><br><span class="line">tps = 2289.444326 (including connections establishing)</span><br><span class="line">tps = 2289.485134 (excluding connections establishing)</span><br></pre></td></tr></table></figure>
<p>In the test process, hot plugin the SSD mount at /var/lib/pgsql.<br>Don’t use “echo 1 &gt; /sys/block/sdXX/device/delete, the operate will sync write cache to the device</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo -u postgres /usr/pgsql-11/bin/pg_dumpall &gt; /dev/null</span><br></pre></td></tr></table></figure>
<p>Check the command has any error.</p>
<h3 id="Enable-WAL-test-to-test-file-system"><a href="#Enable-WAL-test-to-test-file-system" class="headerlink" title="Enable WAL test to test file system"></a><a target="_blank" rel="noopener" href="http://mysql.taobao.org/monthly/2016/10/07/">Enable WAL test to test file system</a></h3><p>If you are enable WAL log, force stop the database, and the database will go to recovery</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line">$ sudo -u postgres psql -U postgres -d pgbench1 -c &quot;ALTER TABLE pgbench_accounts SET LOGGED&quot;</span><br><span class="line">ALTER TABLE</span><br><span class="line">$ sudo -u postgres psql -U postgres -d pgbench1 -c &quot;ALTER TABLE pgbench_branches SET LOGGED&quot;</span><br><span class="line">ALTER TABLE</span><br><span class="line">$ sudo -u postgres psql -U postgres -d pgbench1 -c &quot;ALTER TABLE pgbench_history SET LOGGED&quot;</span><br><span class="line">ALTER TABLE</span><br><span class="line">$ sudo -u postgres psql -U postgres -d pgbench1 -c &quot;ALTER TABLE pgbench_tellers SET LOGGED&quot;</span><br><span class="line">ALTER TABLE</span><br><span class="line"></span><br><span class="line">### After enable WAL in my zfs test env, no zil</span><br><span class="line">progress: 792.0 s, 3699.0 tps, lat 17.227 ms stddev 20.965</span><br><span class="line">progress: 800.0 s, 3592.0 tps, lat 17.867 ms stddev 23.278</span><br><span class="line">progress: 808.0 s, 3502.7 tps, lat 18.292 ms stddev 25.962</span><br><span class="line">progress: 816.0 s, 3560.8 tps, lat 17.972 ms stddev 24.924</span><br><span class="line">progress: 824.0 s, 3628.1 tps, lat 17.656 ms stddev 23.070</span><br><span class="line">progress: 832.0 s, 3617.6 tps, lat 17.655 ms stddev 22.472</span><br><span class="line">progress: 840.0 s, 2590.1 tps, lat 21.832 ms stddev 30.337</span><br><span class="line">progress: 848.0 s, 46.5 tps, lat 1283.200 ms stddev 1202.214</span><br><span class="line">progress: 856.0 s, 5.7 tps, lat 1130.780 ms stddev 1334.794</span><br><span class="line">progress: 864.0 s, 21.3 tps, lat 5008.063 ms stddev 6756.387</span><br><span class="line">progress: 872.0 s, 48.1 tps, lat 1666.621 ms stddev 2890.584</span><br><span class="line">progress: 880.0 s, 49.1 tps, lat 1269.726 ms stddev 1383.484</span><br><span class="line">progress: 888.0 s, 50.4 tps, lat 1277.642 ms stddev 1514.558</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$ sudo -u postgres &#x2F;usr&#x2F;pgsql-11&#x2F;bin&#x2F;pgbench -c 64 -j 64 -T 1200 -P 8 -M extended --random-seed&#x3D;rand pgbench1</span><br><span class="line">setting random seed to 4859633172491879446</span><br><span class="line">starting vacuum...end.</span><br><span class="line">progress: 8.0 s, 46.1 tps, lat 1104.991 ms stddev 997.076</span><br><span class="line">progress: 16.0 s, 48.0 tps, lat 1344.463 ms stddev 1467.943</span><br><span class="line">progress: 24.0 s, 49.9 tps, lat 1285.797 ms stddev 1509.956</span><br><span class="line">progress: 32.0 s, 47.4 tps, lat 1277.344 ms stddev 1487.591</span><br><span class="line">progress: 40.0 s, 48.8 tps, lat 1406.851 ms stddev 1789.872</span><br><span class="line">progress: 48.0 s, 38.1 tps, lat 1477.057 ms stddev 1411.267</span><br><span class="line">progress: 56.0 s, 39.0 tps, lat 1695.951 ms stddev 2172.428</span><br><span class="line">progress: 64.0 s, 51.5 tps, lat 1270.484 ms stddev 2008.514</span><br><span class="line">progress: 72.0 s, 48.1 tps, lat 1260.300 ms stddev 1831.611</span><br><span class="line">progress: 80.0 s, 42.6 tps, lat 1605.049 ms stddev 2572.170</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"># disable it immediate</span><br><span class="line">$ sudo -u postgres &#x2F;usr&#x2F;pgsql-11&#x2F;bin&#x2F;pg_ctl stop  -D &#x2F;var&#x2F;lib&#x2F;pgsql&#x2F;11&#x2F;data -m immediate</span><br><span class="line"></span><br><span class="line">waiting for server to shut down.... done</span><br><span class="line">server stopped</span><br><span class="line"></span><br><span class="line">progress: 768.0 s, 41.1 tps, lat 1562.948 ms stddev 1996.733</span><br><span class="line">progress: 776.0 s, 48.3 tps, lat 1258.457 ms stddev 1728.933</span><br><span class="line">WARNING:  terminating connection because of crash of another server process</span><br><span class="line">DETAIL:  The postmaster has commanded this server process to roll back the current transaction and exit, because another server process exited abnormally and possibly corrupted shared memory.</span><br><span class="line">HINT:  In a moment you should be able to reconnect to the database and repeat your command.</span><br><span class="line">WARNING:  terminating connection because of crash of another server process</span><br><span class="line">DETAIL:  The postmaster has commanded this server process to roll back the current transaction and exit, because another server process exited abnormally and possibly corrupted shared memory.</span><br><span class="line"></span><br><span class="line">### postgresql log</span><br><span class="line">$ tail -f &#x2F;var&#x2F;lib&#x2F;pgsql&#x2F;11&#x2F;data&#x2F;log&#x2F;postgresql-Mon.log</span><br><span class="line"></span><br><span class="line">2019-04-29 07:43:53.582 UTC [11284] WARNING:  terminating connection because of crash of another server process</span><br><span class="line">2019-04-29 07:43:53.582 UTC [11284] DETAIL:  The postmaster has commanded this server process to roll back the current transaction and exit, because another server process exited abnormally and possibly corrupted shared memory.</span><br><span class="line">2019-04-29 07:43:53.582 UTC [11284] HINT:  In a moment you should be able to reconnect to the database and repeat your command.</span><br><span class="line">2019-04-29 07:43:53.582 UTC [11284] CONTEXT:  while rechecking updated tuple (3,17) in relation &quot;pgbench_tellers&quot;</span><br><span class="line">2019-04-29 07:43:53.584 UTC [11304] WARNING:  terminating connection because of crash of another server process</span><br><span class="line">2019-04-29 07:43:53.584 UTC [11304] DETAIL:  The postmaster has commanded this server process to roll back the current transaction and exit, because another server process exited abnormally and possibly corrupted shared memory.</span><br><span class="line">2019-04-29 07:43:53.584 UTC [11304] HINT:  In a moment you should be able to reconnect to the database and repeat your command.</span><br><span class="line">2019-04-29 07:43:53.584 UTC [11304] CONTEXT:  while updating tuple (17,116) in relation &quot;pgbench_tellers&quot;</span><br><span class="line">2019-04-29 07:43:53.653 UTC [11282] WARNING:  terminating connection because of crash of another server process</span><br><span class="line">2019-04-29 07:43:53.653 UTC [11282] DETAIL:  The postmaster has commanded this server process to roll back the current transaction and exit, because another server process exited abnormally and possibly corrupted shared memory.</span><br><span class="line">2019-04-29 07:43:53.653 UTC [11282] HINT:  In a moment you should be able to reconnect to the database and repeat your command.</span><br><span class="line">2019-04-29 07:43:53.667 UTC [450] LOG:  database system is shut down</span><br><span class="line"></span><br><span class="line">$ cd &#x2F;var&#x2F;lib&#x2F;pgsql&#x2F;11&#x2F;data&#x2F;pg_wal</span><br><span class="line">#let &#39;s test 14834480</span><br><span class="line">$ sudo -u postgres &#x2F;usr&#x2F;pgsql-11&#x2F;bin&#x2F;pg_waldump -b 00000001000000010000008D | grep Transaction | tail | head -n 1</span><br><span class="line">pg_waldump: FATAL:  error in WAL record at 1&#x2F;8DEFE4B0: invalid record length at 1&#x2F;8DEFE4D8: wanted 24, got 0</span><br><span class="line">rmgr: Transaction len (rec&#x2F;tot):     34&#x2F;    34, tx:   14834480, lsn: 1&#x2F;8DEFCAF8, prev 1&#x2F;8DEFCAB8, desc: COMMIT 2019-04-29 07:43:53.168178 UTC</span><br><span class="line"></span><br><span class="line">$ pgbench1&#x3D;# select xmin,* from pgbench_history where xmin in (14834480);</span><br><span class="line">   xmin   | tid | bid |  aid  | delta |           mtime            | filler</span><br><span class="line">----------+-----+-----+-------+-------+----------------------------+--------</span><br><span class="line"> 14834480 |  10 |   1 | 57633 |  1859 | 2019-04-29 08:41:26.458402 |</span><br><span class="line">(1 row)</span><br><span class="line"></span><br><span class="line">$ dd if&#x3D;&#x2F;dev&#x2F;zero of&#x3D;.&#x2F;00000001000000010000008D bs&#x3D;1 count&#x3D;10000 skip&#x3D;100</span><br><span class="line"></span><br><span class="line">$ tail -f &#x2F;var&#x2F;lib&#x2F;pgsql&#x2F;11&#x2F;data&#x2F;log&#x2F;postgresql-Mon.log </span><br><span class="line">2019-04-29 07:57:03.979 UTC [11634] LOG:  database system was interrupted; last known up at 2019-04-29 07:41:55 UTC</span><br><span class="line">2019-04-29 07:57:04.050 UTC [11634] LOG:  invalid primary checkpoint record</span><br><span class="line">2019-04-29 07:57:04.051 UTC [11634] PANIC:  could not locate a valid checkpoint record</span><br><span class="line">2019-04-29 07:57:04.171 UTC [11632] LOG:  startup process (PID 11634) was terminated by signal 6: Aborted</span><br><span class="line">2019-04-29 07:57:04.171 UTC [11632] LOG:  aborting startup due to startup process failure</span><br><span class="line">2019-04-29 07:57:04.173 UTC [11632] LOG:  database system is shut down</span><br><span class="line"></span><br><span class="line">$ sudo -u postgres &#x2F;usr&#x2F;pgsql-11&#x2F;bin&#x2F;pg_resetwal -f &#x2F;var&#x2F;lib&#x2F;pgsql&#x2F;11&#x2F;data</span><br><span class="line">Write-ahead log reset</span><br><span class="line"></span><br><span class="line">$ sudo -u postgres &#x2F;usr&#x2F;pgsql-11&#x2F;bin&#x2F;pg_ctl start  -D &#x2F;var&#x2F;lib&#x2F;pgsql&#x2F;11&#x2F;data</span><br><span class="line">waiting for server to start....2019-04-29 08:17:18.990 UTC [11662] LOG:  listening on IPv6 address &quot;::1&quot;, port 5432</span><br><span class="line">2019-04-29 08:17:18.990 UTC [11662] LOG:  listening on IPv4 address &quot;127.0.0.1&quot;, port 5432</span><br><span class="line">2019-04-29 08:17:19.000 UTC [11662] LOG:  listening on Unix socket &quot;&#x2F;var&#x2F;run&#x2F;postgresql&#x2F;.s.PGSQL.5432&quot;</span><br><span class="line">2019-04-29 08:17:19.026 UTC [11662] LOG:  listening on Unix socket &quot;&#x2F;tmp&#x2F;.s.PGSQL.5432&quot;</span><br><span class="line">2019-04-29 08:17:19.050 UTC [11662] LOG:  redirecting log output to logging collector process</span><br><span class="line">2019-04-29 08:17:19.050 UTC [11662] HINT:  Future log output will appear in directory &quot;log&quot;.</span><br><span class="line"> done</span><br><span class="line">server started</span><br><span class="line"></span><br><span class="line">$ tail -f &#x2F;var&#x2F;lib&#x2F;pgsql&#x2F;11&#x2F;data&#x2F;log&#x2F;postgresql-Mon.log</span><br><span class="line">2019-04-29 08:17:19.064 UTC [11664] LOG:  database system was shut down at 2019-04-29 08:17:11 UTC</span><br><span class="line">2019-04-29 08:17:19.104 UTC [11662] LOG:  database system is ready to accept connections</span><br><span class="line">2019-04-29 08:17:31.640 UTC [11671] WARNING:  page is not marked all-visible but visibility map bit is set in relation &quot;pgbench_tellers&quot; page 0</span><br><span class="line">2019-04-29 08:17:31.640 UTC [11671] WARNING:  page is not marked all-visible but visibility map bit is set in relation &quot;pgbench_tellers&quot; page 3</span><br><span class="line"></span><br><span class="line"># you can&#39;t found it</span><br><span class="line">$ pgbench1&#x3D;# select xmin,* from pgbench_history where xmin in (14834480);</span><br><span class="line"> xmin | tid | bid | aid | delta | mtime | filler</span><br><span class="line">------+-----+-----+-----+-------+-------+--------</span><br><span class="line">(0 rows)</span><br><span class="line"></span><br><span class="line">$ sudo -u postgres &#x2F;usr&#x2F;pgsql-11&#x2F;bin&#x2F;pgbench -c 64 -j 64 -T 1200 -P 8 -M extended --random-seed&#x3D;rand pgbench1</span><br><span class="line">setting random seed to 4384533976954680126</span><br><span class="line">starting vacuum...end.</span><br><span class="line">empty range given to random</span><br><span class="line">client 1 aborted in command 0 (set) of script 0; evaluation of meta-command failed</span><br><span class="line">......</span><br><span class="line">empty range given to random</span><br><span class="line">client 40 aborted in command 0 (set) of script 0; evaluation of meta-command failed</span><br><span class="line">transaction type: &lt;builtin: TPC-B (sort of)&gt;</span><br><span class="line">scaling factor: 0</span><br><span class="line">query mode: extended</span><br><span class="line">number of clients: 64</span><br><span class="line">number of threads: 64</span><br><span class="line">duration: 1200 s</span><br><span class="line">number of transactions actually processed: 0</span><br><span class="line"></span><br><span class="line">## re-init</span><br><span class="line"></span><br><span class="line">$ sudo -u postgres &#x2F;usr&#x2F;pgsql-11&#x2F;bin&#x2F;pgbench -i pgbench1</span><br><span class="line">dropping old tables...</span><br><span class="line">creating tables...</span><br><span class="line">generating data...</span><br><span class="line">100000 of 100000 tuples (100%) done (elapsed 0.12 s, remaining 0.00 s)</span><br><span class="line">vacuuming...</span><br><span class="line">creating primary keys...</span><br><span class="line">done.</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Oh shit,it looks like meta data loss cause tables incomplelte….</p>
<p><a target="_blank" rel="noopener" href="https://github.com/winlibs/postgresql/blob/master/src/backend/commands/vacuumlazy.c">source code</a></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">		 * As of PostgreSQL 9.2, the visibility map bit should never be set if</span></span><br><span class="line"><span class="comment">		 * the page-level bit is clear.  However, it&#x27;s possible that the bit</span></span><br><span class="line"><span class="comment">		 * got cleared after we checked it and before we took the buffer</span></span><br><span class="line"><span class="comment">		 * content lock, so we must recheck before jumping to the conclusion</span></span><br><span class="line"><span class="comment">		 * that something bad has happened.</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (all_visible_according_to_vm &amp;&amp; !PageIsAllVisible(page)</span><br><span class="line">				 &amp;&amp; VM_ALL_VISIBLE(onerel, blkno, &amp;vmbuffer))</span><br><span class="line">		&#123;</span><br><span class="line">			elog(WARNING, <span class="string">&quot;page is not marked all-visible but visibility map bit is set in relation \&quot;%s\&quot; page %u&quot;</span>,</span><br><span class="line">				 relname, blkno);</span><br><span class="line">			visibilitymap_clear(onerel, blkno, vmbuffer,</span><br><span class="line">								VISIBILITYMAP_VALID_BITS);</span><br><span class="line">		&#125;</span><br></pre></td></tr></table></figure>


<h3 id="FIO-verify"><a href="#FIO-verify" class="headerlink" title="FIO verify"></a><a target="_blank" rel="noopener" href="https://github.com/axboe/fio/issues/713">FIO verify</a></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ fio --ioengine=libaio --name=<span class="built_in">test</span> --direct=1 --directory=<span class="variable">$filepath</span> --bs=512 --iodepth=1 --readwrite=randwrite --size=1G --numjobs=1 --verify=crc64 --do_verify=1 --verify_state_save=1 --group_reporting --verify_backlog=8192</span><br><span class="line">$ fio --ioengine=libaio --name=<span class="built_in">test</span> --direct=1 --directory=<span class="variable">$filepath</span> --bs=512 --iodepth=1 --readwrite=randread  --size=1G --numjobs=1 --verify=crc64 --group_reporting --verify_only --verify_dump=1 --verify_state_load=1 --do_verify=1 --verify_backlog=8192</span><br><span class="line"></span><br><span class="line">$ fio --ioengine=libaio --name=<span class="built_in">test</span> --direct=1 --directory=<span class="variable">$filepath</span> --bs=4K --iodepth=1 --readwrite=randwrite --size=4G --numjobs=1 --verify=crc64 --do_verify=1 --verify_state_save=1 --group_reporting --verify_backlog=8192</span><br><span class="line">$ fio --ioengine=libaio --name=<span class="built_in">test</span> --direct=1 --directory=<span class="variable">$filepath</span> --bs=4K --iodepth=1 --readwrite=randread  --size=4G --numjobs=1 --verify=crc64 --group_reporting --verify_only --verify_dump=1 --verify_state_load=1 --do_verify=1 --verify_backlog=8192</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/04/28/consistency-test/" data-id="ckfzgl83f00093xo60e288ctd" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/benchmark/" rel="tag">benchmark</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/fio/" rel="tag">fio</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/postgresql/" rel="tag">postgresql</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/test/" rel="tag">test</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/05/24/megaraid/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Replace megaraid by strocli
        
      </div>
    </a>
  
  
    <a href="/2019/04/02/lxc_with_zfs/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">linux container with zfs</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/ansible/">ansible</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/awk/">awk</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/bash/">bash</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/benchmark/">benchmark</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/bios/">bios</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/block/">block</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/container/">container</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/debug/">debug</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/device-mapper/">device_mapper</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/filesystem/">filesystem</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/gdb/">gdb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/ha/">ha</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hardware/">hardware</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/ipmi/">ipmi</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/mdraid/">mdraid</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/network/">network</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/others/">others</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/proc/">proc</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/raid/">raid</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/scsi/">scsi</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/storage/">storage</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tools/">tools</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/virtualization/">virtualization</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ansible/" rel="tag">ansible</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/architecture/" rel="tag">architecture</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/awk/" rel="tag">awk</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bash/" rel="tag">bash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bcc/" rel="tag">bcc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/benchmark/" rel="tag">benchmark</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bios/" rel="tag">bios</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/block/" rel="tag">block</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bpf/" rel="tag">bpf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/calls/" rel="tag">calls</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/centos/" rel="tag">centos</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cpu/" rel="tag">cpu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/debug/" rel="tag">debug</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dell/" rel="tag">dell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dm/" rel="tag">dm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/driver/" rel="tag">driver</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/error/" rel="tag">error</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ext4/" rel="tag">ext4</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fio/" rel="tag">fio</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fsck/" rel="tag">fsck</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ftrace/" rel="tag">ftrace</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/golang/" rel="tag">golang</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gpt/" rel="tag">gpt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ha/" rel="tag">ha</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hardware/" rel="tag">hardware</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ipmi/" rel="tag">ipmi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/irq/" rel="tag">irq</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/isdct/" rel="tag">isdct</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kvm/" rel="tag">kvm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lfs/" rel="tag">lfs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lxc/" rel="tag">lxc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/megaraid/" rel="tag">megaraid</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mem/" rel="tag">mem</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/memory/" rel="tag">memory</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/multipath/" rel="tag">multipath</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/network/" rel="tag">network</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nfs/" rel="tag">nfs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nic/" rel="tag">nic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pci/" rel="tag">pci</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/perf/" rel="tag">perf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/posix/" rel="tag">posix</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/postgresql/" rel="tag">postgresql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/privoxy/" rel="tag">privoxy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/process/" rel="tag">process</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/proxy/" rel="tag">proxy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/racadm/" rel="tag">racadm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/raid/" rel="tag">raid</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ratio/" rel="tag">ratio</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sas/" rel="tag">sas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sata/" rel="tag">sata</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/schdule/" rel="tag">schdule</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scsi/" rel="tag">scsi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/smcli/" rel="tag">smcli</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sparse/" rel="tag">sparse</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssd/" rel="tag">ssd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/system/" rel="tag">system</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tcp/" rel="tag">tcp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/test/" rel="tag">test</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/topology/" rel="tag">topology</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/trace/" rel="tag">trace</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/" rel="tag">ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/virt/" rel="tag">virt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/virtualization/" rel="tag">virtualization</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xfs/" rel="tag">xfs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zfs/" rel="tag">zfs</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/ansible/" style="font-size: 10px;">ansible</a> <a href="/tags/architecture/" style="font-size: 10px;">architecture</a> <a href="/tags/awk/" style="font-size: 10px;">awk</a> <a href="/tags/bash/" style="font-size: 10px;">bash</a> <a href="/tags/bcc/" style="font-size: 12px;">bcc</a> <a href="/tags/benchmark/" style="font-size: 14px;">benchmark</a> <a href="/tags/bios/" style="font-size: 10px;">bios</a> <a href="/tags/block/" style="font-size: 16px;">block</a> <a href="/tags/bpf/" style="font-size: 12px;">bpf</a> <a href="/tags/calls/" style="font-size: 10px;">calls</a> <a href="/tags/centos/" style="font-size: 10px;">centos</a> <a href="/tags/cpu/" style="font-size: 12px;">cpu</a> <a href="/tags/debug/" style="font-size: 12px;">debug</a> <a href="/tags/dell/" style="font-size: 10px;">dell</a> <a href="/tags/dm/" style="font-size: 10px;">dm</a> <a href="/tags/driver/" style="font-size: 10px;">driver</a> <a href="/tags/error/" style="font-size: 10px;">error</a> <a href="/tags/ext4/" style="font-size: 10px;">ext4</a> <a href="/tags/fio/" style="font-size: 10px;">fio</a> <a href="/tags/fsck/" style="font-size: 10px;">fsck</a> <a href="/tags/ftrace/" style="font-size: 10px;">ftrace</a> <a href="/tags/golang/" style="font-size: 10px;">golang</a> <a href="/tags/gpt/" style="font-size: 10px;">gpt</a> <a href="/tags/ha/" style="font-size: 12px;">ha</a> <a href="/tags/hardware/" style="font-size: 10px;">hardware</a> <a href="/tags/ipmi/" style="font-size: 10px;">ipmi</a> <a href="/tags/irq/" style="font-size: 10px;">irq</a> <a href="/tags/isdct/" style="font-size: 10px;">isdct</a> <a href="/tags/kvm/" style="font-size: 10px;">kvm</a> <a href="/tags/lfs/" style="font-size: 12px;">lfs</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/lxc/" style="font-size: 10px;">lxc</a> <a href="/tags/megaraid/" style="font-size: 10px;">megaraid</a> <a href="/tags/mem/" style="font-size: 10px;">mem</a> <a href="/tags/memory/" style="font-size: 10px;">memory</a> <a href="/tags/multipath/" style="font-size: 10px;">multipath</a> <a href="/tags/network/" style="font-size: 12px;">network</a> <a href="/tags/nfs/" style="font-size: 12px;">nfs</a> <a href="/tags/nic/" style="font-size: 10px;">nic</a> <a href="/tags/pci/" style="font-size: 10px;">pci</a> <a href="/tags/perf/" style="font-size: 10px;">perf</a> <a href="/tags/posix/" style="font-size: 10px;">posix</a> <a href="/tags/postgresql/" style="font-size: 10px;">postgresql</a> <a href="/tags/privoxy/" style="font-size: 10px;">privoxy</a> <a href="/tags/process/" style="font-size: 10px;">process</a> <a href="/tags/proxy/" style="font-size: 12px;">proxy</a> <a href="/tags/racadm/" style="font-size: 10px;">racadm</a> <a href="/tags/raid/" style="font-size: 12px;">raid</a> <a href="/tags/ratio/" style="font-size: 10px;">ratio</a> <a href="/tags/sas/" style="font-size: 12px;">sas</a> <a href="/tags/sata/" style="font-size: 12px;">sata</a> <a href="/tags/schdule/" style="font-size: 10px;">schdule</a> <a href="/tags/scsi/" style="font-size: 14px;">scsi</a> <a href="/tags/smcli/" style="font-size: 10px;">smcli</a> <a href="/tags/sparse/" style="font-size: 10px;">sparse</a> <a href="/tags/ssd/" style="font-size: 10px;">ssd</a> <a href="/tags/system/" style="font-size: 10px;">system</a> <a href="/tags/tcp/" style="font-size: 10px;">tcp</a> <a href="/tags/test/" style="font-size: 18px;">test</a> <a href="/tags/topology/" style="font-size: 10px;">topology</a> <a href="/tags/trace/" style="font-size: 10px;">trace</a> <a href="/tags/ubuntu/" style="font-size: 12px;">ubuntu</a> <a href="/tags/virt/" style="font-size: 10px;">virt</a> <a href="/tags/virtualization/" style="font-size: 10px;">virtualization</a> <a href="/tags/xfs/" style="font-size: 10px;">xfs</a> <a href="/tags/zfs/" style="font-size: 20px;">zfs</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">July 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">June 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">March 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">November 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/09/27/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2020/07/24/bpftrace/">bpftrace</a>
          </li>
        
          <li>
            <a href="/2020/07/22/network-benchmark-result/">Network bencharmk results</a>
          </li>
        
          <li>
            <a href="/2020/06/01/mdadm/">backup the mdraid info</a>
          </li>
        
          <li>
            <a href="/2020/03/24/syscall/">syscall</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 Ginger<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>